// tinymce@5.10.0 downloaded from https://ga.jspm.io/npm:tinymce@5.10.0/tinymce.js

import e from"process";var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var n={};var a=e;(function(){var typeOf$1=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t};var isEquatableType=function(e){return-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(e)};var sort$1=function(e,t){var n=Array.prototype.slice.call(e);return n.sort(t)};var contramap=function(e,t){return eq$2((function(n,a){return e.eq(t(n),t(a))}))};var eq$2=function(e){return{eq:e}};var e=eq$2((function(e,t){return e===t}));var o=e;var eqArray=function(e){return eq$2((function(t,n){if(t.length!==n.length)return false;var a=t.length;for(var o=0;o<a;o++)if(!e.eq(t[o],n[o]))return false;return true}))};var eqSortedArray=function(e,t){return contramap(eqArray(e),(function(e){return sort$1(e,t)}))};var eqRecord=function(e){return eq$2((function(t,n){var a=Object.keys(t);var i=Object.keys(n);if(!eqSortedArray(o).eq(a,i))return false;var u=a.length;for(var c=0;c<u;c++){var f=a[c];if(!e.eq(t[f],n[f]))return false}return true}))};var i=eq$2((function(e,t){if(e===t)return true;var n=typeOf$1(e);var a=typeOf$1(t);return n===a&&(isEquatableType(n)?e===t:"array"===n?eqArray(i).eq(e,t):"object"===n&&eqRecord(i).eq(e,t))}));var typeOf=function(e){var t=typeof e;return null===e?"null":"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t};var isType$1=function(e){return function(t){return typeOf(t)===e}};var isSimpleType=function(e){return function(t){return typeof t===e}};var eq$1=function(e){return function(t){return e===t}};var u=isType$1("string");var c=isType$1("object");var f=isType$1("array");var s=eq$1(null);var l=isSimpleType("boolean");var v=eq$1(void 0);var isNullable=function(e){return null===e||void 0===e};var isNonNullable=function(e){return!isNullable(e)};var d=isSimpleType("function");var m=isSimpleType("number");var noop=function(){};var compose=function(e,t){return function(){var n=[];for(var a=0;a<arguments.length;a++)n[a]=arguments[a];return e(t.apply(null,n))}};var compose1=function(e,t){return function(n){return e(t(n))}};var constant=function(e){return function(){return e}};var identity=function(e){return e};var tripleEquals=function(e,t){return e===t};function curry(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){var n=[];for(var a=0;a<arguments.length;a++)n[a]=arguments[a];var o=t.concat(n);return e.apply(null,o)}}var not=function(e){return function(t){return!e(t)}};var die=function(e){return function(){throw new Error(e)}};var apply=function(e){return e()};var call=function(e){e()};var g=constant(false);var p=constant(true);var none=function(){return h};var h=function(){var call=function(e){return e()};var e=identity;var t={fold:function(e,t){return e()},isSome:g,isNone:p,getOr:e,getOrThunk:call,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:e,orThunk:call,map:none,each:noop,bind:none,exists:g,forall:p,filter:function(){return none()},toArray:function(){return[]},toString:constant("none()")};return t}();var some=function(e){var t=constant(e);var self=function(){return n};var bind=function(t){return t(e)};var n={fold:function(t,n){return n(e)},isSome:p,isNone:g,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:self,orThunk:self,map:function(t){return some(t(e))},each:function(t){t(e)},bind:bind,exists:bind,forall:bind,filter:function(t){return t(e)?n:h},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return n};var from$1=function(e){return null===e||void 0===e?h:some(e)};var b={some:some,none:none,from:from$1};var y=Array.prototype.slice;var C=Array.prototype.indexOf;var w=Array.prototype.push;var rawIndexOf=function(e,t){return C.call(e,t)};var indexOf$2=function(e,t){var n=rawIndexOf(e,t);return-1===n?b.none():b.some(n)};var contains$3=function(e,t){return rawIndexOf(e,t)>-1};var exists=function(e,t){for(var n=0,a=e.length;n<a;n++){var o=e[n];if(t(o,n))return true}return false};var map$3=function(e,t){var n=e.length;var a=new Array(n);for(var o=0;o<n;o++){var i=e[o];a[o]=t(i,o)}return a};var each$k=function(e,t){for(var n=0,a=e.length;n<a;n++){var o=e[n];t(o,n)}};var eachr=function(e,t){for(var n=e.length-1;n>=0;n--){var a=e[n];t(a,n)}};var partition=function(e,t){var n=[];var a=[];for(var o=0,i=e.length;o<i;o++){var u=e[o];var c=t(u,o)?n:a;c.push(u)}return{pass:n,fail:a}};var filter$4=function(e,t){var n=[];for(var a=0,o=e.length;a<o;a++){var i=e[a];t(i,a)&&n.push(i)}return n};var foldr=function(e,t,n){eachr(e,(function(e,a){n=t(n,e,a)}));return n};var foldl=function(e,t,n){each$k(e,(function(e,a){n=t(n,e,a)}));return n};var findUntil$1=function(e,t,n){for(var a=0,o=e.length;a<o;a++){var i=e[a];if(t(i,a))return b.some(i);if(n(i,a))break}return b.none()};var find$3=function(e,t){return findUntil$1(e,t,g)};var findIndex$2=function(e,t){for(var n=0,a=e.length;n<a;n++){var o=e[n];if(t(o,n))return b.some(n)}return b.none()};var flatten=function(e){var t=[];for(var n=0,a=e.length;n<a;++n){if(!f(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);w.apply(t,e[n])}return t};var bind=function(e,t){return flatten(map$3(e,t))};var forall=function(e,t){for(var n=0,a=e.length;n<a;++n){var o=e[n];if(true!==t(o,n))return false}return true};var reverse=function(e){var t=y.call(e,0);t.reverse();return t};var difference=function(e,t){return filter$4(e,(function(e){return!contains$3(t,e)}))};var mapToObject=function(e,t){var n={};for(var a=0,o=e.length;a<o;a++){var i=e[a];n[String(i)]=t(i,a)}return n};var sort=function(e,t){var n=y.call(e,0);n.sort(t);return n};var get$a=function(e,t){return t>=0&&t<e.length?b.some(e[t]):b.none()};var head=function(e){return get$a(e,0)};var last$2=function(e){return get$a(e,e.length-1)};var x=d(Array.from)?Array.from:function(e){return y.call(e)};var findMap=function(e,t){for(var n=0;n<e.length;n++){var a=t(e[n],n);if(a.isSome())return a}return b.none()};var S=Object.keys;var E=Object.hasOwnProperty;var each$j=function(e,t){var n=S(e);for(var a=0,o=n.length;a<o;a++){var i=n[a];var u=e[i];t(u,i)}};var map$2=function(e,t){return tupleMap(e,(function(e,n){return{k:n,v:t(e,n)}}))};var tupleMap=function(e,t){var n={};each$j(e,(function(e,a){var o=t(e,a);n[o.k]=o.v}));return n};var objAcc=function(e){return function(t,n){e[n]=t}};var internalFilter=function(e,t,n,a){var o={};each$j(e,(function(e,o){(t(e,o)?n:a)(e,o)}));return o};var bifilter=function(e,t){var n={};var a={};internalFilter(e,t,objAcc(n),objAcc(a));return{t:n,f:a}};var filter$3=function(e,t){var n={};internalFilter(e,t,objAcc(n),noop);return n};var mapToArray=function(e,t){var n=[];each$j(e,(function(e,a){n.push(t(e,a))}));return n};var values=function(e){return mapToArray(e,identity)};var get$9=function(e,t){return has$2(e,t)?b.from(e[t]):b.none()};var has$2=function(e,t){return E.call(e,t)};var hasNonNullableKey=function(e,t){return has$2(e,t)&&void 0!==e[t]&&null!==e[t]};var equal$1=function(e,t,n){void 0===n&&(n=i);return eqRecord(n).eq(e,t)};var k=Array.isArray;var toArray$1=function(e){if(k(e))return e;var t=[];for(var n=0,a=e.length;n<a;n++)t[n]=e[n];return t};var each$i=function(e,t,n){var a,o;if(!e)return false;n=n||e;if(void 0!==e.length){for(a=0,o=e.length;a<o;a++)if(false===t.call(n,e[a],a,e))return false}else for(a in e)if(has$2(e,a)&&false===t.call(n,e[a],a,e))return false;return true};var map$1=function(e,t){var n=[];each$i(e,(function(a,o){n.push(t(a,o,e))}));return n};var filter$2=function(e,t){var n=[];each$i(e,(function(a,o){t&&!t(a,o,e)||n.push(a)}));return n};var indexOf$1=function(e,t){if(e)for(var n=0,a=e.length;n<a;n++)if(e[n]===t)return n;return-1};var reduce=function(e,t,n,a){var o=v(n)?e[0]:n;for(var i=0;i<e.length;i++)o=t.call(a,o,e[i],i);return o};var findIndex$1=function(e,t,n){var a,o;for(a=0,o=e.length;a<o;a++)if(t.call(n,e[a],a,e))return a;return-1};var last$1=function(e){return e[e.length-1]};var __assign=function(){__assign=Object.assign||function __assign(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};return __assign.apply(this||t,arguments)};function __rest(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n}function __spreadArray(e,t,n){if(n||2===arguments.length)for(var a,o=0,i=t.length;o<i;o++)if(a||!(o in t)){a||(a=Array.prototype.slice.call(t,0,o));a[o]=t[o]}return e.concat(a||Array.prototype.slice.call(t))}var cached=function(e){var t=false;var n;return function(){var a=[];for(var o=0;o<arguments.length;o++)a[o]=arguments[o];if(!t){t=true;n=e.apply(null,a)}return n}};var DeviceType=function(e,t,n,a){var o=e.isiOS()&&true===/ipad/i.test(n);var i=e.isiOS()&&!o;var u=e.isiOS()||e.isAndroid();var c=u||a("(pointer:coarse)");var f=o||!i&&u&&a("(min-device-width:768px)");var s=i||u&&!f;var l=t.isSafari()&&e.isiOS()&&false===/safari/i.test(n);var v=!s&&!f&&!l;return{isiPad:constant(o),isiPhone:constant(i),isTablet:constant(f),isPhone:constant(s),isTouch:constant(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:constant(l),isDesktop:constant(v)}};var firstMatch=function(e,t){for(var n=0;n<e.length;n++){var a=e[n];if(a.test(t))return a}};var find$2=function(e,t){var n=firstMatch(e,t);if(!n)return{major:0,minor:0};var group=function(e){return Number(t.replace(n,"$"+e))};return nu$4(group(1),group(2))};var detect$3=function(e,t){var n=String(t).toLowerCase();return 0===e.length?unknown$2():find$2(e,n)};var unknown$2=function(){return nu$4(0,0)};var nu$4=function(e,t){return{major:e,minor:t}};var N={nu:nu$4,detect:detect$3,unknown:unknown$2};var detectBrowser$1=function(e,t){return findMap(t.brands,(function(t){var n=t.brand.toLowerCase();return find$3(e,(function(e){var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((function(e){return{current:e.name,version:N.nu(parseInt(t.version,10),0)}}))}))};var detect$2=function(e,t){var n=String(t).toLowerCase();return find$3(e,(function(e){return e.search(n)}))};var detectBrowser=function(e,t){return detect$2(e,t).map((function(e){var n=N.detect(e.versionRegexes,t);return{current:e.name,version:n}}))};var detectOs=function(e,t){return detect$2(e,t).map((function(e){var n=N.detect(e.versionRegexes,t);return{current:e.name,version:n}}))};var removeFromStart=function(e,t){return e.substring(t)};var checkRange=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t};var removeLeading=function(e,t){return startsWith(e,t)?removeFromStart(e,t.length):e};var contains$2=function(e,t){return-1!==e.indexOf(t)};var startsWith=function(e,t){return checkRange(e,t,0)};var blank=function(e){return function(t){return t.replace(e,"")}};var _=blank(/^\s+|\s+$/g);var A=blank(/^\s+/g);var R=blank(/\s+$/g);var isNotEmpty=function(e){return e.length>0};var isEmpty$3=function(e){return!isNotEmpty(e)};var D=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/;var checkContains=function(e){return function(t){return contains$2(t,e)}};var T=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return contains$2(e,"edge/")&&contains$2(e,"chrome")&&contains$2(e,"safari")&&contains$2(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,D],search:function(e){return contains$2(e,"chrome")&&!contains$2(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return contains$2(e,"msie")||contains$2(e,"trident")}},{name:"Opera",versionRegexes:[D,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:checkContains("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:checkContains("firefox")},{name:"Safari",versionRegexes:[D,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(contains$2(e,"safari")||contains$2(e,"mobile/"))&&contains$2(e,"applewebkit")}}];var O=[{name:"Windows",search:checkContains("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return contains$2(e,"iphone")||contains$2(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:checkContains("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:checkContains("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:checkContains("linux"),versionRegexes:[]},{name:"Solaris",search:checkContains("sunos"),versionRegexes:[]},{name:"FreeBSD",search:checkContains("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:checkContains("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}];var B={browsers:constant(T),oses:constant(O)};var P="Edge";var L="Chrome";var I="IE";var M="Opera";var F="Firefox";var U="Safari";var unknown$1=function(){return nu$3({current:void 0,version:N.unknown()})};var nu$3=function(e){var t=e.current;var n=e.version;var isBrowser=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:isBrowser(P),isChrome:isBrowser(L),isIE:isBrowser(I),isOpera:isBrowser(M),isFirefox:isBrowser(F),isSafari:isBrowser(U)}};var z={unknown:unknown$1,nu:nu$3,edge:constant(P),chrome:constant(L),ie:constant(I),opera:constant(M),firefox:constant(F),safari:constant(U)};var j="Windows";var H="iOS";var V="Android";var q="Linux";var $="OSX";var W="Solaris";var K="FreeBSD";var X="ChromeOS";var unknown=function(){return nu$2({current:void 0,version:N.unknown()})};var nu$2=function(e){var t=e.current;var n=e.version;var isOS=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:isOS(j),isiOS:isOS(H),isAndroid:isOS(V),isOSX:isOS($),isLinux:isOS(q),isSolaris:isOS(W),isFreeBSD:isOS(K),isChromeOS:isOS(X)}};var Y={unknown:unknown,nu:nu$2,windows:constant(j),ios:constant(H),android:constant(V),linux:constant(q),osx:constant($),solaris:constant(W),freebsd:constant(K),chromeos:constant(X)};var detect$1=function(e,t,n){var a=B.browsers();var o=B.oses();var i=t.bind((function(e){return detectBrowser$1(a,e)})).orThunk((function(){return detectBrowser(a,e)})).fold(z.unknown,z.nu);var u=detectOs(o,e).fold(Y.unknown,Y.nu);var c=DeviceType(u,i,e,n);return{browser:i,os:u,deviceType:c}};var G={detect:detect$1};var mediaMatch=function(e){return window.matchMedia(e).matches};var J=cached((function(){return G.detect(navigator.userAgent,b.from(navigator.userAgentData),mediaMatch)}));var detect=function(){return J()};var Q=navigator.userAgent;var Z=detect();var ee=Z.browser;var te=Z.os;var re=Z.deviceType;var ne=/WebKit/.test(Q)&&!ee.isEdge();var ae="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL;var oe=-1!==Q.indexOf("Windows Phone");var ie={opera:ee.isOpera(),webkit:ne,ie:!(!ee.isIE()&&!ee.isEdge())&&ee.version.major,gecko:ee.isFirefox(),mac:te.isOSX()||te.isiOS(),iOS:re.isiPad()||re.isiPhone(),android:te.isAndroid(),contentEditable:true,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:true,range:window.getSelection&&"Range"in window,documentMode:ee.isIE()?document.documentMode||7:10,fileApi:ae,ceFalse:true,cacheSuffix:null,container:null,experimentalShadowDom:false,canHaveCSP:!ee.isIE(),desktop:re.isDesktop(),windowsPhone:oe,browser:{current:ee.current,version:ee.version,isChrome:ee.isChrome,isEdge:ee.isEdge,isFirefox:ee.isFirefox,isIE:ee.isIE,isOpera:ee.isOpera,isSafari:ee.isSafari},os:{current:te.current,version:te.version,isAndroid:te.isAndroid,isChromeOS:te.isChromeOS,isFreeBSD:te.isFreeBSD,isiOS:te.isiOS,isLinux:te.isLinux,isOSX:te.isOSX,isSolaris:te.isSolaris,isWindows:te.isWindows},deviceType:{isDesktop:re.isDesktop,isiPad:re.isiPad,isiPhone:re.isiPhone,isPhone:re.isPhone,isTablet:re.isTablet,isTouch:re.isTouch,isWebView:re.isWebView}};var ue=/^\s*|\s*$/g;var trim$3=function(e){return null===e||void 0===e?"":(""+e).replace(ue,"")};var is$3=function(e,t){return t?!("array"!==t||!k(e))||typeof e===t:void 0!==e};var makeMap$4=function(e,t,n){var a;e=e||[];t=t||",";"string"===typeof e&&(e=e.split(t));n=n||{};a=e.length;while(a--)n[e[a]]={};return n};var ce=has$2;var create$9=function(e,n,a){var o=this||t;var i,u,c,f=0;e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e);var s=e[3].match(/(^|\.)(\w+)$/i)[2];var l=o.createNS(e[3].replace(/\.\w+$/,""),a);if(!l[s])if("static"!==e[2]){if(!n[s]){n[s]=function(){};f=1}l[s]=n[s];o.extend(l[s].prototype,n);if(e[5]){i=o.resolve(e[5]).prototype;u=e[5].match(/\.(\w+)$/i)[1];c=l[s];l[s]=f?function(){return i[u].apply(this||t,arguments)}:function(){(this||t).parent=i[u];return c.apply(this||t,arguments)};l[s].prototype[s]=l[s];o.each(i,(function(e,t){l[s].prototype[t]=i[t]}));o.each(n,(function(e,n){i[n]?l[s].prototype[n]=function(){(this||t).parent=i[n];return e.apply(this||t,arguments)}:n!==s&&(l[s].prototype[n]=e)}))}o.each(n.static,(function(e,t){l[s][t]=e}))}else{l[s]=n;(this||t).onCreate&&this.onCreate(e[2],e[3],l[s])}};var extend$6=function(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=0;a<t.length;a++){var o=t[a];for(var i in o)if(has$2(o,i)){var u=o[i];void 0!==u&&(e[i]=u)}}return e};var walk$3=function(e,n,a,o){o=o||this||t;if(e){a&&(e=e[a]);each$i(e,(function(e,t){if(false===n.call(o,e,t,a))return false;walk$3(e,n,a,o)}))}};var createNS=function(e,t){var n,a;t=t||window;e=e.split(".");for(n=0;n<e.length;n++){a=e[n];t[a]||(t[a]={});t=t[a]}return t};var resolve$3=function(e,t){var n,a;t=t||window;e=e.split(".");for(n=0,a=e.length;n<a;n++){t=t[e[n]];if(!t)break}return t};var explode$4=function(e,t){return!e||is$3(e,"array")?e:map$1(e.split(t||","),trim$3)};var _addCacheSuffix=function(e){var t=ie.cacheSuffix;t&&(e+=(-1===e.indexOf("?")?"?":"&")+t);return e};var fe={trim:trim$3,isArray:k,is:is$3,toArray:toArray$1,makeMap:makeMap$4,each:each$i,map:map$1,grep:filter$2,inArray:indexOf$1,hasOwn:ce,extend:extend$6,create:create$9,walk:walk$3,createNS:createNS,resolve:resolve$3,explode:explode$4,_addCacheSuffix:_addCacheSuffix};var fromHtml$1=function(e,t){var n=t||document;var a=n.createElement("div");a.innerHTML=e;if(!a.hasChildNodes()||a.childNodes.length>1){console.error("HTML does not have a single root node",e);throw new Error("HTML must have a single root node")}return fromDom$2(a.childNodes[0])};var fromTag=function(e,t){var n=t||document;var a=n.createElement(e);return fromDom$2(a)};var fromText=function(e,t){var n=t||document;var a=n.createTextNode(e);return fromDom$2(a)};var fromDom$2=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:e}};var fromPoint$1=function(e,t,n){return b.from(e.dom.elementFromPoint(t,n)).map(fromDom$2)};var se={fromHtml:fromHtml$1,fromTag:fromTag,fromText:fromText,fromDom:fromDom$2,fromPoint:fromPoint$1};var toArray=function(e,t){var n=[];var recurse=function(e){n.push(e);return t(e)};var a=t(e);do{a=a.bind(recurse)}while(a.isSome());return n};var compareDocumentPosition=function(e,t,n){return 0!==(e.compareDocumentPosition(t)&n)};var documentPositionContainedBy=function(e,t){return compareDocumentPosition(e,t,Node.DOCUMENT_POSITION_CONTAINED_BY)};var le=8;var ve=9;var de=11;var me=1;var ge=3;var is$2=function(e,t){var n=e.dom;if(n.nodeType!==me)return false;var a=n;if(void 0!==a.matches)return a.matches(t);if(void 0!==a.msMatchesSelector)return a.msMatchesSelector(t);if(void 0!==a.webkitMatchesSelector)return a.webkitMatchesSelector(t);if(void 0!==a.mozMatchesSelector)return a.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")};var bypassSelector=function(e){return e.nodeType!==me&&e.nodeType!==ve&&e.nodeType!==de||0===e.childElementCount};var all=function(e,t){var n=void 0===t?document:t.dom;return bypassSelector(n)?[]:map$3(n.querySelectorAll(e),se.fromDom)};var one=function(e,t){var n=void 0===t?document:t.dom;return bypassSelector(n)?b.none():b.from(n.querySelector(e)).map(se.fromDom)};var eq=function(e,t){return e.dom===t.dom};var regularContains=function(e,t){var n=e.dom;var a=t.dom;return n!==a&&n.contains(a)};var ieContains=function(e,t){return documentPositionContainedBy(e.dom,t.dom)};var contains$1=function(e,t){return detect().browser.isIE()?ieContains(e,t):regularContains(e,t)};"undefined"!==typeof window?window:Function("return this;")();var name=function(e){var t=e.dom.nodeName;return t.toLowerCase()};var type=function(e){return e.dom.nodeType};var isType=function(e){return function(t){return type(t)===e}};var isComment$1=function(e){return type(e)===le||"#comment"===name(e)};var pe=isType(me);var he=isType(ge);var be=isType(ve);var ye=isType(de);var isTag=function(e){return function(t){return pe(t)&&name(t)===e}};var owner$1=function(e){return se.fromDom(e.dom.ownerDocument)};var documentOrOwner=function(e){return be(e)?e:owner$1(e)};var documentElement=function(e){return se.fromDom(documentOrOwner(e).dom.documentElement)};var defaultView=function(e){return se.fromDom(documentOrOwner(e).dom.defaultView)};var parent=function(e){return b.from(e.dom.parentNode).map(se.fromDom)};var parents$1=function(e,t){var n=d(t)?t:g;var a=e.dom;var o=[];while(null!==a.parentNode&&void 0!==a.parentNode){var i=a.parentNode;var u=se.fromDom(i);o.push(u);if(true===n(u))break;a=i}return o};var siblings=function(e){var filterSelf=function(t){return filter$4(t,(function(t){return!eq(e,t)}))};return parent(e).map(children).map(filterSelf).getOr([])};var prevSibling=function(e){return b.from(e.dom.previousSibling).map(se.fromDom)};var nextSibling=function(e){return b.from(e.dom.nextSibling).map(se.fromDom)};var prevSiblings=function(e){return reverse(toArray(e,prevSibling))};var nextSiblings=function(e){return toArray(e,nextSibling)};var children=function(e){return map$3(e.dom.childNodes,se.fromDom)};var child$1=function(e,t){var n=e.dom.childNodes;return b.from(n[t]).map(se.fromDom)};var firstChild=function(e){return child$1(e,0)};var lastChild=function(e){return child$1(e,e.dom.childNodes.length-1)};var childNodesCount=function(e){return e.dom.childNodes.length};var getHead=function(e){var t=e.dom.head;if(null===t||void 0===t)throw new Error("Head is not available yet");return se.fromDom(t)};var isShadowRoot=function(e){return ye(e)&&isNonNullable(e.dom.host)};var Ce=d(Element.prototype.attachShadow)&&d(Node.prototype.getRootNode);var we=constant(Ce);var xe=Ce?function(e){return se.fromDom(e.dom.getRootNode())}:documentOrOwner;var getStyleContainer=function(e){return isShadowRoot(e)?e:getHead(documentOrOwner(e))};var getShadowRoot=function(e){var t=xe(e);return isShadowRoot(t)?b.some(t):b.none()};var getShadowHost=function(e){return se.fromDom(e.dom.host)};var getOriginalEventTarget=function(e){if(we()&&isNonNullable(e.target)){var t=se.fromDom(e.target);if(pe(t)&&isOpenShadowHost(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return head(n)}}return b.from(e.target)};var isOpenShadowHost=function(e){return isNonNullable(e.dom.shadowRoot)};var before$4=function(e,t){var n=parent(e);n.each((function(n){n.dom.insertBefore(t.dom,e.dom)}))};var after$3=function(e,t){var n=nextSibling(e);n.fold((function(){var n=parent(e);n.each((function(e){append$1(e,t)}))}),(function(e){before$4(e,t)}))};var prepend=function(e,t){var n=firstChild(e);n.fold((function(){append$1(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))};var append$1=function(e,t){e.dom.appendChild(t.dom)};var wrap$3=function(e,t){before$4(e,t);append$1(t,e)};var before$3=function(e,t){each$k(t,(function(t){before$4(e,t)}))};var append=function(e,t){each$k(t,(function(t){append$1(e,t)}))};var empty=function(e){e.dom.textContent="";each$k(children(e),(function(e){remove$7(e)}))};var remove$7=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)};var unwrap=function(e){var t=children(e);t.length>0&&before$3(e,t);remove$7(e)};var inBody=function(e){var t=he(e)?e.dom.parentNode:e.dom;if(void 0===t||null===t||null===t.ownerDocument)return false;var n=t.ownerDocument;return getShadowRoot(se.fromDom(t)).fold((function(){return n.body.contains(t)}),compose1(inBody,getShadowHost))};var r=function(e,t){var translate=function(n,a){return r(e+n,t+a)};return{left:e,top:t,translate:translate}};var Se=r;var boxPosition=function(e){var t=e.getBoundingClientRect();return Se(t.left,t.top)};var firstDefinedOrZero=function(e,t){return void 0!==e?e:void 0!==t?t:0};var absolute=function(e){var t=e.dom.ownerDocument;var n=t.body;var a=t.defaultView;var o=t.documentElement;if(n===e.dom)return Se(n.offsetLeft,n.offsetTop);var i=firstDefinedOrZero(null===a||void 0===a?void 0:a.pageYOffset,o.scrollTop);var u=firstDefinedOrZero(null===a||void 0===a?void 0:a.pageXOffset,o.scrollLeft);var c=firstDefinedOrZero(o.clientTop,n.clientTop);var f=firstDefinedOrZero(o.clientLeft,n.clientLeft);return viewport(e).translate(u-f,i-c)};var viewport=function(e){var t=e.dom;var n=t.ownerDocument;var a=n.body;return a===t?Se(a.offsetLeft,a.offsetTop):inBody(e)?boxPosition(t):Se(0,0)};var get$8=function(e){var t=void 0!==e?e.dom:document;var n=t.body.scrollLeft||t.documentElement.scrollLeft;var a=t.body.scrollTop||t.documentElement.scrollTop;return Se(n,a)};var to=function(e,t,n){var a=void 0!==n?n.dom:document;var o=a.defaultView;o&&o.scrollTo(e,t)};var intoView=function(e,t){var n=detect().browser.isSafari();n&&d(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(false):e.dom.scrollIntoView(t)};var get$7=function(e){var t=void 0===e?window:e;return detect().browser.isFirefox()?b.none():b.from(t.visualViewport)};var bounds=function(e,t,n,a){return{x:e,y:t,width:n,height:a,right:e+n,bottom:t+a}};var getBounds=function(e){var t=void 0===e?window:e;var n=t.document;var a=get$8(se.fromDom(n));return get$7(t).fold((function(){var e=t.document.documentElement;var n=e.clientWidth;var o=e.clientHeight;return bounds(a.left,a.top,n,o)}),(function(e){return bounds(Math.max(e.pageLeft,a.left),Math.max(e.pageTop,a.top),e.width,e.height)}))};var isNodeType=function(e){return function(t){return!!t&&t.nodeType===e}};var isRestrictedNode=function(e){return!!e&&!Object.getPrototypeOf(e)};var Ee=isNodeType(1);var matchNodeNames=function(e){var t=e.map((function(e){return e.toLowerCase()}));return function(e){if(e&&e.nodeName){var n=e.nodeName.toLowerCase();return contains$3(t,n)}return false}};var matchStyleValues=function(e,t){var n=t.toLowerCase().split(" ");return function(t){if(Ee(t))for(var a=0;a<n.length;a++){var o=t.ownerDocument.defaultView.getComputedStyle(t,null);var i=o?o.getPropertyValue(e):null;if(i===n[a])return true}return false}};var hasAttribute=function(e){return function(t){return Ee(t)&&t.hasAttribute(e)}};var hasAttributeValue=function(e,t){return function(n){return Ee(n)&&n.getAttribute(e)===t}};var isBogus$2=function(e){return Ee(e)&&e.hasAttribute("data-mce-bogus")};var isBogusAll$1=function(e){return Ee(e)&&"all"===e.getAttribute("data-mce-bogus")};var isTable$3=function(e){return Ee(e)&&"TABLE"===e.tagName};var hasContentEditableState=function(e){return function(t){if(Ee(t)){if(t.contentEditable===e)return true;if(t.getAttribute("data-mce-contenteditable")===e)return true}return false}};var ke=matchNodeNames(["textarea","input"]);var Ne=isNodeType(3);var _e=isNodeType(8);var Ae=isNodeType(9);var Re=isNodeType(11);var De=matchNodeNames(["br"]);var Te=matchNodeNames(["img"]);var Oe=hasContentEditableState("true");var Be=hasContentEditableState("false");var Pe=matchNodeNames(["td","th"]);var Le=matchNodeNames(["video","audio","object","embed"]);var is$1=function(e,t,n){void 0===n&&(n=tripleEquals);return e.exists((function(e){return n(e,t)}))};var cat=function(e){var t=[];var push=function(e){t.push(e)};for(var n=0;n<e.length;n++)e[n].each(push);return t};var lift2=function(e,t,n){return e.isSome()&&t.isSome()?b.some(n(e.getOrDie(),t.getOrDie())):b.none()};var lift3=function(e,t,n,a){return e.isSome()&&t.isSome()&&n.isSome()?b.some(a(e.getOrDie(),t.getOrDie(),n.getOrDie())):b.none()};var someIf=function(e,t){return e?b.some(t):b.none()};var isSupported=function(e){return void 0!==e.style&&d(e.style.getPropertyValue)};var rawSet=function(e,t,n){if(!(u(n)||l(n)||m(n))){console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e);throw new Error("Attribute value was not simple")}e.setAttribute(t,n+"")};var set$1=function(e,t,n){rawSet(e.dom,t,n)};var setAll$1=function(e,t){var n=e.dom;each$j(t,(function(e,t){rawSet(n,t,e)}))};var get$6=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n};var getOpt=function(e,t){return b.from(get$6(e,t))};var has$1=function(e,t){var n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)};var remove$6=function(e,t){e.dom.removeAttribute(t)};var clone$3=function(e){return foldl(e.dom.attributes,(function(e,t){e[t.name]=t.value;return e}),{})};var internalSet=function(e,t,n){if(!u(n)){console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e);throw new Error("CSS value must be a string: "+n)}isSupported(e)&&e.style.setProperty(t,n)};var setAll=function(e,t){var n=e.dom;each$j(t,(function(e,t){internalSet(n,t,e)}))};var get$5=function(e,t){var n=e.dom;var a=window.getComputedStyle(n);var o=a.getPropertyValue(t);return""!==o||inBody(e)?o:getUnsafeProperty(n,t)};var getUnsafeProperty=function(e,t){return isSupported(e)?e.style.getPropertyValue(t):""};var getRaw=function(e,t){var n=e.dom;var a=getUnsafeProperty(n,t);return b.from(a).filter((function(e){return e.length>0}))};var getAllRaw=function(e){var t={};var n=e.dom;if(isSupported(n))for(var a=0;a<n.style.length;a++){var o=n.style.item(a);t[o]=n.style[o]}return t};var reflow=function(e){return e.dom.offsetWidth};var Ie=detect().browser;var firstElement=function(e){return find$3(e,pe)};var getTableCaptionDeltaY=function(e){return Ie.isFirefox()&&"table"===name(e)?firstElement(children(e)).filter((function(e){return"caption"===name(e)})).bind((function(e){return firstElement(nextSiblings(e)).map((function(t){var n=t.dom.offsetTop;var a=e.dom.offsetTop;var o=e.dom.offsetHeight;return n<=a?-o:0}))})).getOr(0):0};var hasChild=function(e,t){return e.children&&contains$3(e.children,t)};var getPos=function(e,t,n){var a=0,o=0;var i=e.ownerDocument;n=n||e;if(t){if(n===e&&t.getBoundingClientRect&&"static"===get$5(se.fromDom(e),"position")){var u=t.getBoundingClientRect();a=u.left+(i.documentElement.scrollLeft||e.scrollLeft)-i.documentElement.clientLeft;o=u.top+(i.documentElement.scrollTop||e.scrollTop)-i.documentElement.clientTop;return{x:a,y:o}}var c=t;while(c&&c!==n&&c.nodeType&&!hasChild(c,n)){var f=c;a+=f.offsetLeft||0;o+=f.offsetTop||0;c=f.offsetParent}c=t.parentNode;while(c&&c!==n&&c.nodeType&&!hasChild(c,n)){a-=c.scrollLeft||0;o-=c.scrollTop||0;c=c.parentNode}o+=getTableCaptionDeltaY(se.fromDom(t))}return{x:a,y:o}};var Me={},Fe={exports:Me};(function(e,n,o,i){(function(t,a){"object"===typeof n&&"undefined"!==typeof o?o.exports=a():"function"===typeof e&&e.amd?e(a):(t="undefined"!==typeof globalThis?globalThis:t||self,t.EphoxContactWrapper=a())})(this||t,(function(){var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{};var n={exports:{}};(function(n){(function(e){var o=setTimeout;function noop(){}function bind(e,t){return function(){e.apply(t,arguments)}}function Promise(e){if("object"!==typeof(this||t))throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("not a function");(this||t)._state=0;(this||t)._handled=false;(this||t)._value=void 0;(this||t)._deferreds=[];doResolve(e,this||t)}function handle(e,t){while(3===e._state)e=e._value;if(0!==e._state){e._handled=true;Promise._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var a;try{a=n(e._value)}catch(e){reject(t.promise,e);return}resolve(t.promise,a)}else(1===e._state?resolve:reject)(t.promise,e._value)}))}else e._deferreds.push(t)}function resolve(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var n=t.then;if(t instanceof Promise){e._state=3;e._value=t;finale(e);return}if("function"===typeof n){doResolve(bind(n,t),e);return}}e._state=1;e._value=t;finale(e)}catch(t){reject(e,t)}}function reject(e,t){e._state=2;e._value=t;finale(e)}function finale(e){2===e._state&&0===e._deferreds.length&&Promise._immediateFn((function(){e._handled||Promise._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)handle(e,e._deferreds[t]);e._deferreds=null}function Handler(e,n,a){(this||t).onFulfilled="function"===typeof e?e:null;(this||t).onRejected="function"===typeof n?n:null;(this||t).promise=a}function doResolve(e,t){var n=false;try{e((function(e){if(!n){n=true;resolve(t,e)}}),(function(e){if(!n){n=true;reject(t,e)}}))}catch(e){if(n)return;n=true;reject(t,e)}}Promise.prototype.catch=function(e){return this.then(null,e)};Promise.prototype.then=function(e,n){var a=new(this||t).constructor(noop);handle(this||t,new Handler(e,n,a));return a};Promise.all=function(e){var t=Array.prototype.slice.call(e);return new Promise((function(e,n){if(0===t.length)return e([]);var a=t.length;function res(o,i){try{if(i&&("object"===typeof i||"function"===typeof i)){var u=i.then;if("function"===typeof u){u.call(i,(function(e){res(o,e)}),n);return}}t[o]=i;0===--a&&e(t)}catch(e){n(e)}}for(var o=0;o<t.length;o++)res(o,t[o])}))};Promise.resolve=function(e){return e&&"object"===typeof e&&e.constructor===Promise?e:new Promise((function(t){t(e)}))};Promise.reject=function(e){return new Promise((function(t,n){n(e)}))};Promise.race=function(e){return new Promise((function(t,n){for(var a=0,o=e.length;a<o;a++)e[a].then(t,n)}))};Promise._immediateFn="function"===typeof a.nextTick?function(e){a.nextTick(e)}:function(e){o(e,0)};Promise._unhandledRejectionFn=function _unhandledRejectionFn(e){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};Promise._setImmediateFn=function _setImmediateFn(e){Promise._immediateFn=e};Promise._setUnhandledRejectionFn=function _setUnhandledRejectionFn(e){Promise._unhandledRejectionFn=e};n.exports?n.exports=Promise:e.Promise||(e.Promise=Promise)})(e)})(n);var o=n.exports;var i=function(){return"undefined"!==typeof window?window:Function("return this;")()}();var u={boltExport:i.Promise||o};return u}))})(void 0,Me,Fe);var Ue=Fe.exports.boltExport;var nu$1=function(e){var t=b.none();var n=[];var map=function(e){return nu$1((function(t){get((function(n){t(e(n))}))}))};var get=function(e){isReady()?call(e):n.push(e)};var set=function(e){if(!isReady()){t=b.some(e);run(n);n=[]}};var isReady=function(){return t.isSome()};var run=function(e){each$k(e,call)};var call=function(e){t.each((function(t){setTimeout((function(){e(t)}),0)}))};e(set);return{get:get,map:map,isReady:isReady}};var pure$1=function(e){return nu$1((function(t){t(e)}))};var ze={nu:nu$1,pure:pure$1};var errorReporter=function(e){setTimeout((function(){throw e}),0)};var make=function(e){var get=function(t){e().then(t,errorReporter)};var map=function(t){return make((function(){return e().then(t)}))};var bind=function(t){return make((function(){return e().then((function(e){return t(e).toPromise()}))}))};var anonBind=function(t){return make((function(){return e().then((function(){return t.toPromise()}))}))};var toLazy=function(){return ze.nu(get)};var toCached=function(){var t=null;return make((function(){null===t&&(t=e());return t}))};var t=e;return{map:map,bind:bind,anonBind:anonBind,toLazy:toLazy,toCached:toCached,toPromise:t,get:get}};var nu=function(e){return make((function(){return new Ue(e)}))};var pure=function(e){return make((function(){return Ue.resolve(e)}))};var je={nu:nu,pure:pure};var par$1=function(e,t){return t((function(t){var n=[];var a=0;var cb=function(o){return function(i){n[o]=i;a++;a>=e.length&&t(n)}};0===e.length?t([]):each$k(e,(function(e,t){e.get(cb(t))}))}))};var par=function(e){return par$1(e,je.nu)};var value$1=function(e){var or=function(t){return value$1(e)};var orThunk=function(t){return value$1(e)};var map=function(t){return value$1(t(e))};var mapError=function(t){return value$1(e)};var each=function(t){t(e)};var bind=function(t){return t(e)};var fold=function(t,n){return n(e)};var exists=function(t){return t(e)};var forall=function(t){return t(e)};var toOptional=function(){return b.some(e)};return{isValue:p,isError:g,getOr:constant(e),getOrThunk:constant(e),getOrDie:constant(e),or:or,orThunk:orThunk,fold:fold,map:map,mapError:mapError,each:each,bind:bind,exists:exists,forall:forall,toOptional:toOptional}};var error=function(e){var getOrThunk=function(e){return e()};var getOrDie=function(){return die(String(e))()};var t=identity;var orThunk=function(e){return e()};var map=function(t){return error(e)};var mapError=function(t){return error(t(e))};var bind=function(t){return error(e)};var fold=function(t,n){return t(e)};return{isValue:g,isError:p,getOr:identity,getOrThunk:getOrThunk,getOrDie:getOrDie,or:t,orThunk:orThunk,fold:fold,map:map,mapError:mapError,each:noop,bind:bind,exists:g,forall:p,toOptional:b.none}};var fromOption=function(e,t){return e.fold((function(){return error(t)}),value$1)};var He={value:value$1,error:error,fromOption:fromOption};var generate$1=function(e){if(!f(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[];var n={};each$k(e,(function(a,o){var i=S(a);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0];var c=a[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!f(c))throw new Error("case arguments must be an array");t.push(u);n[u]=function(){var n=[];for(var a=0;a<arguments.length;a++)n[a]=arguments[a];var i=n.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+i);var match=function(e){var a=S(e);if(t.length!==a.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+a.join(","));var o=forall(t,(function(e){return contains$3(a,e)}));if(!o)throw new Error("Not all branches were specified when using match. Specified: "+a.join(", ")+"\nRequired: "+t.join(", "));return e[u].apply(null,n)};return{fold:function(){var t=[];for(var a=0;a<arguments.length;a++)t[a]=arguments[a];if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);var i=t[o];return i.apply(null,n)},match:match,log:function(e){console.log(e,{constructors:t,constructor:u,params:n})}}}}));return n};var Ve={generate:generate$1};Ve.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var unite=function(e){return e.fold(identity,identity)};function ClosestOrAncestor(e,t,n,a,o){return e(n,a)?b.some(n):d(o)&&o(n)?b.none():t(n,a,o)}var ancestor$3=function(e,t,n){var a=e.dom;var o=d(n)?n:g;while(a.parentNode){a=a.parentNode;var i=se.fromDom(a);if(t(i))return b.some(i);if(o(i))break}return b.none()};var closest$3=function(e,t,n){var is=function(e,t){return t(e)};return ClosestOrAncestor(is,ancestor$3,e,t,n)};var sibling$2=function(e,t){var n=e.dom;return n.parentNode?child(se.fromDom(n.parentNode),(function(n){return!eq(e,n)&&t(n)})):b.none()};var child=function(e,t){var pred=function(e){return t(se.fromDom(e))};var n=find$3(e.dom.childNodes,pred);return n.map(se.fromDom)};var ancestor$2=function(e,t,n){return ancestor$3(e,(function(e){return is$2(e,t)}),n)};var descendant=function(e,t){return one(t,e)};var closest$2=function(e,t,n){var is=function(e,t){return is$2(e,t)};return ClosestOrAncestor(is,ancestor$2,e,t,n)};var qe=window.Promise?window.Promise:Ue;var $e;var requestAnimationFrame=function(e,t){var n=window.requestAnimationFrame;var a=["ms","moz","webkit"];var featurefill=function(e){window.setTimeout(e,0)};for(var o=0;o<a.length&&!n;o++)n=window[a[o]+"RequestAnimationFrame"];n||(n=featurefill);n(e,t)};var wrappedSetTimeout=function(e,t){"number"!==typeof t&&(t=0);return setTimeout(e,t)};var wrappedSetInterval=function(e,t){"number"!==typeof t&&(t=1);return setInterval(e,t)};var wrappedClearTimeout=function(e){return clearTimeout(e)};var wrappedClearInterval=function(e){return clearInterval(e)};var debounce=function(e,n){var a;var func=function(){var o=[];for(var i=0;i<arguments.length;i++)o[i]=arguments[i];clearTimeout(a);a=wrappedSetTimeout((function(){e.apply(this||t,o)}),n)};func.stop=function(){clearTimeout(a)};return func};var We={requestAnimationFrame:function(e,t){$e?$e.then(e):$e=new qe((function(e){t||(t=document.body);requestAnimationFrame(e,t)})).then(e)},setTimeout:wrappedSetTimeout,setInterval:wrappedSetInterval,setEditorTimeout:function(e,t,n){return wrappedSetTimeout((function(){e.removed||t()}),n)},setEditorInterval:function(e,t,n){var a=wrappedSetInterval((function(){e.removed?clearInterval(a):t()}),n);return a},debounce:debounce,throttle:debounce,clearInterval:wrappedClearInterval,clearTimeout:wrappedClearTimeout};var StyleSheetLoader=function(e,t){void 0===t&&(t={});var n=0;var a={};var o=se.fromDom(e);var i=documentOrOwner(o);var u=t.maxLoadTime||5e3;var _setReferrerPolicy=function(e){t.referrerPolicy=e};var addStyle=function(e){append$1(getStyleContainer(o),e)};var removeStyle=function(e){var t=getStyleContainer(o);descendant(t,"#"+e).each(remove$7)};var getOrCreateState=function(e){return get$9(a,e).getOrThunk((function(){return{id:"mce-u"+n++,passed:[],failed:[],count:0}}))};var load=function(n,o,c){var f;var s=fe._addCacheSuffix(n);var l=getOrCreateState(s);a[s]=l;l.count++;var resolve=function(e,t){var n=e.length;while(n--)e[n]();l.status=t;l.passed=[];l.failed=[];if(f){f.onload=null;f.onerror=null;f=null}};var passed=function(){return resolve(l.passed,2)};var failed=function(){return resolve(l.failed,3)};var wait=function(e,t){e()||(Date.now()-d<u?We.setTimeout(t):failed())};var waitForWebKitLinkLoaded=function(){wait((function(){var t=e.styleSheets;var n=t.length;while(n--){var a=t[n];var o=a.ownerNode;if(o&&o.id===f.id){passed();return true}}return false}),waitForWebKitLinkLoaded)};o&&l.passed.push(o);c&&l.failed.push(c);if(1!==l.status)if(2!==l.status)if(3!==l.status){l.status=1;var v=se.fromTag("link",i.dom);setAll$1(v,{rel:"stylesheet",type:"text/css",id:l.id});var d=Date.now();t.contentCssCors&&set$1(v,"crossOrigin","anonymous");t.referrerPolicy&&set$1(v,"referrerpolicy",t.referrerPolicy);f=v.dom;f.onload=waitForWebKitLinkLoaded;f.onerror=failed;addStyle(v);set$1(v,"href",s)}else failed();else passed()};var loadF=function(e){return je.nu((function(t){load(e,compose(t,constant(He.value(e))),compose(t,constant(He.error(e))))}))};var loadAll=function(e,t,n){par(map$3(e,loadF)).get((function(e){var a=partition(e,(function(e){return e.isValue()}));a.fail.length>0?n(a.fail.map(unite)):t(a.pass.map(unite))}))};var unload=function(e){var t=fe._addCacheSuffix(e);get$9(a,t).each((function(e){var n=--e.count;if(0===n){delete a[t];removeStyle(e.id)}}))};var unloadAll=function(e){each$k(e,(function(e){unload(e)}))};return{load:load,loadAll:loadAll,unload:unload,unloadAll:unloadAll,_setReferrerPolicy:_setReferrerPolicy}};var create$8=function(){var e=new WeakMap;var forElement=function(t,n){var a=xe(t);var o=a.dom;return b.from(e.get(o)).getOrThunk((function(){var t=StyleSheetLoader(o,n);e.set(o,t);return t}))};return{forElement:forElement}};var Ke=create$8();var Xe=function(){function DomTreeWalker(e,n){(this||t).node=e;(this||t).rootNode=n;(this||t).current=(this||t).current.bind(this||t);(this||t).next=(this||t).next.bind(this||t);(this||t).prev=(this||t).prev.bind(this||t);(this||t).prev2=(this||t).prev2.bind(this||t)}DomTreeWalker.prototype.current=function(){return(this||t).node};DomTreeWalker.prototype.next=function(e){(this||t).node=this.findSibling((this||t).node,"firstChild","nextSibling",e);return(this||t).node};DomTreeWalker.prototype.prev=function(e){(this||t).node=this.findSibling((this||t).node,"lastChild","previousSibling",e);return(this||t).node};DomTreeWalker.prototype.prev2=function(e){(this||t).node=this.findPreviousNode((this||t).node,"lastChild","previousSibling",e);return(this||t).node};DomTreeWalker.prototype.findSibling=function(e,n,a,o){var i,u;if(e){if(!o&&e[n])return e[n];if(e!==(this||t).rootNode){i=e[a];if(i)return i;for(u=e.parentNode;u&&u!==(this||t).rootNode;u=u.parentNode){i=u[a];if(i)return i}}}};DomTreeWalker.prototype.findPreviousNode=function(e,n,a,o){var i,u,c;if(e){i=e[a];if((this||t).rootNode&&i===(this||t).rootNode)return;if(i){if(!o)for(c=i[n];c;c=c[n])if(!c[n])return c;return i}u=e.parentNode;if(u&&u!==(this||t).rootNode)return u}};return DomTreeWalker}();var Ye=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"];var Ge=["td","th"];var Je=["thead","tbody","tfoot"];var Qe=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"];var Ze=["h1","h2","h3","h4","h5","h6"];var et=["li","dd","dt"];var tt=["ul","ol","dl"];var rt=["pre","script","textarea","style"];var lazyLookup=function(e){var t;return function(n){t=t||mapToObject(e,p);return has$2(t,name(n))}};var nt=lazyLookup(Ze);var at=lazyLookup(Ye);var isTable$2=function(e){return"table"===name(e)};var isInline$1=function(e){return pe(e)&&!at(e)};var isBr$4=function(e){return pe(e)&&"br"===name(e)};var ot=lazyLookup(Qe);var it=lazyLookup(tt);var ut=lazyLookup(et);var ct=lazyLookup(Je);var ft=lazyLookup(Ge);var st=lazyLookup(rt);var ancestor$1=function(e,t,n){return ancestor$2(e,t,n).isSome()};var lt="\ufeff";var vt=" ";var isZwsp$1=function(e){return e===lt};var removeZwsp=function(e){return e.replace(/\uFEFF/g,"")};var dt=lt;var mt=isZwsp$1;var gt=removeZwsp;var pt=Ee;var ht=Ne;var isCaretContainerBlock$1=function(e){ht(e)&&(e=e.parentNode);return pt(e)&&e.hasAttribute("data-mce-caret")};var isCaretContainerInline=function(e){return ht(e)&&mt(e.data)};var isCaretContainer$2=function(e){return isCaretContainerBlock$1(e)||isCaretContainerInline(e)};var hasContent=function(e){return e.firstChild!==e.lastChild||!De(e.firstChild)};var insertInline$1=function(e,t){var n=e.ownerDocument;var a=n.createTextNode(dt);var o=e.parentNode;if(t){i=e.previousSibling;if(ht(i)){if(isCaretContainer$2(i))return i;if(endsWithCaretContainer$1(i))return i.splitText(i.data.length-1)}o.insertBefore(a,e)}else{var i=e.nextSibling;if(ht(i)){if(isCaretContainer$2(i))return i;if(startsWithCaretContainer$1(i)){i.splitText(1);return i}}e.nextSibling?o.insertBefore(a,e.nextSibling):o.appendChild(a)}return a};var isBeforeInline=function(e){var t=e.container();return!!Ne(t)&&(t.data.charAt(e.offset())===dt||e.isAtStart()&&isCaretContainerInline(t.previousSibling))};var isAfterInline=function(e){var t=e.container();return!!Ne(t)&&(t.data.charAt(e.offset()-1)===dt||e.isAtEnd()&&isCaretContainerInline(t.nextSibling))};var createBogusBr=function(){var e=document.createElement("br");e.setAttribute("data-mce-bogus","1");return e};var insertBlock$1=function(e,t,n){var a=t.ownerDocument;var o=a.createElement(e);o.setAttribute("data-mce-caret",n?"before":"after");o.setAttribute("data-mce-bogus","all");o.appendChild(createBogusBr());var i=t.parentNode;n?i.insertBefore(o,t):t.nextSibling?i.insertBefore(o,t.nextSibling):i.appendChild(o);return o};var startsWithCaretContainer$1=function(e){return ht(e)&&e.data[0]===dt};var endsWithCaretContainer$1=function(e){return ht(e)&&e.data[e.data.length-1]===dt};var trimBogusBr=function(e){var t=e.getElementsByTagName("br");var n=t[t.length-1];isBogus$2(n)&&n.parentNode.removeChild(n)};var showCaretContainerBlock=function(e){if(e&&e.hasAttribute("data-mce-caret")){trimBogusBr(e);e.removeAttribute("data-mce-caret");e.removeAttribute("data-mce-bogus");e.removeAttribute("style");e.removeAttribute("_moz_abspos");return e}return null};var isRangeInCaretContainerBlock=function(e){return isCaretContainerBlock$1(e.startContainer)};var bt=Oe;var yt=Be;var Ct=De;var wt=Ne;var xt=matchNodeNames(["script","style","textarea"]);var St=matchNodeNames(["img","input","textarea","hr","iframe","video","audio","object","embed"]);var Et=matchNodeNames(["table"]);var kt=isCaretContainer$2;var isCaretCandidate$3=function(e){return!kt(e)&&(wt(e)?!xt(e.parentNode):St(e)||Ct(e)||Et(e)||isNonUiContentEditableFalse(e))};var isUnselectable=function(e){return Ee(e)&&"true"===e.getAttribute("unselectable")};var isNonUiContentEditableFalse=function(e){return false===isUnselectable(e)&&yt(e)};var isInEditable=function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(isNonUiContentEditableFalse(e))return false;if(bt(e))return true}return true};var isAtomicContentEditableFalse=function(e){return!!isNonUiContentEditableFalse(e)&&true!==foldl(x(e.getElementsByTagName("*")),(function(e,t){return e||bt(t)}),false)};var isAtomic$1=function(e){return St(e)||isAtomicContentEditableFalse(e)};var isEditableCaretCandidate$1=function(e,t){return isCaretCandidate$3(e)&&isInEditable(e,t)};var Nt=/^[ \t\r\n]*$/;var isWhitespaceText=function(e){return Nt.test(e)};var hasWhitespacePreserveParent=function(e,t){var n=se.fromDom(t);var a=se.fromDom(e);return ancestor$1(a,"pre,code",curry(eq,n))};var isWhitespace=function(e,t){return Ne(e)&&isWhitespaceText(e.data)&&false===hasWhitespacePreserveParent(e,t)};var isNamedAnchor=function(e){return Ee(e)&&"A"===e.nodeName&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id"))};var isContent$1=function(e,t){return isCaretCandidate$3(e)&&false===isWhitespace(e,t)||isNamedAnchor(e)||_t(e)};var _t=hasAttribute("data-mce-bookmark");var At=hasAttribute("data-mce-bogus");var Rt=hasAttributeValue("data-mce-bogus","all");var isEmptyNode=function(e,t){var n=0;if(isContent$1(e,e))return false;var a=e.firstChild;if(!a)return true;var o=new Xe(a,e);do{if(t){if(Rt(a)){a=o.next(true);continue}if(At(a)){a=o.next();continue}}if(De(a)){n++;a=o.next()}else{if(isContent$1(a,e))return false;a=o.next()}}while(a);return n<=1};var isEmpty$2=function(e,t){void 0===t&&(t=true);return isEmptyNode(e.dom,t)};var isSpan=function(e){return"span"===e.nodeName.toLowerCase()};var isInlineContent=function(e,t){return isNonNullable(e)&&(isContent$1(e,t)||isInline$1(se.fromDom(e)))};var surroundedByInlineContent=function(e,t){var n=new Xe(e,t).prev(false);var a=new Xe(e,t).next(false);var o=v(n)||isInlineContent(n,t);var i=v(a)||isInlineContent(a,t);return o&&i};var isBookmarkNode$2=function(e){return isSpan(e)&&"bookmark"===e.getAttribute("data-mce-type")};var isKeepTextNode=function(e,t){return Ne(e)&&e.data.length>0&&surroundedByInlineContent(e,t)};var isKeepElement=function(e){return!!Ee(e)&&e.childNodes.length>0};var isDocument=function(e){return Re(e)||Ae(e)};var trimNode=function(e,t,n){var a=n||t;if(Ee(t)&&isBookmarkNode$2(t))return t;var o=t.childNodes;for(var i=o.length-1;i>=0;i--)trimNode(e,o[i],a);if(Ee(t)){var u=t.childNodes;1===u.length&&isBookmarkNode$2(u[0])&&t.parentNode.insertBefore(u[0],t)}isDocument(t)||isContent$1(t,a)||isKeepElement(t)||isKeepTextNode(t,a)||e.remove(t);return t};var Dt=fe.makeMap;var Tt=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var Ot=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var Bt=/[<>&\"\']/g;var Pt=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi;var Lt={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"};var It={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"};var Mt={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};var nativeDecode=function(e){var t=se.fromTag("div").dom;t.innerHTML=e;return t.textContent||t.innerText||e};var buildEntitiesLookup=function(e,t){var n,a,o;var i={};if(e){e=e.split(",");t=t||10;for(n=0;n<e.length;n+=2){a=String.fromCharCode(parseInt(e[n],t));if(!It[a]){o="&"+e[n+1]+";";i[a]=o;i[o]=a}}return i}};var Ft=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var encodeRaw=function(e,t){return e.replace(t?Tt:Ot,(function(e){return It[e]||e}))};var encodeAllRaw=function(e){return(""+e).replace(Bt,(function(e){return It[e]||e}))};var encodeNumeric=function(e,t){return e.replace(t?Tt:Ot,(function(e){return e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":It[e]||"&#"+e.charCodeAt(0)+";"}))};var encodeNamed=function(e,t,n){n=n||Ft;return e.replace(t?Tt:Ot,(function(e){return It[e]||n[e]||e}))};var getEncodeFunc=function(e,t){var n=buildEntitiesLookup(t)||Ft;var encodeNamedAndNumeric=function(e,t){return e.replace(t?Tt:Ot,(function(e){return void 0!==It[e]?It[e]:void 0!==n[e]?n[e]:e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"}))};var encodeCustomNamed=function(e,t){return encodeNamed(e,t,n)};var a=Dt(e.replace(/\+/g,","));return a.named&&a.numeric?encodeNamedAndNumeric:a.named?t?encodeCustomNamed:encodeNamed:a.numeric?encodeNumeric:encodeRaw};var decode=function(e){return e.replace(Pt,(function(e,t){if(t){t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10);if(t>65535){t-=65536;return String.fromCharCode(55296+(t>>10),56320+(1023&t))}return Lt[t]||String.fromCharCode(t)}return Mt[e]||Ft[e]||nativeDecode(e)}))};var Ut={encodeRaw:encodeRaw,encodeAllRaw:encodeAllRaw,encodeNumeric:encodeNumeric,encodeNamed:encodeNamed,getEncodeFunc:getEncodeFunc,decode:decode};var zt={},jt={};var Ht=fe.makeMap,Vt=fe.each,qt=fe.extend,$t=fe.explode,Wt=fe.inArray;var split$1=function(e,t){e=fe.trim(e);return e?e.split(t||" "):[]};var compileSchema=function(e){var t={};var n,a;var o,i,u,c;var add=function(e,a,o){var i,u,c;var arrayToMap=function(e,t){var n={};var a,o;for(a=0,o=e.length;a<o;a++)n[e[a]]=t||{};return n};o=o||[];a=a||"";"string"===typeof o&&(o=split$1(o));var f=split$1(e);i=f.length;while(i--){u=split$1([n,a].join(" "));c={attributes:arrayToMap(u),attributesOrder:u,children:arrayToMap(o,jt)};t[f[i]]=c}};var addAttrs=function(e,n){var a,o,i,u;var c=split$1(e);a=c.length;var f=split$1(n);while(a--){o=t[c[a]];for(i=0,u=f.length;i<u;i++){o.attributes[f[i]]={};o.attributesOrder.push(f[i])}}};if(zt[e])return zt[e];n="id accesskey class dir lang style tabindex title role";a="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul";o="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment";if("html4"!==e){n+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate";a+=" article aside details dialog figure main header footer hgroup section nav";o+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"}if("html5-strict"!==e){n+=" xml:lang";c="acronym applet basefont big font strike tt";o=[o,c].join(" ");Vt(split$1(c),(function(e){add(e,"",o)}));u="center dir isindex noframes";a=[a,u].join(" ");i=[a,o].join(" ");Vt(split$1(u),(function(e){add(e,"",i)}))}i=i||[a,o].join(" ");add("html","manifest","head body");add("head","","base command link meta noscript script style title");add("title hr noscript br");add("base","href target");add("link","href rel media hreflang type sizes hreflang");add("meta","name http-equiv content charset");add("style","media type scoped");add("script","src async defer type charset");add("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",i);add("address dt dd div caption","",i);add("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",o);add("blockquote","cite",i);add("ol","reversed start type","li");add("ul","","li");add("li","value",i);add("dl","","dt dd");add("a","href target rel media hreflang type",o);add("q","cite",o);add("ins del","cite datetime",i);add("img","src sizes srcset alt usemap ismap width height");add("iframe","src name width height",i);add("embed","src type width height");add("object","data type typemustmatch name usemap form width height",[i,"param"].join(" "));add("param","name value");add("map","name",[i,"area"].join(" "));add("area","alt coords shape href target rel media hreflang type");add("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":""));add("colgroup","span","col");add("col","span");add("tbody thead tfoot","","tr");add("tr","","td th");add("td","colspan rowspan headers",i);add("th","colspan rowspan headers scope abbr",i);add("form","accept-charset action autocomplete enctype method name novalidate target",i);add("fieldset","disabled form name",[i,"legend"].join(" "));add("label","form for",o);add("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width");add("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?i:o);add("select","disabled form multiple name required size","option optgroup");add("optgroup","disabled label","option");add("option","disabled label selected value");add("textarea","cols dirname disabled form maxlength name readonly required rows wrap");add("menu","type label",[i,"li"].join(" "));add("noscript","",i);if("html4"!==e){add("wbr");add("ruby","",[o,"rt rp"].join(" "));add("figcaption","",i);add("mark rt rp summary bdi","",o);add("canvas","width height",i);add("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[i,"track source"].join(" "));add("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[i,"track source"].join(" "));add("picture","","img source");add("source","src srcset type media sizes");add("track","kind src srclang label default");add("datalist","",[o,"option"].join(" "));add("article section nav aside main header footer","",i);add("hgroup","","h1 h2 h3 h4 h5 h6");add("figure","",[i,"figcaption"].join(" "));add("time","datetime",o);add("dialog","open",i);add("command","type label icon disabled checked radiogroup command");add("output","for form name",o);add("progress","value max",o);add("meter","value min max low high optimum",o);add("details","open",[i,"summary"].join(" "));add("keygen","autofocus challenge disabled form keytype name")}if("html5-strict"!==e){addAttrs("script","language xml:space");addAttrs("style","xml:space");addAttrs("object","declare classid code codebase codetype archive standby align border hspace vspace");addAttrs("embed","align name hspace vspace");addAttrs("param","valuetype type");addAttrs("a","charset name rev shape coords");addAttrs("br","clear");addAttrs("applet","codebase archive code object alt name width height align hspace vspace");addAttrs("img","name longdesc align border hspace vspace");addAttrs("iframe","longdesc frameborder marginwidth marginheight scrolling align");addAttrs("font basefont","size color face");addAttrs("input","usemap align");addAttrs("select");addAttrs("textarea");addAttrs("h1 h2 h3 h4 h5 h6 div p legend caption","align");addAttrs("ul","type compact");addAttrs("li","type");addAttrs("ol dl menu dir","compact");addAttrs("pre","width xml:space");addAttrs("hr","align noshade size width");addAttrs("isindex","prompt");addAttrs("table","summary width frame rules cellspacing cellpadding align bgcolor");addAttrs("col","width align char charoff valign");addAttrs("colgroup","width align char charoff valign");addAttrs("thead","align char charoff valign");addAttrs("tr","align char charoff valign bgcolor");addAttrs("th","axis align char charoff valign nowrap bgcolor width height");addAttrs("form","accept");addAttrs("td","abbr axis scope align char charoff valign nowrap bgcolor width height");addAttrs("tfoot","align char charoff valign");addAttrs("tbody","align char charoff valign");addAttrs("area","nohref");addAttrs("body","background bgcolor text link vlink alink")}if("html4"!==e){addAttrs("input button select textarea","autofocus");addAttrs("input textarea","placeholder");addAttrs("a","download");addAttrs("link script img","crossorigin");addAttrs("img","loading");addAttrs("iframe","sandbox seamless allowfullscreen loading")}Vt(split$1("a form meter progress dfn"),(function(e){t[e]&&delete t[e].children[e]}));delete t.caption.children.table;delete t.script;zt[e]=t;return t};var compileElementMap=function(e,t){var n;if(e){n={};"string"===typeof e&&(e={"*":e});Vt(e,(function(e,a){n[a]=n[a.toUpperCase()]="map"===t?Ht(e,/[, ]/):$t(e,/[, ]/)}))}return n};var Schema=function(e){var t={};var n={};var a=[];var o={},i={};var createLookupTable=function(t,n,a){var o=e[t];if(o)o=Ht(o,/[, ]/,Ht(o.toUpperCase(),/[, ]/));else{o=zt[t];if(!o){o=Ht(n," ",Ht(n.toUpperCase()," "));o=qt(o,a);zt[t]=o}}return o};e=e||{};var u=compileSchema(e.schema);false===e.verify_html&&(e.valid_elements="*[*]");var c=compileElementMap(e.valid_styles);var f=compileElementMap(e.invalid_styles,"map");var s=compileElementMap(e.valid_classes,"map");var l=createLookupTable("whitespace_elements","pre script noscript style textarea video audio iframe object code");var v=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr");var d=createLookupTable("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track");var m=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls");var g="td th iframe video audio object script code";var p=createLookupTable("non_empty_elements",g+" pre",d);var h=createLookupTable("move_caret_before_on_enter_elements",g+" table",d);var b=createLookupTable("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure");var y=createLookupTable("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",b);var C=createLookupTable("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp");Vt((e.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),(function(e){i[e]=new RegExp("</"+e+"[^>]*>","gi")}));var patternToRegExp=function(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")};var addValidElements=function(e){var n,o,i,u,c,f,s,l,v,d,m,g,p,h,b,y,C,w;var x=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,S=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,E=/[*?+]/;if(e){var k=split$1(e,",");if(t["@"]){y=t["@"].attributes;C=t["@"].attributesOrder}for(n=0,o=k.length;n<o;n++){c=x.exec(k[n]);if(c){h=c[1];v=c[2];b=c[3];l=c[5];g={};p=[];f={attributes:g,attributesOrder:p};"#"===h&&(f.paddEmpty=true);"-"===h&&(f.removeEmpty=true);"!"===c[4]&&(f.removeEmptyAttrs=true);if(y){each$j(y,(function(e,t){g[t]=e}));p.push.apply(p,C)}if(l){l=split$1(l,"|");for(i=0,u=l.length;i<u;i++){c=S.exec(l[i]);if(c){s={};m=c[1];d=c[2].replace(/[\\:]:/g,":");h=c[3];w=c[4];if("!"===m){f.attributesRequired=f.attributesRequired||[];f.attributesRequired.push(d);s.required=true}if("-"===m){delete g[d];p.splice(Wt(p,d),1);continue}if(h){if("="===h){f.attributesDefault=f.attributesDefault||[];f.attributesDefault.push({name:d,value:w});s.defaultValue=w}if(":"===h){f.attributesForced=f.attributesForced||[];f.attributesForced.push({name:d,value:w});s.forcedValue=w}"<"===h&&(s.validValues=Ht(w,"?"))}if(E.test(d)){f.attributePatterns=f.attributePatterns||[];s.pattern=patternToRegExp(d);f.attributePatterns.push(s)}else{g[d]||p.push(d);g[d]=s}}}}if(!y&&"@"===v){y=g;C=p}if(b){f.outputName=v;t[b]=f}if(E.test(v)){f.pattern=patternToRegExp(v);a.push(f)}else t[v]=f}}}};var setValidElements=function(e){t={};a=[];addValidElements(e);Vt(u,(function(e,t){n[t]=e.children}))};var addCustomElements=function(e){var a=/^(~)?(.+)$/;if(e){zt.text_block_elements=zt.block_elements=null;Vt(split$1(e,","),(function(e){var i=a.exec(e),u="~"===i[1],c=u?"span":"div",f=i[2];n[f]=n[c];o[f]=c;if(!u){y[f.toUpperCase()]={};y[f]={}}if(!t[f]){var s=t[c];s=qt({},s);delete s.removeEmptyAttrs;delete s.removeEmpty;t[f]=s}Vt(n,(function(e,t){if(e[c]){n[t]=e=qt({},n[t]);e[f]=e[c]}}))}))}};var addValidChildren=function(t){var a=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;zt[e.schema]=null;t&&Vt(split$1(t,","),(function(e){var t=a.exec(e);var o,i;if(t){i=t[1];o=i?n[t[2]]:n[t[2]]={"#comment":{}};o=n[t[2]];Vt(split$1(t[3],"|"),(function(e){"-"===i?delete o[e]:o[e]={}}))}}))};var getElementRule=function(e){var n,o=t[e];if(o)return o;n=a.length;while(n--){o=a[n];if(o.pattern.test(e))return o}};if(e.valid_elements)setValidElements(e.valid_elements);else{Vt(u,(function(e,a){t[a]={attributes:e.attributes,attributesOrder:e.attributesOrder};n[a]=e.children}));"html5"!==e.schema&&Vt(split$1("strong/b em/i"),(function(e){var n=split$1(e,"/");t[n[1]].outputName=n[0]}));Vt(split$1("ol ul sub sup blockquote span font a table tbody strong em b i"),(function(e){t[e]&&(t[e].removeEmpty=true)}));Vt(split$1("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),(function(e){t[e].paddEmpty=true}));Vt(split$1("span"),(function(e){t[e].removeEmptyAttrs=true}))}addCustomElements(e.custom_elements);addValidChildren(e.valid_children);addValidElements(e.extended_valid_elements);addValidChildren("+ol[ul|ol],+ul[ul|ol]");Vt({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(function(e,n){t[n]&&(t[n].parentsRequired=split$1(e))}));e.invalid_elements&&Vt($t(e.invalid_elements),(function(e){t[e]&&delete t[e]}));getElementRule("span")||addValidElements("span[!data-mce-type|*]");var w=constant(c);var x=constant(f);var S=constant(s);var E=constant(m);var k=constant(y);var N=constant(b);var _=constant(C);var A=constant(d);var R=constant(v);var D=constant(p);var T=constant(h);var O=constant(l);var B=constant(i);var isValidChild=function(e,t){var a=n[e.toLowerCase()];return!!(a&&a[t.toLowerCase()])};var isValid=function(e,t){var n,a;var o=getElementRule(e);if(o){if(!t)return true;if(o.attributes[t])return true;n=o.attributePatterns;if(n){a=n.length;while(a--)if(n[a].pattern.test(e))return true}}return false};var P=constant(o);return{children:n,elements:t,getValidStyles:w,getValidClasses:S,getBlockElements:k,getInvalidStyles:x,getShortEndedElements:A,getTextBlockElements:N,getTextInlineElements:_,getBoolAttrs:E,getElementRule:getElementRule,getSelfClosingElements:R,getNonEmptyElements:D,getMoveCaretBeforeOnEnterElements:T,getWhiteSpaceElements:O,getSpecialElements:B,isValidChild:isValidChild,isValid:isValid,getCustomElements:P,addValidElements:addValidElements,setValidElements:setValidElements,addCustomElements:addCustomElements,addValidChildren:addValidChildren}};var toHex=function(e,t,n,a){var hex=function(e){e=parseInt(e,10).toString(16);return e.length>1?e:"0"+e};return"#"+hex(t)+hex(n)+hex(a)};var Styles=function(e,n){var a=this||t;var o=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi;var i=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi;var u=/\s*([^:]+):\s*([^;]+);?/g;var c=/\s+$/;var f;var s={};var l;var v;var d=lt;e=e||{};if(n){l=n.getValidStyles();v=n.getInvalidStyles()}var m=("\\\" \\' \\; \\: ; : "+d).split(" ");for(f=0;f<m.length;f++){s[m[f]]=d+f;s[d+f]=m[f]}return{toHex:function(e){return e.replace(o,toHex)},parse:function(t){var n={};var l,v,m,g;var p=e.url_converter;var h=e.url_converter_scope||a;var compress=function(e,t,a){var o=n[e+"-top"+t];if(o){var i=n[e+"-right"+t];if(i){var u=n[e+"-bottom"+t];if(u){var c=n[e+"-left"+t];if(c){var s=[o,i,u,c];f=s.length-1;while(f--)if(s[f]!==s[f+1])break;if(!(f>-1&&a)){n[e+t]=-1===f?s[0]:s.join(" ");delete n[e+"-top"+t];delete n[e+"-right"+t];delete n[e+"-bottom"+t];delete n[e+"-left"+t]}}}}}};var canCompress=function(e){var t,a=n[e];if(a){a=a.split(" ");t=a.length;while(t--)if(a[t]!==a[0])return false;n[e]=a[0];return true}};var compress2=function(e,t,a,o){if(canCompress(t)&&canCompress(a)&&canCompress(o)){n[e]=n[t]+" "+n[a]+" "+n[o];delete n[t];delete n[a];delete n[o]}};var encode=function(e){g=true;return s[e]};var decode=function(e,t){g&&(e=e.replace(/\uFEFF[0-9]/g,(function(e){return s[e]})));t||(e=e.replace(/\\([\'\";:])/g,"$1"));return e};var decodeSingleHexSequence=function(e){return String.fromCharCode(parseInt(e.slice(1),16))};var decodeHexSequences=function(e){return e.replace(/\\[0-9a-f]+/gi,decodeSingleHexSequence)};var processUrl=function(t,n,a,o,i,u){i=i||u;if(i){i=decode(i);return"'"+i.replace(/\'/g,"\\'")+"'"}n=decode(n||a||o);if(!e.allow_script_urls){var c=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(c))return"";if(!e.allow_svg_data_urls&&/^data:image\/svg/i.test(c))return""}p&&(n=p.call(h,n,"style"));return"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){t=t.replace(/[\u0000-\u001F]/g,"");t=t.replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,(function(e){return e.replace(/[;:]/g,encode)}));while(l=u.exec(t)){u.lastIndex=l.index+l[0].length;v=l[1].replace(c,"").toLowerCase();m=l[2].replace(c,"");if(v&&m){v=decodeHexSequences(v);m=decodeHexSequences(m);if(-1!==v.indexOf(d)||-1!==v.indexOf('"'))continue;if(!e.allow_script_urls&&("behavior"===v||/expression\s*\(|\/\*|\*\//.test(m)))continue;"font-weight"===v&&"700"===m?m="bold":"color"!==v&&"background-color"!==v||(m=m.toLowerCase());m=m.replace(o,toHex);m=m.replace(i,processUrl);n[v]=g?decode(m,true):m}}compress("border","",true);compress("border","-width");compress("border","-color");compress("border","-style");compress("padding","");compress("margin","");compress2("border","border-width","border-style","border-color");"medium none"===n.border&&delete n.border;"none"===n["border-image"]&&delete n["border-image"]}return n},serialize:function(e,t){var n="";var serializeStyles=function(t){var a;var o=l[t];if(o)for(var i=0,u=o.length;i<u;i++){t=o[i];a=e[t];a&&(n+=(n.length>0?" ":"")+t+": "+a+";")}};var isValid=function(e,t){var n=v["*"];if(n&&n[e])return false;n=v[t];return!(n&&n[e])};if(t&&l){serializeStyles("*");serializeStyles(t)}else each$j(e,(function(e,a){!e||v&&!isValid(a,t)||(n+=(n.length>0?" ":"")+a+": "+e+";")}));return n}}};var Kt={keyLocation:true,layerX:true,layerY:true,returnValue:true,webkitMovementX:true,webkitMovementY:true,keyIdentifier:true,mozPressure:true};var isNativeEvent=function(e){return e instanceof Event||d(e.initEvent)};var hasIsDefaultPrevented=function(e){return e.isDefaultPrevented===p||e.isDefaultPrevented===g};var needsNormalizing=function(e){return isNullable(e.preventDefault)||isNativeEvent(e)};var clone$2=function(e,t){var n=null!==t&&void 0!==t?t:{};for(var a in e)has$2(Kt,a)||(n[a]=e[a]);isNonNullable(n.composedPath)&&(n.composedPath=function(){return e.composedPath()});return n};var normalize$3=function(e,t,n,a){var o;var i=clone$2(t,a);i.type=e;isNullable(i.target)&&(i.target=null!==(o=i.srcElement)&&void 0!==o?o:n);if(needsNormalizing(t)){i.preventDefault=function(){i.defaultPrevented=true;i.isDefaultPrevented=p;d(t.preventDefault)?t.preventDefault():isNativeEvent(t)&&(t.returnValue=false)};i.stopPropagation=function(){i.cancelBubble=true;i.isPropagationStopped=p;d(t.stopPropagation)?t.stopPropagation():isNativeEvent(t)&&(t.cancelBubble=true)};i.stopImmediatePropagation=function(){i.isImmediatePropagationStopped=p;i.stopPropagation()};if(!hasIsDefaultPrevented(i)){i.isDefaultPrevented=true===i.defaultPrevented?p:g;i.isPropagationStopped=true===i.cancelBubble?p:g;i.isImmediatePropagationStopped=g}}return i};var Xt="mce-data-";var Yt=/^(?:mouse|contextmenu)|click/;var addEvent=function(e,t,n,a){e.addEventListener?e.addEventListener(t,n,a||false):e.attachEvent&&e.attachEvent("on"+t,n)};var removeEvent=function(e,t,n,a){e.removeEventListener?e.removeEventListener(t,n,a||false):e.detachEvent&&e.detachEvent("on"+t,n)};var isMouseEvent=function(e){return isNonNullable(e)&&Yt.test(e.type)};var fix=function(e,t){var n=normalize$3(e.type,e,document,t);if(isMouseEvent(e)&&v(e.pageX)&&!v(e.clientX)){var a=n.target.ownerDocument||document;var o=a.documentElement;var i=a.body;var u=n;u.pageX=e.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0);u.pageY=e.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)}v(n.metaKey)&&(n.metaKey=false);return n};var bindOnReady=function(e,t,n){var a=e.document,o={type:"ready"};if(n.domLoaded)t(o);else{var isDocReady=function(){return"complete"===a.readyState||"interactive"===a.readyState&&a.body};var readyHandler=function(){removeEvent(e,"DOMContentLoaded",readyHandler);removeEvent(e,"load",readyHandler);if(!n.domLoaded){n.domLoaded=true;t(o)}e=null};isDocReady()?readyHandler():addEvent(e,"DOMContentLoaded",readyHandler);n.domLoaded||addEvent(e,"load",readyHandler)}};var Gt=function(){function EventUtils(){(this||t).domLoaded=false;(this||t).events={};(this||t).count=1;(this||t).expando=Xt+(+new Date).toString(32);(this||t).hasMouseEnterLeave="onmouseenter"in document.documentElement;(this||t).hasFocusIn="onfocusin"in document.documentElement;(this||t).count=1}EventUtils.prototype.bind=function(e,n,a,o){var i=this||t;var u,c,f,s,l,v,d;var m=window;var defaultNativeHandler=function(e){i.executeHandlers(fix(e||m.event),u)};if(e&&3!==e.nodeType&&8!==e.nodeType){if(e[i.expando])u=e[i.expando];else{u=i.count++;e[i.expando]=u;i.events[u]={}}o=o||e;var g=n.split(" ");f=g.length;while(f--){s=g[f];v=defaultNativeHandler;l=d=false;"DOMContentLoaded"===s&&(s="ready");if(i.domLoaded&&"ready"===s&&"complete"===e.readyState)a.call(o,fix({type:s}));else{if(!i.hasMouseEnterLeave){l=i.mouseEnterLeave[s];l&&(v=function(e){var t=e.currentTarget;var n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else while(n&&n!==t)n=n.parentNode;if(!n){e=fix(e||m.event);e.type="mouseout"===e.type?"mouseleave":"mouseenter";e.target=t;i.executeHandlers(e,u)}})}if(!i.hasFocusIn&&("focusin"===s||"focusout"===s)){d=true;l="focusin"===s?"focus":"blur";v=function(e){e=fix(e||m.event);e.type="focus"===e.type?"focusin":"focusout";i.executeHandlers(e,u)}}c=i.events[u][s];if(c)"ready"===s&&i.domLoaded?a(fix({type:s})):c.push({func:a,scope:o});else{i.events[u][s]=c=[{func:a,scope:o}];c.fakeName=l;c.capture=d;c.nativeHandler=v;"ready"===s?bindOnReady(e,v,i):addEvent(e,l||s,v,d)}}}e=c=null;return a}};EventUtils.prototype.unbind=function(e,n,a){var o,i,u,c,f;if(!e||3===e.nodeType||8===e.nodeType)return this||t;var s=e[(this||t).expando];if(s){f=(this||t).events[s];if(n){var l=n.split(" ");i=l.length;while(i--){c=l[i];o=f[c];if(o){if(a){u=o.length;while(u--)if(o[u].func===a){var v=o.nativeHandler;var d=o.fakeName,m=o.capture;o=o.slice(0,u).concat(o.slice(u+1));o.nativeHandler=v;o.fakeName=d;o.capture=m;f[c]=o}}if(!a||0===o.length){delete f[c];removeEvent(e,o.fakeName||c,o.nativeHandler,o.capture)}}}}else{each$j(f,(function(t,n){removeEvent(e,t.fakeName||n,t.nativeHandler,t.capture)}));f={}}for(c in f)if(has$2(f,c))return this||t;delete(this||t).events[s];try{delete e[(this||t).expando]}catch(n){e[(this||t).expando]=null}}return this||t};EventUtils.prototype.fire=function(e,n,a){var o;if(!e||3===e.nodeType||8===e.nodeType)return this||t;var i=fix({type:n,target:e},a);do{o=e[(this||t).expando];o&&this.executeHandlers(i,o);e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!i.isPropagationStopped());return this||t};EventUtils.prototype.clean=function(e){var n,a;if(!e||3===e.nodeType||8===e.nodeType)return this||t;e[(this||t).expando]&&this.unbind(e);e.getElementsByTagName||(e=e.document);if(e&&e.getElementsByTagName){this.unbind(e);a=e.getElementsByTagName("*");n=a.length;while(n--){e=a[n];e[(this||t).expando]&&this.unbind(e)}}return this||t};EventUtils.prototype.destroy=function(){(this||t).events={}};EventUtils.prototype.cancel=function(e){if(e){e.preventDefault();e.stopImmediatePropagation()}return false};EventUtils.prototype.executeHandlers=function(e,n){var a=(this||t).events[n];var o=a&&a[e.type];if(o)for(var i=0,u=o.length;i<u;i++){var c=o[i];c&&false===c.func.call(c.scope,e)&&e.preventDefault();if(e.isImmediatePropagationStopped())return}};EventUtils.Event=new EventUtils;return EventUtils}();var Jt,Qt,Zt,er,tr,rr,nr,ar,ir,ur,cr,fr,sr,lr,vr,dr,mr,gr,pr="sizzle"+-new Date,hr=window.document,br=0,yr=0,Cr=createCache(),wr=createCache(),xr=createCache(),sortOrder=function(e,t){e===t&&(ur=true);return 0},Sr="undefined",Er=1<<31,kr={}.hasOwnProperty,Nr=[],_r=Nr.pop,Ar=Nr.push,Rr=Nr.push,Dr=Nr.slice,Tr=Nr.indexOf||function(e){var n=0,a=(this||t).length;for(;n<a;n++)if((this||t)[n]===e)return n;return-1},Or="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Br="[\\x20\\t\\r\\n\\f]",Pr="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Lr="\\["+Br+"*("+Pr+")(?:"+Br+"*([*^$|!~]?=)"+Br+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Pr+"))|)"+Br+"*\\]",Ir=":("+Pr+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Lr+")*)|.*)\\)|)",Mr=new RegExp("^"+Br+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Br+"+$","g"),Fr=new RegExp("^"+Br+"*,"+Br+"*"),Ur=new RegExp("^"+Br+"*([>+~]|"+Br+")"+Br+"*"),zr=new RegExp("="+Br+"*([^\\]'\"]*?)"+Br+"*\\]","g"),jr=new RegExp(Ir),Hr=new RegExp("^"+Pr+"$"),Vr={ID:new RegExp("^#("+Pr+")"),CLASS:new RegExp("^\\.("+Pr+")"),TAG:new RegExp("^("+Pr+"|[*])"),ATTR:new RegExp("^"+Lr),PSEUDO:new RegExp("^"+Ir),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Br+"*(even|odd|(([+-]|)(\\d*)n|)"+Br+"*(?:([+-]|)"+Br+"*(\\d+)|))"+Br+"*\\)|)","i"),bool:new RegExp("^(?:"+Or+")$","i"),needsContext:new RegExp("^"+Br+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Br+"*((?:-\\d)?\\d*)"+Br+"*\\)|)(?=[^-]|$)","i")},qr=/^(?:input|select|textarea|button)$/i,$r=/^h\d$/i,Wr=/^[^{]+\{\s*\[native \w/,Kr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Xr=/[+~]/,Yr=/'|\\/g,Gr=new RegExp("\\\\([\\da-f]{1,6}"+Br+"?|("+Br+")|.)","ig"),funescape=function(e,t,n){var a="0x"+t-65536;return a!==a||n?t:a<0?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,1023&a|56320)};try{Rr.apply(Nr=Dr.call(hr.childNodes),hr.childNodes);Nr[hr.childNodes.length].nodeType}catch(e){Rr={apply:Nr.length?function(e,t){Ar.apply(e,Dr.call(t))}:function(e,t){var n=e.length,a=0;while(e[n++]=t[a++]);e.length=n-1}}}var Sizzle=function(e,t,n,a){var o,i,u,c,f,s,l,v,d,m;(t?t.ownerDocument||t:hr)!==fr&&cr(t);t=t||fr;n=n||[];if(!e||"string"!==typeof e)return n;if(1!==(c=t.nodeType)&&9!==c)return[];if(lr&&!a){if(o=Kr.exec(e))if(u=o[1]){if(9===c){i=t.getElementById(u);if(!i||!i.parentNode)return n;if(i.id===u){n.push(i);return n}}else if(t.ownerDocument&&(i=t.ownerDocument.getElementById(u))&&gr(t,i)&&i.id===u){n.push(i);return n}}else{if(o[2]){Rr.apply(n,t.getElementsByTagName(e));return n}if((u=o[3])&&Jt.getElementsByClassName){Rr.apply(n,t.getElementsByClassName(u));return n}}if(Jt.qsa&&(!vr||!vr.test(e))){v=l=pr;d=t;m=9===c&&e;if(1===c&&"object"!==t.nodeName.toLowerCase()){s=tr(e);(l=t.getAttribute("id"))?v=l.replace(Yr,"\\$&"):t.setAttribute("id",v);v="[id='"+v+"'] ";f=s.length;while(f--)s[f]=v+toSelector(s[f]);d=Xr.test(e)&&testContext(t.parentNode)||t;m=s.join(",")}if(m)try{Rr.apply(n,d.querySelectorAll(m));return n}catch(e){}finally{l||t.removeAttribute("id")}}}return nr(e.replace(Mr,"$1"),t,n,a)};function createCache(){var e=[];function cache(t,n){e.push(t+" ")>Qt.cacheLength&&delete cache[e.shift()];return cache[t+" "]=n}return cache}function markFunction(e){e[pr]=true;return e}function siblingCheck(e,t){var n=t&&e,a=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||Er)-(~e.sourceIndex||Er);if(a)return a;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function createInputPseudo(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function createButtonPseudo(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function createPositionalPseudo(e){return markFunction((function(t){t=+t;return markFunction((function(n,a){var o,i=e([],n.length,t),u=i.length;while(u--)n[o=i[u]]&&(n[o]=!(a[o]=n[o]))}))}))}function testContext(e){return e&&typeof e.getElementsByTagName!==Sr&&e}Jt=Sizzle.support={};er=Sizzle.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName};cr=Sizzle.setDocument=function(e){var t,n=e?e.ownerDocument||e:hr,a=n.defaultView;function getTop(e){try{return e.top}catch(e){}return null}if(n===fr||9!==n.nodeType||!n.documentElement)return fr;fr=n;sr=n.documentElement;lr=!er(n);a&&a!==getTop(a)&&(a.addEventListener?a.addEventListener("unload",(function(){cr()}),false):a.attachEvent&&a.attachEvent("onunload",(function(){cr()})));Jt.attributes=true;Jt.getElementsByTagName=true;Jt.getElementsByClassName=Wr.test(n.getElementsByClassName);Jt.getById=true;Qt.find.ID=function(e,t){if(typeof t.getElementById!==Sr&&lr){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}};Qt.filter.ID=function(e){var t=e.replace(Gr,funescape);return function(e){return e.getAttribute("id")===t}};Qt.find.TAG=Jt.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==Sr)return t.getElementsByTagName(e)}:function(e,t){var n,a=[],o=0,i=t.getElementsByTagName(e);if("*"===e){while(n=i[o++])1===n.nodeType&&a.push(n);return a}return i};Qt.find.CLASS=Jt.getElementsByClassName&&function(e,t){if(lr)return t.getElementsByClassName(e)};dr=[];vr=[];Jt.disconnectedMatch=true;vr=vr.length&&new RegExp(vr.join("|"));dr=dr.length&&new RegExp(dr.join("|"));t=Wr.test(sr.compareDocumentPosition);gr=t||Wr.test(sr.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,a=t&&t.parentNode;return e===a||!!(a&&1===a.nodeType&&(n.contains?n.contains(a):e.compareDocumentPosition&&16&e.compareDocumentPosition(a)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return true;return false};sortOrder=t?function(e,t){if(e===t){ur=true;return 0}var a=!e.compareDocumentPosition-!t.compareDocumentPosition;if(a)return a;a=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1;return 1&a||!Jt.sortDetached&&t.compareDocumentPosition(e)===a?e===n||e.ownerDocument===hr&&gr(hr,e)?-1:t===n||t.ownerDocument===hr&&gr(hr,t)?1:ir?Tr.call(ir,e)-Tr.call(ir,t):0:4&a?-1:1}:function(e,t){if(e===t){ur=true;return 0}var a,o=0,i=e.parentNode,u=t.parentNode,c=[e],f=[t];if(!i||!u)return e===n?-1:t===n?1:i?-1:u?1:ir?Tr.call(ir,e)-Tr.call(ir,t):0;if(i===u)return siblingCheck(e,t);a=e;while(a=a.parentNode)c.unshift(a);a=t;while(a=a.parentNode)f.unshift(a);while(c[o]===f[o])o++;return o?siblingCheck(c[o],f[o]):c[o]===hr?-1:f[o]===hr?1:0};return n};Sizzle.matches=function(e,t){return Sizzle(e,null,null,t)};Sizzle.matchesSelector=function(e,t){(e.ownerDocument||e)!==fr&&cr(e);t=t.replace(zr,"='$1']");if(Jt.matchesSelector&&lr&&(!dr||!dr.test(t))&&(!vr||!vr.test(t)))try{var n=mr.call(e,t);if(n||Jt.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return Sizzle(t,fr,null,[e]).length>0};Sizzle.contains=function(e,t){(e.ownerDocument||e)!==fr&&cr(e);return gr(e,t)};Sizzle.attr=function(e,t){(e.ownerDocument||e)!==fr&&cr(e);var n=Qt.attrHandle[t.toLowerCase()],a=n&&kr.call(Qt.attrHandle,t.toLowerCase())?n(e,t,!lr):void 0;return void 0!==a?a:Jt.attributes||!lr?e.getAttribute(t):(a=e.getAttributeNode(t))&&a.specified?a.value:null};Sizzle.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};Sizzle.uniqueSort=function(e){var t,n=[],a=0,o=0;ur=!Jt.detectDuplicates;ir=!Jt.sortStable&&e.slice(0);e.sort(sortOrder);if(ur){while(t=e[o++])t===e[o]&&(a=n.push(o));while(a--)e.splice(n[a],1)}ir=null;return e};Zt=Sizzle.getText=function(e){var t,n="",a=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"===typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=Zt(e)}else if(3===o||4===o)return e.nodeValue}else while(t=e[a++])n+=Zt(t);return n};Qt=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:Vr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(Gr,funescape);e[3]=(e[3]||e[4]||e[5]||"").replace(Gr,funescape);"~="===e[2]&&(e[3]=" "+e[3]+" ");return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if("nth"===e[1].slice(0,3)){e[3]||Sizzle.error(e[0]);e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3]));e[5]=+(e[7]+e[8]||"odd"===e[3])}else e[3]&&Sizzle.error(e[0]);return e},PSEUDO:function(e){var t,n=!e[6]&&e[2];if(Vr.CHILD.test(e[0]))return null;if(e[3])e[2]=e[4]||e[5]||"";else if(n&&jr.test(n)&&(t=tr(n,true))&&(t=n.indexOf(")",n.length-t)-n.length)){e[0]=e[0].slice(0,t);e[2]=n.slice(0,t)}return e.slice(0,3)}},filter:{TAG:function(e){var t=e.replace(Gr,funescape).toLowerCase();return"*"===e?function(){return true}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=Cr[e+" "];return t||(t=new RegExp("(^|"+Br+")"+e+"("+Br+"|$)"))&&Cr(e,(function(e){return t.test("string"===typeof e.className&&e.className||typeof e.getAttribute!==Sr&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(a){var o=Sizzle.attr(a,e);if(null==o)return"!="===t;if(!t)return true;o+="";return"="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.slice(-n.length)===n:"~="===t?(" "+o+" ").indexOf(n)>-1:"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-")}},CHILD:function(e,t,n,a,o){var i="nth"!==e.slice(0,3),u="last"!==e.slice(-4),c="of-type"===t;return 1===a&&0===o?function(e){return!!e.parentNode}:function(t,n,f){var s,l,v,d,m,g,p=i!==u?"nextSibling":"previousSibling",h=t.parentNode,b=c&&t.nodeName.toLowerCase(),y=!f&&!c;if(h){if(i){while(p){v=t;while(v=v[p])if(c?v.nodeName.toLowerCase()===b:1===v.nodeType)return false;g=p="only"===e&&!g&&"nextSibling"}return true}g=[u?h.firstChild:h.lastChild];if(u&&y){l=h[pr]||(h[pr]={});s=l[e]||[];m=s[0]===br&&s[1];d=s[0]===br&&s[2];v=m&&h.childNodes[m];while(v=++m&&v&&v[p]||(d=m=0)||g.pop())if(1===v.nodeType&&++d&&v===t){l[e]=[br,m,d];break}}else if(y&&(s=(t[pr]||(t[pr]={}))[e])&&s[0]===br)d=s[1];else while(v=++m&&v&&v[p]||(d=m=0)||g.pop())if((c?v.nodeName.toLowerCase()===b:1===v.nodeType)&&++d){y&&((v[pr]||(v[pr]={}))[e]=[br,d]);if(v===t)break}d-=o;return d===a||d%a===0&&d/a>=0}}},PSEUDO:function(e,t){var n,a=Qt.pseudos[e]||Qt.setFilters[e.toLowerCase()]||Sizzle.error("unsupported pseudo: "+e);if(a[pr])return a(t);if(a.length>1){n=[e,e,"",t];return Qt.setFilters.hasOwnProperty(e.toLowerCase())?markFunction((function(e,n){var o,i=a(e,t),u=i.length;while(u--){o=Tr.call(e,i[u]);e[o]=!(n[o]=i[u])}})):function(e){return a(e,0,n)}}return a}},pseudos:{not:markFunction((function(e){var t=[],n=[],a=rr(e.replace(Mr,"$1"));return a[pr]?markFunction((function(e,t,n,o){var i,u=a(e,null,o,[]),c=e.length;while(c--)(i=u[c])&&(e[c]=!(t[c]=i))})):function(e,o,i){t[0]=e;a(t,null,i,n);t[0]=null;return!n.pop()}})),has:markFunction((function(e){return function(t){return Sizzle(e,t).length>0}})),contains:markFunction((function(e){e=e.replace(Gr,funescape);return function(t){return(t.textContent||t.innerText||Zt(t)).indexOf(e)>-1}})),lang:markFunction((function(e){Hr.test(e||"")||Sizzle.error("unsupported lang: "+e);e=e.replace(Gr,funescape).toLowerCase();return function(t){var n;do{if(n=lr?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang")){n=n.toLowerCase();return n===e||0===n.indexOf(e+"-")}}while((t=t.parentNode)&&1===t.nodeType);return false}})),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===sr},focus:function(e){return e===fr.activeElement&&(!fr.hasFocus||fr.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return false===e.disabled},disabled:function(e){return true===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){e.parentNode&&e.parentNode.selectedIndex;return true===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return false;return true},parent:function(e){return!Qt.pseudos.empty(e)},header:function(e){return $r.test(e.nodeName)},input:function(e){return qr.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:createPositionalPseudo((function(){return[0]})),last:createPositionalPseudo((function(e,t){return[t-1]})),eq:createPositionalPseudo((function(e,t,n){return[n<0?n+t:n]})),even:createPositionalPseudo((function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e})),odd:createPositionalPseudo((function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e})),lt:createPositionalPseudo((function(e,t,n){var a=n<0?n+t:n;for(;--a>=0;)e.push(a);return e})),gt:createPositionalPseudo((function(e,t,n){var a=n<0?n+t:n;for(;++a<t;)e.push(a);return e}))}};Qt.pseudos.nth=Qt.pseudos.eq;each$k(["radio","checkbox","file","password","image"],(function(e){Qt.pseudos[e]=createInputPseudo(e)}));each$k(["submit","reset"],(function(e){Qt.pseudos[e]=createButtonPseudo(e)}));function setFilters(){}setFilters.prototype=Qt.filters=Qt.pseudos;Qt.setFilters=new setFilters;tr=Sizzle.tokenize=function(e,t){var n,a,o,i,u,c,f,s=wr[e+" "];if(s)return t?0:s.slice(0);u=e;c=[];f=Qt.preFilter;while(u){if(!n||(a=Fr.exec(u))){a&&(u=u.slice(a[0].length)||u);c.push(o=[])}n=false;if(a=Ur.exec(u)){n=a.shift();o.push({value:n,type:a[0].replace(Mr," ")});u=u.slice(n.length)}for(i in Qt.filter)if(Qt.filter.hasOwnProperty(i)&&(a=Vr[i].exec(u))&&(!f[i]||(a=f[i](a)))){n=a.shift();o.push({value:n,type:i,matches:a});u=u.slice(n.length)}if(!n)break}return t?u.length:u?Sizzle.error(e):wr(e,c).slice(0)};function toSelector(e){var t=0,n=e.length,a="";for(;t<n;t++)a+=e[t].value;return a}function addCombinator(e,t,n){var a=t.dir,o=n&&"parentNode"===a,i=yr++;return t.first?function(t,n,i){while(t=t[a])if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,u){var c,f,s=[br,i];if(u){while(t=t[a])if((1===t.nodeType||o)&&e(t,n,u))return true}else while(t=t[a])if(1===t.nodeType||o){f=t[pr]||(t[pr]={});if((c=f[a])&&c[0]===br&&c[1]===i)return s[2]=c[2];f[a]=s;if(s[2]=e(t,n,u))return true}}}function elementMatcher(e){return e.length>1?function(t,n,a){var o=e.length;while(o--)if(!e[o](t,n,a))return false;return true}:e[0]}function multipleContexts(e,t,n){var a=0,o=t.length;for(;a<o;a++)Sizzle(e,t[a],n);return n}function condense(e,t,n,a,o){var i,u=[],c=0,f=e.length,s=null!=t;for(;c<f;c++)if((i=e[c])&&(!n||n(i,a,o))){u.push(i);s&&t.push(c)}return u}function setMatcher(e,t,n,a,o,i){a&&!a[pr]&&(a=setMatcher(a));o&&!o[pr]&&(o=setMatcher(o,i));return markFunction((function(i,u,c,f){var s,l,v,d=[],m=[],g=u.length,p=i||multipleContexts(t||"*",c.nodeType?[c]:c,[]),h=!e||!i&&t?p:condense(p,d,e,c,f),b=n?o||(i?e:g||a)?[]:u:h;n&&n(h,b,c,f);if(a){s=condense(b,m);a(s,[],c,f);l=s.length;while(l--)(v=s[l])&&(b[m[l]]=!(h[m[l]]=v))}if(i){if(o||e){if(o){s=[];l=b.length;while(l--)(v=b[l])&&s.push(h[l]=v);o(null,b=[],s,f)}l=b.length;while(l--)(v=b[l])&&(s=o?Tr.call(i,v):d[l])>-1&&(i[s]=!(u[s]=v))}}else{b=condense(b===u?b.splice(g,b.length):b);o?o(null,u,b,f):Rr.apply(u,b)}}))}function matcherFromTokens(e){var t,n,a,o=e.length,i=Qt.relative[e[0].type],u=i||Qt.relative[" "],c=i?1:0,f=addCombinator((function(e){return e===t}),u,true),s=addCombinator((function(e){return Tr.call(t,e)>-1}),u,true),l=[function(e,n,a){var o=!i&&(a||n!==ar)||((t=n).nodeType?f(e,n,a):s(e,n,a));t=null;return o}];for(;c<o;c++)if(n=Qt.relative[e[c].type])l=[addCombinator(elementMatcher(l),n)];else{n=Qt.filter[e[c].type].apply(null,e[c].matches);if(n[pr]){a=++c;for(;a<o;a++)if(Qt.relative[e[a].type])break;return setMatcher(c>1&&elementMatcher(l),c>1&&toSelector(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(Mr,"$1"),n,c<a&&matcherFromTokens(e.slice(c,a)),a<o&&matcherFromTokens(e=e.slice(a)),a<o&&toSelector(e))}l.push(n)}return elementMatcher(l)}function matcherFromGroupMatchers(e,t){var n=t.length>0,a=e.length>0,superMatcher=function(o,i,u,c,f){var s,l,v,d=0,m="0",g=o&&[],p=[],h=ar,b=o||a&&Qt.find.TAG("*",f),y=br+=null==h?1:Math.random()||.1,C=b.length;f&&(ar=i!==fr&&i);for(;m!==C&&null!=(s=b[m]);m++){if(a&&s){l=0;while(v=e[l++])if(v(s,i,u)){c.push(s);break}f&&(br=y)}if(n){(s=!v&&s)&&d--;o&&g.push(s)}}d+=m;if(n&&m!==d){l=0;while(v=t[l++])v(g,p,i,u);if(o){if(d>0)while(m--)g[m]||p[m]||(p[m]=_r.call(c));p=condense(p)}Rr.apply(c,p);f&&!o&&p.length>0&&d+t.length>1&&Sizzle.uniqueSort(c)}if(f){br=y;ar=h}return g};return n?markFunction(superMatcher):superMatcher}rr=Sizzle.compile=function(e,t){var n,a=[],o=[],i=xr[e+" "];if(!i){t||(t=tr(e));n=t.length;while(n--){i=matcherFromTokens(t[n]);i[pr]?a.push(i):o.push(i)}i=xr(e,matcherFromGroupMatchers(o,a));i.selector=e}return i};nr=Sizzle.select=function(e,t,n,a){var o,i,u,c,f,s="function"===typeof e&&e,l=!a&&tr(e=s.selector||e);n=n||[];if(1===l.length){i=l[0]=l[0].slice(0);if(i.length>2&&"ID"===(u=i[0]).type&&Jt.getById&&9===t.nodeType&&lr&&Qt.relative[i[1].type]){t=(Qt.find.ID(u.matches[0].replace(Gr,funescape),t)||[])[0];if(!t)return n;s&&(t=t.parentNode);e=e.slice(i.shift().value.length)}o=Vr.needsContext.test(e)?0:i.length;while(o--){u=i[o];if(Qt.relative[c=u.type])break;if((f=Qt.find[c])&&(a=f(u.matches[0].replace(Gr,funescape),Xr.test(i[0].type)&&testContext(t.parentNode)||t))){i.splice(o,1);e=a.length&&toSelector(i);if(!e){Rr.apply(n,a);return n}break}}}(s||rr(e,l))(a,t,!lr,n,Xr.test(e)&&testContext(t.parentNode)||t);return n};Jt.sortStable=pr.split("").sort(sortOrder).join("")===pr;Jt.detectDuplicates=!!ur;cr();Jt.sortDetached=true;var Jr=document;var Qr=Array.prototype.push;var Zr=Array.prototype.slice;var en=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/;var tn=Gt.Event;var rn=fe.makeMap("children,contents,next,prev");var isDefined=function(e){return"undefined"!==typeof e};var isString=function(e){return"string"===typeof e};var isWindow=function(e){return e&&e===e.window};var createFragment$1=function(e,t){t=t||Jr;var n=t.createElement("div");var a=t.createDocumentFragment();n.innerHTML=e;var o;while(o=n.firstChild)a.appendChild(o);return a};var domManipulate=function(e,t,n,a){var o;if(isString(t))t=createFragment$1(t,getElementDocument(e[0]));else if(t.length&&!t.nodeType){t=vn.makeArray(t);if(a)for(o=t.length-1;o>=0;o--)domManipulate(e,t[o],n,a);else for(o=0;o<t.length;o++)domManipulate(e,t[o],n,a);return e}if(t.nodeType){o=e.length;while(o--)n.call(e[o],t)}return e};var hasClass=function(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")};var wrap$2=function(e,n,a){var o,i;n=vn(n)[0];e.each((function(){var e=this||t;if(a&&o===e.parentNode)i.appendChild(e);else{o=e.parentNode;i=n.cloneNode(false);e.parentNode.insertBefore(i,e);i.appendChild(e)}}));return e};var nn=fe.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," ");var an=fe.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," ");var un={for:"htmlFor",class:"className",readonly:"readOnly"};var cn={float:"cssFloat"};var fn={},sn={};var DomQueryConstructor=function(e,t){return new vn.fn.init(e,t)};var inArray$1=function(e,t){var n;if(t.indexOf)return t.indexOf(e);n=t.length;while(n--)if(t[n]===e)return n;return-1};var ln=/^\s*|\s*$/g;var trim$1=function(e){return null===e||void 0===e?"":(""+e).replace(ln,"")};var each$g=function(e,t){var n,a,o,i;if(e){n=e.length;if(void 0===n){for(a in e)if(e.hasOwnProperty(a)){i=e[a];if(false===t.call(i,a,i))break}}else for(o=0;o<n;o++){i=e[o];if(false===t.call(i,o,i))break}}return e};var grep$2=function(e,t){var n=[];each$g(e,(function(e,a){t(a,e)&&n.push(a)}));return n};var getElementDocument=function(e){return e?9===e.nodeType?e:e.ownerDocument:Jr};DomQueryConstructor.fn=DomQueryConstructor.prototype={constructor:DomQueryConstructor,selector:"",context:null,length:0,init:function(e,n){var a=this||t;var o,i;if(!e)return a;if(e.nodeType){a.context=a[0]=e;a.length=1;return a}if(n&&n.nodeType)a.context=n;else{if(n)return vn(e).attr(n);a.context=n=document}if(isString(e)){a.selector=e;o="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:en.exec(e);if(!o)return vn(n).find(e);if(o[1]){i=createFragment$1(e,getElementDocument(n)).firstChild;while(i){Qr.call(a,i);i=i.nextSibling}}else{i=getElementDocument(n).getElementById(o[2]);if(!i)return a;if(i.id!==o[2])return a.find(e);a.length=1;a[0]=i}}else this.add(e,false);return a},toArray:function(){return fe.toArray(this||t)},add:function(e,n){var a=this||t;var o,i;if(isString(e))return a.add(vn(e));if(false!==n){o=vn.unique(a.toArray().concat(vn.makeArray(e)));a.length=o.length;for(i=0;i<o.length;i++)a[i]=o[i]}else Qr.apply(a,vn.makeArray(e));return a},attr:function(e,n){var a=this||t;var o;if("object"===typeof e)each$g(e,(function(e,t){a.attr(e,t)}));else{if(!isDefined(n)){if(a[0]&&1===a[0].nodeType){o=fn[e];if(o&&o.get)return o.get(a[0],e);if(an[e])return a.prop(e)?e:void 0;n=a[0].getAttribute(e,2);null===n&&(n=void 0)}return n}this.each((function(){var a;if(1===(this||t).nodeType){a=fn[e];if(a&&a.set){a.set(this||t,n);return}null===n?this.removeAttribute(e,2):this.setAttribute(e,n,2)}}))}return a},removeAttr:function(e){return this.attr(e,null)},prop:function(e,n){var a=this||t;e=un[e]||e;if("object"===typeof e)each$g(e,(function(e,t){a.prop(e,t)}));else{if(!isDefined(n))return a[0]&&a[0].nodeType&&e in a[0]?a[0][e]:n;this.each((function(){1===(this||t).nodeType&&((this||t)[e]=n)}))}return a},css:function(e,n){var a=this||t;var o,i;var camel=function(e){return e.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()}))};var dashed=function(e){return e.replace(/[A-Z]/g,(function(e){return"-"+e}))};if("object"===typeof e)each$g(e,(function(e,t){a.css(e,t)}));else if(isDefined(n)){e=camel(e);"number"!==typeof n||nn[e]||(n=n.toString()+"px");a.each((function(){var a=(this||t).style;i=sn[e];if(i&&i.set)i.set(this||t,n);else{try{(this||t).style[cn[e]||e]=n}catch(e){}null!==n&&""!==n||(a.removeProperty?a.removeProperty(dashed(e)):a.removeAttribute(e))}}))}else{o=a[0];i=sn[e];if(i&&i.get)return i.get(o);if(!o.ownerDocument.defaultView)return o.currentStyle?o.currentStyle[camel(e)]:"";try{return o.ownerDocument.defaultView.getComputedStyle(o,null).getPropertyValue(dashed(e))}catch(e){return}}return a},remove:function(){var e=this||t;var n,a=(this||t).length;while(a--){n=e[a];tn.clean(n);n.parentNode&&n.parentNode.removeChild(n)}return this||t},empty:function(){var e=this||t;var n,a=(this||t).length;while(a--){n=e[a];while(n.firstChild)n.removeChild(n.firstChild)}return this||t},html:function(e){var n=this||t;var a;if(isDefined(e)){a=n.length;try{while(a--)n[a].innerHTML=e}catch(t){vn(n[a]).empty().append(e)}return n}return n[0]?n[0].innerHTML:""},text:function(e){var n=this||t;var a;if(isDefined(e)){a=n.length;while(a--)"innerText"in n[a]?n[a].innerText=e:n[0].textContent=e;return n}return n[0]?n[0].innerText||n[0].textContent:""},append:function(){return domManipulate(this||t,arguments,(function(e){(1===(this||t).nodeType||(this||t).host&&1===(this||t).host.nodeType)&&this.appendChild(e)}))},prepend:function(){return domManipulate(this||t,arguments,(function(e){(1===(this||t).nodeType||(this||t).host&&1===(this||t).host.nodeType)&&this.insertBefore(e,(this||t).firstChild)}),true)},before:function(){var e=this||t;return e[0]&&e[0].parentNode?domManipulate(e,arguments,(function(e){(this||t).parentNode.insertBefore(e,this||t)})):e},after:function(){var e=this||t;return e[0]&&e[0].parentNode?domManipulate(e,arguments,(function(e){(this||t).parentNode.insertBefore(e,(this||t).nextSibling)}),true):e},appendTo:function(e){vn(e).append(this||t);return this||t},prependTo:function(e){vn(e).prepend(this||t);return this||t},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return wrap$2(this||t,e)},wrapAll:function(e){return wrap$2(this||t,e,true)},wrapInner:function(e){this.each((function(){vn(this||t).contents().wrapAll(e)}));return this||t},unwrap:function(){return this.parent().each((function(){vn(this||t).replaceWith((this||t).childNodes)}))},clone:function(){var e=[];this.each((function(){e.push(this.cloneNode(true))}));return vn(e)},addClass:function(e){return this.toggleClass(e,true)},removeClass:function(e){return this.toggleClass(e,false)},toggleClass:function(e,n){var a=this||t;if("string"!==typeof e)return a;-1!==e.indexOf(" ")?each$g(e.split(" "),(function(){a.toggleClass(this||t,n)})):a.each((function(t,a){var o=hasClass(a,e);if(o!==n){var i=a.className;o?a.className=trim$1((" "+i+" ").replace(" "+e+" "," ")):a.className+=i?" "+e:e}}));return a},hasClass:function(e){return hasClass((this||t)[0],e)},each:function(e){return each$g(this||t,e)},on:function(e,n){return this.each((function(){tn.bind(this||t,e,n)}))},off:function(e,n){return this.each((function(){tn.unbind(this||t,e,n)}))},trigger:function(e){return this.each((function(){"object"===typeof e?tn.fire(this||t,e.type,e):tn.fire(this||t,e)}))},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return vn(Zr.apply(this||t,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){var n,a;var o=[];for(n=0,a=(this||t).length;n<a;n++)vn.find(e,(this||t)[n],o);return vn(o)},filter:function(e){return vn("function"===typeof e?grep$2(this.toArray(),(function(t,n){return e(n,t)})):vn.filter(e,this.toArray()))},closest:function(e){var t=[];e instanceof vn&&(e=e[0]);this.each((function(n,a){while(a){if("string"===typeof e&&vn(a).is(e)){t.push(a);break}if(a===e){t.push(a);break}a=a.parentNode}}));return vn(t)},offset:function(e){var n,a,o;var i,u=0,c=0;if(!e){n=(this||t)[0];if(n){a=n.ownerDocument;o=a.documentElement;if(n.getBoundingClientRect){i=n.getBoundingClientRect();u=i.left+(o.scrollLeft||a.body.scrollLeft)-o.clientLeft;c=i.top+(o.scrollTop||a.body.scrollTop)-o.clientTop}}return{left:u,top:c}}return this.css(e)},push:Qr,sort:Array.prototype.sort,splice:Array.prototype.splice};fe.extend(DomQueryConstructor,{extend:fe.extend,makeArray:function(e){return isWindow(e)||e.nodeType?[e]:fe.toArray(e)},inArray:inArray$1,isArray:fe.isArray,each:each$g,trim:trim$1,grep:grep$2,find:Sizzle,expr:Sizzle.selectors,unique:Sizzle.uniqueSort,text:Sizzle.getText,contains:Sizzle.contains,filter:function(e,t,n){var a=t.length;n&&(e=":not("+e+")");while(a--)1!==t[a].nodeType&&t.splice(a,1);t=1===t.length?vn.find.matchesSelector(t[0],e)?[t[0]]:[]:vn.find.matches(e,t);return t}});var dir=function(e,t,n){var a=[];var o=e[t];"string"!==typeof n&&n instanceof vn&&(n=n[0]);while(o&&9!==o.nodeType){if(void 0!==n){if(o===n)break;if("string"===typeof n&&vn(o).is(n))break}1===o.nodeType&&a.push(o);o=o[t]}return a};var sibling$1=function(e,t,n,a){var o=[];a instanceof vn&&(a=a[0]);for(;e;e=e[t])if(!n||e.nodeType===n){if(void 0!==a){if(e===a)break;if("string"===typeof a&&vn(e).is(a))break}o.push(e)}return o};var firstSibling=function(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null};each$g({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return dir(e,"parentNode")},next:function(e){return firstSibling(e,"nextSibling",1)},prev:function(e){return firstSibling(e,"previousSibling",1)},children:function(e){return sibling$1(e.firstChild,"nextSibling",1)},contents:function(e){return fe.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},(function(e,n){DomQueryConstructor.fn[e]=function(a){var o=this||t;var i=[];o.each((function(){var e=n.call(i,this||t,a,i);e&&(vn.isArray(e)?i.push.apply(i,e):i.push(e))}));if((this||t).length>1){rn[e]||(i=vn.unique(i));0===e.indexOf("parents")&&(i=i.reverse())}var u=vn(i);return a?u.filter(a):u}}));each$g({parentsUntil:function(e,t){return dir(e,"parentNode",t)},nextUntil:function(e,t){return sibling$1(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return sibling$1(e,"previousSibling",1,t).slice(1)}},(function(e,n){DomQueryConstructor.fn[e]=function(a,o){var i=this||t;var u=[];i.each((function(){var e=n.call(u,this||t,a,u);e&&(vn.isArray(e)?u.push.apply(u,e):u.push(e))}));if((this||t).length>1){u=vn.unique(u);0!==e.indexOf("parents")&&"prevUntil"!==e||(u=u.reverse())}var c=vn(u);return o?c.filter(o):c}}));DomQueryConstructor.fn.is=function(e){return!!e&&this.filter(e).length>0};DomQueryConstructor.fn.init.prototype=DomQueryConstructor.fn;DomQueryConstructor.overrideDefaults=function(e){var n;var sub=function(t,a){n=n||e();0===arguments.length&&(t=n.element);a||(a=n.context);return new sub.fn.init(t,a)};vn.extend(sub,this||t);return sub};DomQueryConstructor.attrHooks=fn;DomQueryConstructor.cssHooks=sn;var vn=DomQueryConstructor;var dn=fe.each;var mn=fe.grep;var gn=ie.ie;var pn=/^([a-z0-9],?)+$/i;var setupAttrHooks=function(e,t,n){var a=t.keep_values;var o={set:function(e,a,o){t.url_converter&&null!==a&&(a=t.url_converter.call(t.url_converter_scope||n(),a,o,e[0]));e.attr("data-mce-"+o,a).attr(o,a)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}};var i={style:{set:function(t,n){if(null===n||"object"!==typeof n){a&&t.attr("data-mce-style",n);if(null!==n&&"string"===typeof n){t.removeAttr("style");t.css(e.parse(n))}else t.attr("style",n)}else t.css(n)},get:function(t){var n=t.attr("data-mce-style")||t.attr("style");n=e.serialize(e.parse(n),t[0].nodeName);return n}}};a&&(i.href=i.src=o);return i};var updateInternalStyleAttr=function(e,t){var n=t.attr("style");var a=e.serialize(e.parse(n),t[0].nodeName);a||(a=null);t.attr("data-mce-style",a)};var findNodeIndex=function(e,t){var n,a,o=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling){a=e.nodeType;if(!t||3!==a||a!==n&&e.nodeValue.length){o++;n=a}}return o};var DOMUtils=function(e,n){void 0===n&&(n={});var a={};var o=window;var i={};var c=0;var f=true;var s=true;var l=Ke.forElement(se.fromDom(e),{contentCssCors:n.contentCssCors,referrerPolicy:n.referrerPolicy});var v=[];var d=n.schema?n.schema:Schema({});var m=Styles({url_converter:n.url_converter,url_converter_scope:n.url_converter_scope},n.schema);var g=n.ownEvents?new Gt:Gt.Event;var p=d.getBlockElements();var h=vn.overrideDefaults((function(){return{context:e,element:C.getRoot()}}));var isBlock=function(e){if("string"===typeof e)return!!p[e];if(e){var t=e.nodeType;if(t)return!!(1===t&&p[e.nodeName])}return false};var get=function(t){return t&&e&&u(t)?e.getElementById(t):t};var $$=function(e){return h("string"===typeof e?get(e):e)};var getAttrib=function(e,t,n){var a,o;var i=$$(e);if(i.length){a=w[t];o=a&&a.get?a.get(i,t):i.attr(t)}"undefined"===typeof o&&(o=n||"");return o};var getAttribs=function(e){var t=get(e);return t?t.attributes:[]};var setAttrib=function(e,t,a){""===a&&(a=null);var o=$$(e);var i=o.attr(t);if(o.length){var u=w[t];u&&u.set?u.set(o,a,t):o.attr(t,a);i!==a&&n.onSetAttrib&&n.onSetAttrib({attrElm:o,attrName:t,attrValue:a})}};var clone=function(t,n){if(!gn||1!==t.nodeType||n)return t.cloneNode(n);var a=e.createElement(t.nodeName);dn(getAttribs(t),(function(e){setAttrib(a,e.nodeName,getAttrib(t,e.nodeName))}));return a};var getRoot=function(){return n.root_element||e.body};var getViewPort=function(e){var t=getBounds(e);return{x:t.x,y:t.y,w:t.width,h:t.height}};var getPos$1=function(t,n){return getPos(e.body,get(t),n)};var setStyle=function(e,t,a){var o=u(t)?$$(e).css(t,a):$$(e).css(t);n.update_styles&&updateInternalStyleAttr(m,o)};var setStyles=function(e,t){var a=$$(e).css(t);n.update_styles&&updateInternalStyleAttr(m,a)};var getStyle=function(e,t,n){var a=$$(e);if(n)return a.css(t);t=t.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()}));"float"===t&&(t=ie.browser.isIE()?"styleFloat":"cssFloat");return a[0]&&a[0].style?a[0].style[t]:void 0};var getSize=function(e){var t,n;e=get(e);t=getStyle(e,"width");n=getStyle(e,"height");-1===t.indexOf("px")&&(t=0);-1===n.indexOf("px")&&(n=0);return{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}};var getRect=function(e){e=get(e);var t=getPos$1(e);var n=getSize(e);return{x:t.x,y:t.y,w:n.w,h:n.h}};var is=function(e,t){var n;if(!e)return false;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(pn.test(t)){var a=t.toLowerCase().split(/,/);var o=e.nodeName.toLowerCase();for(n=a.length-1;n>=0;n--)if(a[n]===o)return true;return false}if(e.nodeType&&1!==e.nodeType)return false}var i=Array.isArray(e)?e:[e];return Sizzle(t,i[0].ownerDocument||i[0],null,i).length>0};var getParents=function(e,t,n,a){var o=[];var i;var u=get(e);a=void 0===a;n=n||("BODY"!==getRoot().nodeName?getRoot().parentNode:null);if(fe.is(t,"string")){i=t;t="*"===t?function(e){return 1===e.nodeType}:function(e){return is(e,i)}}while(u){if(u===n||isNullable(u.nodeType)||Ae(u)||Re(u))break;if(!t||"function"===typeof t&&t(u)){if(!a)return[u];o.push(u)}u=u.parentNode}return a?o:null};var getParent=function(e,t,n){var a=getParents(e,t,n,false);return a&&a.length>0?a[0]:null};var _findSib=function(e,t,n){var a=t;if(e){"string"===typeof t&&(a=function(e){return is(e,t)});for(e=e[n];e;e=e[n])if("function"===typeof a&&a(e))return e}return null};var getNext=function(e,t){return _findSib(e,t,"nextSibling")};var getPrev=function(e,t){return _findSib(e,t,"previousSibling")};var select=function(t,a){return Sizzle(t,get(a)||n.root_element||e,[])};var run=function(e,n,a){var o;var i="string"===typeof e?get(e):e;if(!i)return false;if(fe.isArray(i)&&(i.length||0===i.length)){o=[];dn(i,(function(e,t){e&&o.push(n.call(a,"string"===typeof e?get(e):e,t))}));return o}var u=a||(this||t);return n.call(u,i)};var setAttribs=function(e,t){$$(e).each((function(e,n){dn(t,(function(e,t){setAttrib(n,t,e)}))}))};var setHTML=function(e,t){var n=$$(e);gn?n.each((function(e,n){if(false!==n.canHaveHTML){while(n.firstChild)n.removeChild(n.firstChild);try{n.innerHTML="<br>"+t;n.removeChild(n.firstChild)}catch(e){vn("<div></div>").html("<br>"+t).contents().slice(1).appendTo(n)}return t}})):n.html(t)};var add=function(t,n,a,o,i){return run(t,(function(t){var u="string"===typeof n?e.createElement(n):n;setAttribs(u,a);o&&("string"!==typeof o&&o.nodeType?u.appendChild(o):"string"===typeof o&&setHTML(u,o));return i?u:t.appendChild(u)}))};var create=function(t,n,a){return add(e.createElement(t),t,n,a,true)};var b=Ut.decode;var y=Ut.encodeAllRaw;var createHTML=function(e,t,n){var a,o="";o+="<"+e;for(a in t)hasNonNullableKey(t,a)&&(o+=" "+a+'="'+y(t[a])+'"');return"undefined"!==typeof n?o+">"+n+"</"+e+">":o+" />"};var createFragment=function(t){var n;var a=e.createElement("div");var o=e.createDocumentFragment();o.appendChild(a);t&&(a.innerHTML=t);while(n=a.firstChild)o.appendChild(n);o.removeChild(a);return o};var remove=function(e,n){var a=$$(e);n?a.each((function(){var e;while(e=(this||t).firstChild)3===e.nodeType&&0===e.data.length?this.removeChild(e):(this||t).parentNode.insertBefore(e,this||t)})).remove():a.remove();return a.length>1?a.toArray():a[0]};var removeAllAttribs=function(e){return run(e,(function(e){var t;var n=e.attributes;for(t=n.length-1;t>=0;t--)e.removeAttributeNode(n.item(t))}))};var parseStyle=function(e){return m.parse(e)};var serializeStyle=function(e,t){return m.serialize(e,t)};var addStyle=function(t){var n,o;if(C!==DOMUtils.DOM&&e===document){if(a[t])return;a[t]=true}o=e.getElementById("mceDefaultStyles");if(!o){o=e.createElement("style");o.id="mceDefaultStyles";o.type="text/css";n=e.getElementsByTagName("head")[0];n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o)}o.styleSheet?o.styleSheet.cssText+=t:o.appendChild(e.createTextNode(t))};var loadCSS=function(e){e||(e="");each$k(e.split(","),(function(e){i[e]=true;l.load(e,noop)}))};var toggleClass=function(e,n,a){$$(e).toggleClass(n,a).each((function(){""===(this||t).className&&vn(this||t).attr("class",null)}))};var addClass=function(e,t){$$(e).addClass(t)};var removeClass=function(e,t){toggleClass(e,t,false)};var hasClass=function(e,t){return $$(e).hasClass(t)};var show=function(e){$$(e).show()};var hide=function(e){$$(e).hide()};var isHidden=function(e){return"none"===$$(e).css("display")};var uniqueId=function(e){return(e||"mce_")+c++};var getOuterHTML=function(e){var t="string"===typeof e?get(e):e;return Ee(t)?t.outerHTML:vn("<div></div>").append(vn(t).clone()).html()};var setOuterHTML=function(e,n){$$(e).each((function(){try{if("outerHTML"in(this||t)){(this||t).outerHTML=n;return}}catch(e){}remove(vn(this||t).html(n),true)}))};var insertAfter=function(e,t){var n=get(t);return run(e,(function(e){var t=n.parentNode;var a=n.nextSibling;a?t.insertBefore(e,a):t.appendChild(e);return e}))};var replace=function(e,t,n){return run(t,(function(t){fe.is(t,"array")&&(e=e.cloneNode(true));n&&dn(mn(t.childNodes),(function(t){e.appendChild(t)}));return t.parentNode.replaceChild(e,t)}))};var rename=function(e,t){var n;if(e.nodeName!==t.toUpperCase()){n=create(t);dn(getAttribs(e),(function(t){setAttrib(n,t.nodeName,getAttrib(e,t.nodeName))}));replace(n,e,true)}return n||e};var findCommonAncestor=function(e,t){var n,a=e;while(a){n=t;while(n&&a!==n)n=n.parentNode;if(a===n)break;a=a.parentNode}return!a&&e.ownerDocument?e.ownerDocument.documentElement:a};var toHex=function(e){return m.toHex(fe.trim(e))};var isNonEmptyElement=function(e){if(Ee(e)){var t="a"===e.nodeName.toLowerCase()&&!getAttrib(e,"href")&&getAttrib(e,"id");if(getAttrib(e,"name")||getAttrib(e,"data-mce-bookmark")||t)return true}return false};var isEmpty=function(e,t){var n,a,o=0;if(isNonEmptyElement(e))return false;e=e.firstChild;if(e){var i=new Xe(e,e.parentNode);var u=d?d.getWhiteSpaceElements():{};t=t||(d?d.getNonEmptyElements():null);do{n=e.nodeType;if(Ee(e)){var c=e.getAttribute("data-mce-bogus");if(c){e=i.next("all"===c);continue}a=e.nodeName.toLowerCase();if(t&&t[a]){if("br"===a){o++;e=i.next();continue}return false}if(isNonEmptyElement(e))return false}if(8===n)return false;if(3===n&&!isWhitespaceText(e.nodeValue))return false;if(3===n&&e.parentNode&&u[e.parentNode.nodeName]&&isWhitespaceText(e.nodeValue))return false;e=i.next()}while(e)}return o<=1};var createRng=function(){return e.createRange()};var split=function(e,t,n){var a=createRng();var o;var i;var u;if(e&&t){a.setStart(e.parentNode,findNodeIndex(e));a.setEnd(t.parentNode,findNodeIndex(t));o=a.extractContents();a=createRng();a.setStart(t.parentNode,findNodeIndex(t)+1);a.setEnd(e.parentNode,findNodeIndex(e)+1);i=a.extractContents();u=e.parentNode;u.insertBefore(trimNode(C,o),e);n?u.insertBefore(n,e):u.insertBefore(t,e);u.insertBefore(trimNode(C,i),e);remove(e);return n||t}};var bind=function(t,a,i,u){if(fe.isArray(t)){var c=t.length;var f=[];while(c--)f[c]=bind(t[c],a,i,u);return f}!n.collect||t!==e&&t!==o||v.push([t,a,i,u]);var s=g.bind(t,a,i,u||C);return s};var unbind=function(t,n,a){if(fe.isArray(t)){var i=t.length;var u=[];while(i--)u[i]=unbind(t[i],n,a);return u}if(v.length>0&&(t===e||t===o)){i=v.length;while(i--){var c=v[i];t!==c[0]||n&&n!==c[1]||a&&a!==c[2]||g.unbind(c[0],c[1],c[2])}}return g.unbind(t,n,a)};var fire=function(e,t,n){return g.fire(e,t,n)};var getContentEditable=function(e){if(e&&Ee(e)){var t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null};var getContentEditableParent=function(e){var t=getRoot();var n=null;for(;e&&e!==t;e=e.parentNode){n=getContentEditable(e);if(null!==n)break}return n};var destroy=function(){if(v.length>0){var e=v.length;while(e--){var t=v[e];g.unbind(t[0],t[1],t[2])}}each$j(i,(function(e,t){l.unload(t);delete i[t]}));Sizzle.setDocument&&Sizzle.setDocument()};var isChildOf=function(e,t){if(gn){while(e){if(t===e)return true;e=e.parentNode}return false}return e===t||t.contains(e)};var dumpRng=function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset};var C={doc:e,settings:n,win:o,files:i,stdMode:f,boxModel:s,styleSheetLoader:l,boundEvents:v,styles:m,schema:d,events:g,isBlock:isBlock,$:h,$$:$$,root:null,clone:clone,getRoot:getRoot,getViewPort:getViewPort,getRect:getRect,getSize:getSize,getParent:getParent,getParents:getParents,get:get,getNext:getNext,getPrev:getPrev,select:select,is:is,add:add,create:create,createHTML:createHTML,createFragment:createFragment,remove:remove,setStyle:setStyle,getStyle:getStyle,setStyles:setStyles,removeAllAttribs:removeAllAttribs,setAttrib:setAttrib,setAttribs:setAttribs,getAttrib:getAttrib,getPos:getPos$1,parseStyle:parseStyle,serializeStyle:serializeStyle,addStyle:addStyle,loadCSS:loadCSS,addClass:addClass,removeClass:removeClass,hasClass:hasClass,toggleClass:toggleClass,show:show,hide:hide,isHidden:isHidden,uniqueId:uniqueId,setHTML:setHTML,getOuterHTML:getOuterHTML,setOuterHTML:setOuterHTML,decode:b,encode:y,insertAfter:insertAfter,replace:replace,rename:rename,findCommonAncestor:findCommonAncestor,toHex:toHex,run:run,getAttribs:getAttribs,isEmpty:isEmpty,createRng:createRng,nodeIndex:findNodeIndex,split:split,bind:bind,unbind:unbind,fire:fire,getContentEditable:getContentEditable,getContentEditableParent:getContentEditableParent,destroy:destroy,isChildOf:isChildOf,dumpRng:dumpRng};var w=setupAttrHooks(m,n,constant(C));return C};DOMUtils.DOM=DOMUtils(document);DOMUtils.nodeIndex=findNodeIndex;var hn=DOMUtils.DOM;var bn=fe.each,yn=fe.grep;var Cn=0;var wn=1;var xn=2;var Sn=3;var En=function(){function ScriptLoader(e){void 0===e&&(e={});(this||t).states={};(this||t).queue=[];(this||t).scriptLoadedCallbacks={};(this||t).queueLoadedCallbacks=[];(this||t).loading=0;(this||t).settings=e}ScriptLoader.prototype._setReferrerPolicy=function(e){(this||t).settings.referrerPolicy=e};ScriptLoader.prototype.loadScript=function(e,n,a){var o=hn;var i;var cleanup=function(){o.remove(u);i&&(i.onerror=i.onload=i=null)};var done=function(){cleanup();n()};var error=function(){cleanup();d(a)?a():"undefined"!==typeof console&&console.log&&console.log("Failed to load script: "+e)};var u=o.uniqueId();i=document.createElement("script");i.id=u;i.type="text/javascript";i.src=fe._addCacheSuffix(e);(this||t).settings.referrerPolicy&&o.setAttrib(i,"referrerpolicy",(this||t).settings.referrerPolicy);i.onload=done;i.onerror=error;(document.getElementsByTagName("head")[0]||document.body).appendChild(i)};ScriptLoader.prototype.isDone=function(e){return(this||t).states[e]===xn};ScriptLoader.prototype.markDone=function(e){(this||t).states[e]=xn};ScriptLoader.prototype.add=function(e,n,a,o){var i=(this||t).states[e];(this||t).queue.push(e);void 0===i&&((this||t).states[e]=Cn);if(n){(this||t).scriptLoadedCallbacks[e]||((this||t).scriptLoadedCallbacks[e]=[]);(this||t).scriptLoadedCallbacks[e].push({success:n,failure:o,scope:a||this||t})}};ScriptLoader.prototype.load=function(e,t,n,a){return this.add(e,t,n,a)};ScriptLoader.prototype.remove=function(e){delete(this||t).states[e];delete(this||t).scriptLoadedCallbacks[e]};ScriptLoader.prototype.loadQueue=function(e,n,a){this.loadScripts((this||t).queue,e,n,a)};ScriptLoader.prototype.loadScripts=function(e,n,a,o){var i=this||t;var u=[];var execCallbacks=function(e,t){bn(i.scriptLoadedCallbacks[t],(function(t){d(t[e])&&t[e].call(t.scope)}));i.scriptLoadedCallbacks[t]=void 0};i.queueLoadedCallbacks.push({success:n,failure:o,scope:a||this||t});var loadScripts=function(){var t=yn(e);e.length=0;bn(t,(function(e){if(i.states[e]!==xn)if(i.states[e]!==Sn){if(i.states[e]!==wn){i.states[e]=wn;i.loading++;i.loadScript(e,(function(){i.states[e]=xn;i.loading--;execCallbacks("success",e);loadScripts()}),(function(){i.states[e]=Sn;i.loading--;u.push(e);execCallbacks("failure",e);loadScripts()}))}}else execCallbacks("failure",e);else execCallbacks("success",e)}));if(!i.loading){var n=i.queueLoadedCallbacks.slice(0);i.queueLoadedCallbacks.length=0;bn(n,(function(e){0===u.length?d(e.success)&&e.success.call(e.scope):d(e.failure)&&e.failure.call(e.scope,u)}))}};loadScripts()};ScriptLoader.ScriptLoader=new ScriptLoader;return ScriptLoader}();var Cell=function(e){var t=e;var get=function(){return t};var set=function(e){t=e};return{get:get,set:set}};var isRaw=function(e){return c(e)&&has$2(e,"raw")};var isTokenised=function(e){return f(e)&&e.length>1};var kn={};var Nn=Cell("en");var getLanguageData=function(){return get$9(kn,Nn.get())};var getData=function(){return map$2(kn,(function(e){return __assign({},e)}))};var setCode=function(e){e&&Nn.set(e)};var getCode=function(){return Nn.get()};var add$4=function(e,t){var n=kn[e];n||(kn[e]=n={});each$j(t,(function(e,t){n[t.toLowerCase()]=e}))};var translate=function(e){var t=getLanguageData().getOr({});var toString=function(e){return d(e)?Object.prototype.toString.call(e):isEmpty(e)?"":""+e};var isEmpty=function(e){return""===e||null===e||void 0===e};var getLangData=function(e){var n=toString(e);return get$9(t,n.toLowerCase()).map(toString).getOr(n)};var removeContext=function(e){return e.replace(/{context:\w+}$/,"")};if(isEmpty(e))return"";if(isRaw(e))return toString(e.raw);if(isTokenised(e)){var n=e.slice(1);var a=getLangData(e[0]).replace(/\{([0-9]+)\}/g,(function(e,t){return has$2(n,t)?toString(n[t]):e}));return removeContext(a)}return removeContext(getLangData(e))};var isRtl$1=function(){return getLanguageData().bind((function(e){return get$9(e,"_dir")})).exists((function(e){return"rtl"===e}))};var hasCode=function(e){return has$2(kn,e)};var _n={getData:getData,setCode:setCode,getCode:getCode,add:add$4,translate:translate,isRtl:isRtl$1,hasCode:hasCode};var AddOnManager=function(){var e=[];var t={};var n={};var a=[];var runListeners=function(e,t){var n=filter$4(a,(function(n){return n.name===e&&n.state===t}));each$k(n,(function(e){return e.callback()}))};var get=function(e){if(n[e])return n[e].instance};var dependencies=function(e){var t;n[e]&&(t=n[e].dependencies);return t||[]};var requireLangPack=function(e,n){false!==AddOnManager.languageLoad&&waitFor(e,(function(){var a=_n.getCode();var o=","+(n||"")+",";!a||n&&-1===o.indexOf(","+a+",")||En.ScriptLoader.add(t[e]+"/langs/"+a+".js")}),"loaded")};var add=function(t,a,o){var i=a;e.push(i);n[t]={instance:i,dependencies:o};runListeners(t,"added");return i};var remove=function(e){delete t[e];delete n[e]};var createUrl=function(e,t){return"object"===typeof t?t:"string"===typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}};var addComponents=function(e,n){var a=t[e];each$k(n,(function(e){En.ScriptLoader.add(a+"/"+e)}))};var loadDependencies=function(e,t,n,a){var o=dependencies(e);each$k(o,(function(e){var n=createUrl(t,e);load(n.resource,n,void 0,void 0)}));n&&(a?n.call(a):n.call(En))};var load=function(e,a,o,i,u){if(!t[e]){var c="string"===typeof a?a:a.prefix+a.resource+a.suffix;0!==c.indexOf("/")&&-1===c.indexOf("://")&&(c=AddOnManager.baseURL+"/"+c);t[e]=c.substring(0,c.lastIndexOf("/"));var done=function(){runListeners(e,"loaded");loadDependencies(e,a,o,i)};n[e]?done():En.ScriptLoader.add(c,done,i,u)}};var waitFor=function(e,o,i){void 0===i&&(i="added");has$2(n,e)&&"added"===i||has$2(t,e)&&"loaded"===i?o():a.push({name:e,state:i,callback:o})};return{items:e,urls:t,lookup:n,_listeners:a,get:get,dependencies:dependencies,requireLangPack:requireLangPack,add:add,remove:remove,createUrl:createUrl,addComponents:addComponents,load:load,waitFor:waitFor}};AddOnManager.languageLoad=true;AddOnManager.baseURL="";AddOnManager.PluginManager=AddOnManager();AddOnManager.ThemeManager=AddOnManager();var singleton=function(e){var t=Cell(b.none());var revoke=function(){return t.get().each(e)};var clear=function(){revoke();t.set(b.none())};var isSet=function(){return t.get().isSome()};var get=function(){return t.get()};var set=function(e){revoke();t.set(b.some(e))};return{clear:clear,isSet:isSet,get:get,set:set}};var value=function(){var e=singleton(noop);var on=function(t){return e.get().each(t)};return __assign(__assign({},e),{on:on})};var first=function(e,t){var n=null;var cancel=function(){if(!s(n)){clearTimeout(n);n=null}};var throttle=function(){var a=[];for(var o=0;o<arguments.length;o++)a[o]=arguments[o];s(n)&&(n=setTimeout((function(){n=null;e.apply(null,a)}),t))};return{cancel:cancel,throttle:throttle}};var last=function(e,t){var n=null;var cancel=function(){if(!s(n)){clearTimeout(n);n=null}};var throttle=function(){var a=[];for(var o=0;o<arguments.length;o++)a[o]=arguments[o];cancel();n=setTimeout((function(){n=null;e.apply(null,a)}),t)};return{cancel:cancel,throttle:throttle}};var read$4=function(e,t){var n=get$6(e,t);return void 0===n||""===n?[]:n.split(" ")};var add$3=function(e,t,n){var a=read$4(e,t);var o=a.concat([n]);set$1(e,t,o.join(" "));return true};var remove$5=function(e,t,n){var a=filter$4(read$4(e,t),(function(e){return e!==n}));a.length>0?set$1(e,t,a.join(" ")):remove$6(e,t);return false};var supports=function(e){return void 0!==e.dom.classList};var get$4=function(e){return read$4(e,"class")};var add$2=function(e,t){return add$3(e,"class",t)};var remove$4=function(e,t){return remove$5(e,"class",t)};var add$1=function(e,t){supports(e)?e.dom.classList.add(t):add$2(e,t)};var cleanClass=function(e){var t=supports(e)?e.dom.classList:get$4(e);0===t.length&&remove$6(e,"class")};var remove$3=function(e,t){if(supports(e)){var n=e.dom.classList;n.remove(t)}else remove$4(e,t);cleanClass(e)};var has=function(e,t){return supports(e)&&e.dom.classList.contains(t)};var descendants$1=function(e,t){var n=[];each$k(children(e),(function(e){t(e)&&(n=n.concat([e]));n=n.concat(descendants$1(e,t))}));return n};var descendants=function(e,t){return all(t,e)};var An=constant("mce-annotation");var Rn=constant("data-mce-annotation");var Dn=constant("data-mce-annotation-uid");var identify=function(e,t){var n=e.selection.getRng();var a=se.fromDom(n.startContainer);var o=se.fromDom(e.getBody());var i=t.fold((function(){return"."+An()}),(function(e){return"["+Rn()+'="'+e+'"]'}));var u=child$1(a,n.startOffset).getOr(a);var c=closest$2(u,i,(function(e){return eq(e,o)}));var getAttr=function(e,t){return has$1(e,t)?b.some(get$6(e,t)):b.none()};return c.bind((function(t){return getAttr(t,""+Dn()).bind((function(n){return getAttr(t,""+Rn()).map((function(t){var a=findMarkers(e,n);return{uid:n,name:t,elements:a}}))}))}))};var isAnnotation=function(e){return pe(e)&&has(e,An())};var findMarkers=function(e,t){var n=se.fromDom(e.getBody());return descendants(n,"["+Dn()+'="'+t+'"]')};var findAll=function(e,t){var n=se.fromDom(e.getBody());var a=descendants(n,"["+Rn()+'="'+t+'"]');var o={};each$k(a,(function(e){var t=get$6(e,Dn());var n=get$9(o,t).getOr([]);o[t]=n.concat([e])}));return o};var setup$n=function(e,t){var n=Cell({});var initData=function(){return{listeners:[],previous:value()}};var withCallbacks=function(e,t){updateCallbacks(e,(function(e){t(e);return e}))};var updateCallbacks=function(e,t){var a=n.get();var o=get$9(a,e).getOrThunk(initData);var i=t(o);a[e]=i;n.set(a)};var fireCallbacks=function(e,t,n){withCallbacks(e,(function(a){each$k(a.listeners,(function(a){return a(true,e,{uid:t,nodes:map$3(n,(function(e){return e.dom}))})}))}))};var fireNoAnnotation=function(e){withCallbacks(e,(function(t){each$k(t.listeners,(function(t){return t(false,e)}))}))};var a=last((function(){var t=n.get();var a=sort(S(t));each$k(a,(function(t){updateCallbacks(t,(function(n){var a=n.previous.get();identify(e,b.some(t)).fold((function(){if(a.isSome()){fireNoAnnotation(t);n.previous.clear()}}),(function(e){var t=e.uid,o=e.name,i=e.elements;if(!is$1(a,t)){fireCallbacks(o,t,i);n.previous.set(t)}}));return{previous:n.previous,listeners:n.listeners}}))}))}),30);e.on("remove",(function(){a.cancel()}));e.on("NodeChange",(function(){a.throttle()}));var addListener=function(e,t){updateCallbacks(e,(function(e){return{previous:e.previous,listeners:e.listeners.concat([t])}}))};return{addListener:addListener}};var setup$m=function(e,t){var identifyParserNode=function(e){return b.from(e.attr(Rn())).bind(t.lookup)};e.on("init",(function(){e.serializer.addNodeFilter("span",(function(e){each$k(e,(function(e){identifyParserNode(e).each((function(t){false===t.persistent&&e.unwrap()}))}))}))}))};var create$7=function(){var e={};var register=function(t,n){e[t]={name:t,settings:n}};var lookup=function(t){return get$9(e,t).map((function(e){return e.settings}))};return{register:register,lookup:lookup}};var Tn=0;var generate=function(e){var t=new Date;var n=t.getTime();var a=Math.floor(1e9*Math.random());Tn++;return e+"_"+a+Tn+String(n)};var add=function(e,t){each$k(t,(function(t){add$1(e,t)}))};var fromHtml=function(e,t){var n=t||document;var a=n.createElement("div");a.innerHTML=e;return children(se.fromDom(a))};var fromDom$1=function(e){return map$3(e,se.fromDom)};var get$3=function(e){return e.dom.innerHTML};var set=function(e,t){var n=owner$1(e);var a=n.dom;var o=se.fromDom(a.createDocumentFragment());var i=fromHtml(t,a);append(o,i);empty(e);append$1(e,o)};var clone$1=function(e,t){return se.fromDom(e.dom.cloneNode(t))};var shallow=function(e){return clone$1(e,false)};var deep$1=function(e){return clone$1(e,true)};var TextWalker=function(e,t,n){void 0===n&&(n=g);var a=new Xe(e,t);var walk=function(e){var t;do{t=a[e]()}while(t&&!Ne(t)&&!n(t));return b.from(t).filter(Ne)};return{current:function(){return b.from(a.current()).filter(Ne)},next:function(){return walk("next")},prev:function(){return walk("prev")},prev2:function(){return walk("prev2")}}};var TextSeeker=function(e,t){var n=t||function(t){return e.isBlock(t)||De(t)||Be(t)};var walk=function(e,t,n,a){if(Ne(e)){var o=a(e,t,e.data);if(-1!==o)return b.some({container:e,offset:o})}return n().bind((function(e){return walk(e.container,e.offset,n,a)}))};var backwards=function(e,t,a,o){var i=TextWalker(e,o,n);return walk(e,t,(function(){return i.prev().map((function(e){return{container:e,offset:e.length}}))}),a).getOrNull()};var forwards=function(e,t,a,o){var i=TextWalker(e,o,n);return walk(e,t,(function(){return i.next().map((function(e){return{container:e,offset:0}}))}),a).getOrNull()};return{backwards:backwards,forwards:forwards}};var On=Math.round;var clone=function(e){return e?{left:On(e.left),top:On(e.top),bottom:On(e.bottom),right:On(e.right),width:On(e.width),height:On(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}};var collapse=function(e,t){e=clone(e);if(t)e.right=e.left;else{e.left=e.left+e.width;e.right=e.left}e.width=0;return e};var isEqual=function(e,t){return e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right};var isValidOverflow=function(e,t,n){return e>=0&&e<=Math.min(t.height,n.height)/2};var isAbove$1=function(e,t){var n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&isValidOverflow(t.top-e.bottom,e,t)};var isBelow$1=function(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&isValidOverflow(t.bottom-e.top,e,t)};var containsXY=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom};var clamp$2=function(e,t,n){return Math.min(Math.max(e,t),n)};var getSelectedNode=function(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null};var getNode$1=function(e,t){if(Ee(e)&&e.hasChildNodes()){var n=e.childNodes;var a=clamp$2(t,0,n.length-1);return n[a]}return e};var getNodeUnsafe=function(e,t){return t<0&&Ee(e)&&e.hasChildNodes()?void 0:getNode$1(e,t)};var Bn=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]");var isExtendingChar=function(e){return"string"===typeof e&&e.charCodeAt(0)>=768&&Bn.test(e)};var or=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(e[n](t))return true;return false}};var and=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(!e[n](t))return false;return true}};var Pn=Ee;var Ln=isCaretCandidate$3;var In=matchStyleValues("display","block table");var Mn=matchStyleValues("float","left right");var Fn=and(Pn,Ln,not(Mn));var Un=not(matchStyleValues("white-space","pre pre-line pre-wrap"));var zn=Ne;var jn=De;var Hn=DOMUtils.nodeIndex;var Vn=getNodeUnsafe;var createRange$1=function(e){return"createRange"in e?e.createRange():DOMUtils.DOM.createRng()};var isWhiteSpace$1=function(e){return e&&/[\r\n\t ]/.test(e)};var isRange=function(e){return!!e.setStart&&!!e.setEnd};var isHiddenWhiteSpaceRange=function(e){var t=e.startContainer;var n=e.startOffset;if(isWhiteSpace$1(e.toString())&&Un(t.parentNode)&&Ne(t)){var a=t.data;if(isWhiteSpace$1(a[n-1])||isWhiteSpace$1(a[n+1]))return true}return false};var getBrClientRect=function(e){var t=e.ownerDocument;var n=createRange$1(t);var a=t.createTextNode(vt);var o=e.parentNode;o.insertBefore(a,e);n.setStart(a,0);n.setEnd(a,1);var i=clone(n.getBoundingClientRect());o.removeChild(a);return i};var getBoundingClientRectWebKitText=function(e){var t=e.startContainer;var n=e.endContainer;var a=e.startOffset;var o=e.endOffset;if(t===n&&Ne(n)&&0===a&&1===o){var i=e.cloneRange();i.setEndAfter(n);return getBoundingClientRect$1(i)}return null};var isZeroRect=function(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom};var getBoundingClientRect$1=function(e){var t;var n=e.getClientRects();t=n.length>0?clone(n[0]):clone(e.getBoundingClientRect());return!isRange(e)&&jn(e)&&isZeroRect(t)?getBrClientRect(e):isZeroRect(t)&&isRange(e)?getBoundingClientRectWebKitText(e):t};var collapseAndInflateWidth=function(e,t){var n=collapse(e,t);n.width=1;n.right=n.left+1;return n};var getCaretPositionClientRects=function(e){var t=[];var addUniqueAndValidRect=function(e){0!==e.height&&(t.length>0&&isEqual(e,t[t.length-1])||t.push(e))};var addCharacterOffset=function(e,n){var a=createRange$1(e.ownerDocument);if(n<e.data.length){if(isExtendingChar(e.data[n]))return t;if(isExtendingChar(e.data[n-1])){a.setStart(e,n);a.setEnd(e,n+1);if(!isHiddenWhiteSpaceRange(a)){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(a),false));return t}}}if(n>0){a.setStart(e,n-1);a.setEnd(e,n);isHiddenWhiteSpaceRange(a)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(a),false))}if(n<e.data.length){a.setStart(e,n);a.setEnd(e,n+1);isHiddenWhiteSpaceRange(a)||addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(a),true))}};var n=e.container();var a=e.offset();if(zn(n)){addCharacterOffset(n,a);return t}if(Pn(n))if(e.isAtEnd()){var o=Vn(n,a);zn(o)&&addCharacterOffset(o,o.data.length);Fn(o)&&!jn(o)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(o),false))}else{o=Vn(n,a);zn(o)&&addCharacterOffset(o,0);if(Fn(o)&&e.isAtEnd()){addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(o),false));return t}var i=Vn(e.container(),e.offset()-1);Fn(i)&&!jn(i)&&(In(i)||In(o)||!Fn(o))&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(i),false));Fn(o)&&addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(o),true))}return t};var CaretPosition=function(e,t,n){var isAtStart=function(){return zn(e),0===t};var isAtEnd=function(){return zn(e)?t>=e.data.length:t>=e.childNodes.length};var toRange=function(){var n=createRange$1(e.ownerDocument);n.setStart(e,t);n.setEnd(e,t);return n};var getClientRects=function(){n||(n=getCaretPositionClientRects(CaretPosition(e,t)));return n};var isVisible=function(){return getClientRects().length>0};var isEqual=function(n){return n&&e===n.container()&&t===n.offset()};var getNode=function(n){return Vn(e,n?t-1:t)};return{container:constant(e),offset:constant(t),toRange:toRange,getClientRects:getClientRects,isVisible:isVisible,isAtStart:isAtStart,isAtEnd:isAtEnd,isEqual:isEqual,getNode:getNode}};CaretPosition.fromRangeStart=function(e){return CaretPosition(e.startContainer,e.startOffset)};CaretPosition.fromRangeEnd=function(e){return CaretPosition(e.endContainer,e.endOffset)};CaretPosition.after=function(e){return CaretPosition(e.parentNode,Hn(e)+1)};CaretPosition.before=function(e){return CaretPosition(e.parentNode,Hn(e))};CaretPosition.isAbove=function(e,t){return lift2(head(t.getClientRects()),last$2(e.getClientRects()),isAbove$1).getOr(false)};CaretPosition.isBelow=function(e,t){return lift2(last$2(t.getClientRects()),head(e.getClientRects()),isBelow$1).getOr(false)};CaretPosition.isAtStart=function(e){return!!e&&e.isAtStart()};CaretPosition.isAtEnd=function(e){return!!e&&e.isAtEnd()};CaretPosition.isTextPosition=function(e){return!!e&&Ne(e.container())};CaretPosition.isElementPosition=function(e){return false===CaretPosition.isTextPosition(e)};var trimEmptyTextNode$1=function(e,t){Ne(t)&&0===t.data.length&&e.remove(t)};var insertNode=function(e,t,n){t.insertNode(n);trimEmptyTextNode$1(e,n.previousSibling);trimEmptyTextNode$1(e,n.nextSibling)};var insertFragment=function(e,t,n){var a=b.from(n.firstChild);var o=b.from(n.lastChild);t.insertNode(n);a.each((function(t){return trimEmptyTextNode$1(e,t.previousSibling)}));o.each((function(t){return trimEmptyTextNode$1(e,t.nextSibling)}))};var rangeInsertNode=function(e,t,n){Re(n)?insertFragment(e,t,n):insertNode(e,t,n)};var qn=Ne;var $n=isBogus$2;var Wn=DOMUtils.nodeIndex;var normalizedParent=function(e){var t=e.parentNode;return $n(t)?normalizedParent(t):t};var getChildNodes=function(e){return e?reduce(e.childNodes,(function(e,t){$n(t)&&"BR"!==t.nodeName?e=e.concat(getChildNodes(t)):e.push(t);return e}),[]):[]};var normalizedTextOffset=function(e,t){while(e=e.previousSibling){if(!qn(e))break;t+=e.data.length}return t};var equal=function(e){return function(t){return e===t}};var normalizedNodeIndex=function(e){var t,n;t=getChildNodes(normalizedParent(e));n=findIndex$1(t,equal(e),e);t=t.slice(0,n+1);var a=reduce(t,(function(e,n,a){qn(n)&&qn(t[a-1])&&e++;return e}),0);t=filter$2(t,matchNodeNames([e.nodeName]));n=findIndex$1(t,equal(e),e);return n-a};var createPathItem=function(e){var t;t=qn(e)?"text()":e.nodeName.toLowerCase();return t+"["+normalizedNodeIndex(e)+"]"};var parentsUntil$1=function(e,t,n){var a=[];for(t=t.parentNode;t!==e;t=t.parentNode){if(n&&n(t))break;a.push(t)}return a};var create$6=function(e,t){var n,a,o,i,u,c=[];n=t.container();a=t.offset();if(qn(n))o=normalizedTextOffset(n,a);else{i=n.childNodes;if(a>=i.length){o="after";a=i.length-1}else o="before";n=i[a]}c.push(createPathItem(n));u=parentsUntil$1(e,n);u=filter$2(u,not(isBogus$2));c=c.concat(map$1(u,(function(e){return createPathItem(e)})));return c.reverse().join("/")+","+o};var resolvePathItem=function(e,t,n){var a=getChildNodes(e);a=filter$2(a,(function(e,t){return!qn(e)||!qn(a[t-1])}));a=filter$2(a,matchNodeNames([t]));return a[n]};var findTextPosition=function(e,t){var n,a=e,o=0;while(qn(a)){n=a.data.length;if(t>=o&&t<=o+n){e=a;t-=o;break}if(!qn(a.nextSibling)){e=a;t=n;break}o+=n;a=a.nextSibling}qn(e)&&t>e.data.length&&(t=e.data.length);return CaretPosition(e,t)};var resolve$2=function(e,t){var n;if(!t)return null;var a=t.split(",");var o=a[0].split("/");n=a.length>1?a[1]:"before";var i=reduce(o,(function(e,t){var n=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);if(!n)return null;"text()"===n[1]&&(n[1]="#text");return resolvePathItem(e,n[1],parseInt(n[2],10))}),e);if(!i)return null;if(!qn(i)){n="after"===n?Wn(i)+1:Wn(i);return CaretPosition(i.parentNode,n)}return findTextPosition(i,parseInt(n,10))};var Kn=Be;var getNormalizedTextOffset=function(e,t,n){var a,o;o=e(t.data.slice(0,n)).length;for(a=t.previousSibling;a&&Ne(a);a=a.previousSibling)o+=e(a.data).length;return o};var getPoint=function(e,t,n,a,o){var i=a[o?"startContainer":"endContainer"];var u=a[o?"startOffset":"endOffset"];var c=[];var f,s=0;var l=e.getRoot();if(Ne(i))c.push(n?getNormalizedTextOffset(t,i,u):u);else{f=i.childNodes;if(u>=f.length&&f.length){s=1;u=Math.max(0,f.length-1)}c.push(e.nodeIndex(f[u],n)+s)}for(;i&&i!==l;i=i.parentNode)c.push(e.nodeIndex(i,n));return c};var getLocation=function(e,t,n,a){var o=t.dom,i={};i.start=getPoint(o,e,n,a,true);t.isCollapsed()||(i.end=getPoint(o,e,n,a,false));isRangeInCaretContainerBlock(a)&&(i.isFakeCaret=true);return i};var findIndex=function(e,t,n){var a=0;fe.each(e.select(t),(function(e){if("all"!==e.getAttribute("data-mce-bogus")){if(e===n)return false;a++}}));return a};var moveEndPoint$1=function(e,t){var n,a,o;var i=t?"start":"end";n=e[i+"Container"];a=e[i+"Offset"];if(Ee(n)&&"TR"===n.nodeName){o=n.childNodes;n=o[Math.min(t?a:a-1,o.length-1)];if(n){a=t?0:n.childNodes.length;e["set"+(t?"Start":"End")](n,a)}}};var normalizeTableCellSelection=function(e){moveEndPoint$1(e,true);moveEndPoint$1(e,false);return e};var findSibling=function(e,t){var n;if(Ee(e)){e=getNode$1(e,t);if(Kn(e))return e}if(isCaretContainer$2(e)){Ne(e)&&isCaretContainerBlock$1(e)&&(e=e.parentNode);n=e.previousSibling;if(Kn(n))return n;n=e.nextSibling;if(Kn(n))return n}};var findAdjacentContentEditableFalseElm=function(e){return findSibling(e.startContainer,e.startOffset)||findSibling(e.endContainer,e.endOffset)};var getOffsetBookmark=function(e,t,n){var a=n.getNode();var o=a?a.nodeName:null;var i=n.getRng();if(Kn(a)||"IMG"===o)return{name:o,index:findIndex(n.dom,o,a)};var u=findAdjacentContentEditableFalseElm(i);if(u){o=u.tagName;return{name:o,index:findIndex(n.dom,o,u)}}return getLocation(e,n,t,i)};var getCaretBookmark=function(e){var t=e.getRng();return{start:create$6(e.dom.getRoot(),CaretPosition.fromRangeStart(t)),end:create$6(e.dom.getRoot(),CaretPosition.fromRangeEnd(t))}};var getRangeBookmark=function(e){return{rng:e.getRng()}};var createBookmarkSpan=function(e,t,n){var a={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",a,"&#xFEFF;"):e.create("span",a)};var getPersistentBookmark=function(e,t){var n=e.dom;var a=e.getRng();var o=n.uniqueId();var i=e.isCollapsed();var u=e.getNode();var c=u.nodeName;if("IMG"===c)return{name:c,index:findIndex(n,c,u)};var f=normalizeTableCellSelection(a.cloneRange());if(!i){f.collapse(false);var s=createBookmarkSpan(n,o+"_end",t);rangeInsertNode(n,f,s)}a=normalizeTableCellSelection(a);a.collapse(true);var l=createBookmarkSpan(n,o+"_start",t);rangeInsertNode(n,a,l);e.moveToBookmark({id:o,keep:true});return{id:o}};var getBookmark$2=function(e,t,n){return 2===t?getOffsetBookmark(gt,n,e):3===t?getCaretBookmark(e):t?getRangeBookmark(e):getPersistentBookmark(e,false)};var Xn=curry(getOffsetBookmark,identity,true);var Yn=DOMUtils.DOM;var Gn="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow";var getBodySetting=function(e,t,n){var a=e.getParam(t,n);if(-1!==a.indexOf("=")){var o=e.getParam(t,"","hash");return get$9(o,e.id).getOr(n)}return a};var getIframeAttrs=function(e){return e.getParam("iframe_attrs",{})};var getDocType=function(e){return e.getParam("doctype","<!DOCTYPE html>")};var getDocumentBaseUrl=function(e){return e.getParam("document_base_url","")};var getBodyId=function(e){return getBodySetting(e,"body_id","tinymce")};var getBodyClass=function(e){return getBodySetting(e,"body_class","")};var getContentSecurityPolicy=function(e){return e.getParam("content_security_policy","")};var shouldPutBrInPre$1=function(e){return e.getParam("br_in_pre",true)};var getForcedRootBlock=function(e){if(e.getParam("force_p_newlines",false))return"p";var t=e.getParam("forced_root_block","p");return false===t?"":true===t?"p":t};var getForcedRootBlockAttrs=function(e){return e.getParam("forced_root_block_attrs",{})};var getBrNewLineSelector=function(e){return e.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")};var getNoNewLineSelector=function(e){return e.getParam("no_newline_selector","")};var shouldKeepStyles=function(e){return e.getParam("keep_styles",true)};var shouldEndContainerOnEmptyBlock=function(e){return e.getParam("end_container_on_empty_block",false)};var getFontStyleValues=function(e){return fe.explode(e.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large"))};var getFontSizeClasses=function(e){return fe.explode(e.getParam("font_size_classes",""))};var getImagesDataImgFilter=function(e){return e.getParam("images_dataimg_filter",p,"function")};var isAutomaticUploadsEnabled=function(e){return e.getParam("automatic_uploads",true,"boolean")};var shouldReuseFileName=function(e){return e.getParam("images_reuse_filename",false,"boolean")};var shouldReplaceBlobUris=function(e){return e.getParam("images_replace_blob_uris",true,"boolean")};var getIconPackName=function(e){return e.getParam("icons","","string")};var getIconsUrl=function(e){return e.getParam("icons_url","","string")};var getImageUploadUrl=function(e){return e.getParam("images_upload_url","","string")};var getImageUploadBasePath=function(e){return e.getParam("images_upload_base_path","","string")};var getImagesUploadCredentials=function(e){return e.getParam("images_upload_credentials",false,"boolean")};var getImagesUploadHandler=function(e){return e.getParam("images_upload_handler",null,"function")};var shouldUseContentCssCors=function(e){return e.getParam("content_css_cors",false,"boolean")};var getReferrerPolicy=function(e){return e.getParam("referrer_policy","","string")};var getLanguageCode=function(e){return e.getParam("language","en","string")};var getLanguageUrl=function(e){return e.getParam("language_url","","string")};var shouldIndentUseMargin=function(e){return e.getParam("indent_use_margin",false)};var getIndentation=function(e){return e.getParam("indentation","40px","string")};var getContentCss=function(e){var t=e.getParam("content_css");return u(t)?map$3(t.split(","),_):f(t)?t:false===t||e.inline?[]:["default"]};var getFontCss=function(e){var t=e.getParam("font_css",[]);return f(t)?t:map$3(t.split(","),_)};var getDirectionality=function(e){return e.getParam("directionality",_n.isRtl()?"rtl":void 0)};var getInlineBoundarySelector=function(e){return e.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string")};var getObjectResizing=function(e){var t=e.getParam("object_resizing");return false!==t&&!ie.iOS&&(u(t)?t:"table,img,figure.image,div,video,iframe")};var getResizeImgProportional=function(e){return e.getParam("resize_img_proportional",true,"boolean")};var getPlaceholder=function(e){return e.getParam("placeholder",Yn.getAttrib(e.getElement(),"placeholder"),"string")};var getEventRoot=function(e){return e.getParam("event_root")};var getServiceMessage=function(e){return e.getParam("service_message")};var getTheme=function(e){return e.getParam("theme")};var shouldValidate=function(e){return e.getParam("validate")};var isInlineBoundariesEnabled=function(e){return false!==e.getParam("inline_boundaries")};var getFormats=function(e){return e.getParam("formats")};var getPreviewStyles=function(e){var t=e.getParam("preview_styles",Gn);return u(t)?t:""};var canFormatEmptyLines=function(e){return e.getParam("format_empty_lines",false,"boolean")};var getCustomUiSelector=function(e){return e.getParam("custom_ui_selector","","string")};var getThemeUrl=function(e){return e.getParam("theme_url")};var isInline=function(e){return e.getParam("inline")};var hasHiddenInput=function(e){return e.getParam("hidden_input")};var shouldPatchSubmit=function(e){return e.getParam("submit_patch")};var isEncodingXml=function(e){return"xml"===e.getParam("encoding")};var shouldAddFormSubmitTrigger=function(e){return e.getParam("add_form_submit_trigger")};var shouldAddUnloadTrigger=function(e){return e.getParam("add_unload_trigger")};var hasForcedRootBlock=function(e){return""!==getForcedRootBlock(e)};var getCustomUndoRedoLevels=function(e){return e.getParam("custom_undo_redo_levels",0,"number")};var shouldDisableNodeChange=function(e){return e.getParam("disable_nodechange")};var isReadOnly$1=function(e){return e.getParam("readonly")};var hasContentCssCors=function(e){return e.getParam("content_css_cors")};var getPlugins=function(e){return e.getParam("plugins","","string")};var getExternalPlugins$1=function(e){return e.getParam("external_plugins")};var shouldBlockUnsupportedDrop=function(e){return e.getParam("block_unsupported_drop",true,"boolean")};var isVisualAidsEnabled=function(e){return e.getParam("visual",true,"boolean")};var getVisualAidsTableClass=function(e){return e.getParam("visual_table_class","mce-item-table","string")};var getVisualAidsAnchorClass=function(e){return e.getParam("visual_anchor_class","mce-item-anchor","string")};var getIframeTitle=function(e){return e.getParam("iframe_aria_text","Rich Text Area. Press ALT-0 for help.","string")};var Jn=Ee;var Qn=Ne;var removeNode$1=function(e){var t=e.parentNode;t&&t.removeChild(e)};var trimCount=function(e){var t=gt(e);return{count:e.length-t.length,text:t}};var deleteZwspChars=function(e){var t;while(-1!==(t=e.data.lastIndexOf(dt)))e.deleteData(t,1)};var removeUnchanged=function(e,t){remove$2(e);return t};var removeTextAndReposition=function(e,t){var n=trimCount(e.data.substr(0,t.offset()));var a=trimCount(e.data.substr(t.offset()));var o=n.text+a.text;if(o.length>0){deleteZwspChars(e);return CaretPosition(e,t.offset()-n.count)}return t};var removeElementAndReposition=function(e,t){var n=t.container();var a=indexOf$2(x(n.childNodes),e).map((function(e){return e<t.offset()?CaretPosition(n,t.offset()-1):t})).getOr(t);remove$2(e);return a};var removeTextCaretContainer=function(e,t){return Qn(e)&&t.container()===e?removeTextAndReposition(e,t):removeUnchanged(e,t)};var removeElementCaretContainer=function(e,t){return t.container()===e.parentNode?removeElementAndReposition(e,t):removeUnchanged(e,t)};var removeAndReposition=function(e,t){return CaretPosition.isTextPosition(t)?removeTextCaretContainer(e,t):removeElementCaretContainer(e,t)};var remove$2=function(e){Jn(e)&&isCaretContainer$2(e)&&(hasContent(e)?e.removeAttribute("data-mce-caret"):removeNode$1(e));if(Qn(e)){deleteZwspChars(e);0===e.data.length&&removeNode$1(e)}};var Zn=detect().browser;var ea=Be;var ta=Le;var ra=Pe;var na="*[contentEditable=false],video,audio,embed,object";var getAbsoluteClientRect=function(e,t,n){var a=collapse(t.getBoundingClientRect(),n);var o;var i;if("BODY"===e.tagName){var u=e.ownerDocument.documentElement;o=e.scrollLeft||u.scrollLeft;i=e.scrollTop||u.scrollTop}else{var c=e.getBoundingClientRect();o=e.scrollLeft-c.left;i=e.scrollTop-c.top}a.left+=o;a.right+=o;a.top+=i;a.bottom+=i;a.width=1;var f=t.offsetWidth-t.clientWidth;if(f>0){n&&(f*=-1);a.left+=f;a.right+=f}return a};var trimInlineCaretContainers=function(e){var t=descendants(se.fromDom(e),na);for(var n=0;n<t.length;n++){var a=t[n].dom;var o=a.previousSibling;if(endsWithCaretContainer$1(o)){var i=o.data;1===i.length?o.parentNode.removeChild(o):o.deleteData(i.length-1,1)}o=a.nextSibling;if(startsWithCaretContainer$1(o)){i=o.data;1===i.length?o.parentNode.removeChild(o):o.deleteData(0,1)}}};var FakeCaret=function(e,t,n,a){var o=value();var i;var u;var c=getForcedRootBlock(e);var f=c.length>0?c:"p";var show=function(e,a){var i;hide();if(ra(a))return null;if(!n(a)){u=insertInline$1(a,e);i=a.ownerDocument.createRange();if(isInlineFakeCaretTarget(u.nextSibling)){i.setStart(u,0);i.setEnd(u,0)}else{i.setStart(u,1);i.setEnd(u,1)}return i}u=insertBlock$1(f,a,e);var c=getAbsoluteClientRect(t,a,e);vn(u).css("top",c.top);var s=vn('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(__assign({},c)).appendTo(t)[0];o.set({caret:s,element:a,before:e});e&&vn(s).addClass("mce-visual-caret-before");startBlink();i=a.ownerDocument.createRange();i.setStart(u,0);i.setEnd(u,0);return i};var hide=function(){trimInlineCaretContainers(t);if(u){remove$2(u);u=null}o.on((function(e){vn(e.caret).remove();o.clear()}));if(i){We.clearInterval(i);i=void 0}};var startBlink=function(){i=We.setInterval((function(){a()?vn("div.mce-visual-caret",t).toggleClass("mce-visual-caret-hidden"):vn("div.mce-visual-caret",t).addClass("mce-visual-caret-hidden")}),500)};var reposition=function(){o.on((function(e){var n=getAbsoluteClientRect(t,e.element,e.before);vn(e.caret).css(__assign({},n))}))};var destroy=function(){return We.clearInterval(i)};var getCss=function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"};return{show:show,hide:hide,getCss:getCss,reposition:reposition,destroy:destroy}};var isFakeCaretTableBrowser=function(){return Zn.isIE()||Zn.isEdge()||Zn.isFirefox()};var isInlineFakeCaretTarget=function(e){return ea(e)||ta(e)};var isFakeCaretTarget=function(e){return isInlineFakeCaretTarget(e)||isTable$3(e)&&isFakeCaretTableBrowser()};var aa=Be;var oa=Le;var ia=matchStyleValues("display","block table table-cell table-caption list-item");var ua=isCaretContainer$2;var ca=isCaretContainerBlock$1;var fa=Ee;var sa=isCaretCandidate$3;var isForwards=function(e){return e>0};var isBackwards=function(e){return e<0};var skipCaretContainers=function(e,t){var n;while(n=e(t))if(!ca(n))return n;return null};var findNode$1=function(e,t,n,a,o){var i=new Xe(e,a);var u=aa(e)||ca(e);if(isBackwards(t)){if(u){e=skipCaretContainers(i.prev.bind(i),true);if(n(e))return e}while(e=skipCaretContainers(i.prev.bind(i),o))if(n(e))return e}if(isForwards(t)){if(u){e=skipCaretContainers(i.next.bind(i),true);if(n(e))return e}while(e=skipCaretContainers(i.next.bind(i),o))if(n(e))return e}return null};var getParentBlock$2=function(e,t){while(e&&e!==t){if(ia(e))return e;e=e.parentNode}return null};var isInSameBlock=function(e,t,n){return getParentBlock$2(e.container(),n)===getParentBlock$2(t.container(),n)};var getChildNodeAtRelativeOffset=function(e,t){if(!t)return null;var n=t.container();var a=t.offset();return fa(n)?n.childNodes[a+e]:null};var beforeAfter=function(e,t){var n=t.ownerDocument.createRange();if(e){n.setStartBefore(t);n.setEndBefore(t)}else{n.setStartAfter(t);n.setEndAfter(t)}return n};var isNodesInSameBlock=function(e,t,n){return getParentBlock$2(t,e)===getParentBlock$2(n,e)};var lean=function(e,t,n){var a=e?"previousSibling":"nextSibling";while(n&&n!==t){var o=n[a];ua(o)&&(o=o[a]);if(aa(o)||oa(o)){if(isNodesInSameBlock(t,o,n))return o;break}if(sa(o))break;n=n.parentNode}return null};var la=curry(beforeAfter,true);var va=curry(beforeAfter,false);var normalizeRange=function(e,t,n){var a;var o=curry(lean,true,t);var i=curry(lean,false,t);var u=n.startContainer;var c=n.startOffset;if(isCaretContainerBlock$1(u)){fa(u)||(u=u.parentNode);var f=u.getAttribute("data-mce-caret");if("before"===f){a=u.nextSibling;if(isFakeCaretTarget(a))return la(a)}if("after"===f){a=u.previousSibling;if(isFakeCaretTarget(a))return va(a)}}if(!n.collapsed)return n;if(Ne(u)){if(ua(u)){if(1===e){a=i(u);if(a)return la(a);a=o(u);if(a)return va(a)}if(-1===e){a=o(u);if(a)return va(a);a=i(u);if(a)return la(a)}return n}if(endsWithCaretContainer$1(u)&&c>=u.data.length-1){if(1===e){a=i(u);if(a)return la(a)}return n}if(startsWithCaretContainer$1(u)&&c<=1){if(-1===e){a=o(u);if(a)return va(a)}return n}if(c===u.data.length){a=i(u);return a?la(a):n}if(0===c){a=o(u);return a?va(a):n}}return n};var getRelativeCefElm=function(e,t){return b.from(getChildNodeAtRelativeOffset(e?0:-1,t)).filter(aa)};var getNormalizedRangeEndPoint=function(e,t,n){var a=normalizeRange(e,t,n);return-1===e?CaretPosition.fromRangeStart(a):CaretPosition.fromRangeEnd(a)};var getElementFromPosition=function(e){return b.from(e.getNode()).map(se.fromDom)};var getElementFromPrevPosition=function(e){return b.from(e.getNode(true)).map(se.fromDom)};var getVisualCaretPosition=function(e,t){while(t=e(t))if(t.isVisible())return t;return t};var isMoveInsideSameBlock=function(e,t){var n=isInSameBlock(e,t);return!(n||!De(e.getNode()))||n};var da;(function(e){e[e.Backwards=-1]="Backwards";e[e.Forwards=1]="Forwards"})(da||(da={}));var ma=Be;var ga=Ne;var pa=Ee;var ha=De;var ba=isCaretCandidate$3;var ya=isAtomic$1;var Ca=isEditableCaretCandidate$1;var getParents$3=function(e,t){var n=[];while(e&&e!==t){n.push(e);e=e.parentNode}return n};var nodeAtIndex=function(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null};var getCaretCandidatePosition=function(e,t){if(isForwards(e)){if(ba(t.previousSibling)&&!ga(t.previousSibling))return CaretPosition.before(t);if(ga(t))return CaretPosition(t,0)}if(isBackwards(e)){if(ba(t.nextSibling)&&!ga(t.nextSibling))return CaretPosition.after(t);if(ga(t))return CaretPosition(t,t.data.length)}return isBackwards(e)?ha(t)?CaretPosition.before(t):CaretPosition.after(t):CaretPosition.before(t)};var moveForwardFromBr=function(e,t){var n=t.nextSibling;return n&&ba(n)?ga(n)?CaretPosition(n,0):CaretPosition.before(n):findCaretPosition$1(da.Forwards,CaretPosition.after(t),e)};var findCaretPosition$1=function(e,t,n){var a;var o;var i;var u;if(!pa(n)||!t)return null;if(t.isEqual(CaretPosition.after(n))&&n.lastChild){u=CaretPosition.after(n.lastChild);if(isBackwards(e)&&ba(n.lastChild)&&pa(n.lastChild))return ha(n.lastChild)?CaretPosition.before(n.lastChild):u}else u=t;var c=u.container();var f=u.offset();if(ga(c)){if(isBackwards(e)&&f>0)return CaretPosition(c,--f);if(isForwards(e)&&f<c.length)return CaretPosition(c,++f);a=c}else{if(isBackwards(e)&&f>0){o=nodeAtIndex(c,f-1);if(ba(o)){if(!ya(o)){i=findNode$1(o,e,Ca,o);if(i)return ga(i)?CaretPosition(i,i.data.length):CaretPosition.after(i)}return ga(o)?CaretPosition(o,o.data.length):CaretPosition.before(o)}}if(isForwards(e)&&f<c.childNodes.length){o=nodeAtIndex(c,f);if(ba(o)){if(ha(o))return moveForwardFromBr(n,o);if(!ya(o)){i=findNode$1(o,e,Ca,o);if(i)return ga(i)?CaretPosition(i,0):CaretPosition.before(i)}return ga(o)?CaretPosition(o,0):CaretPosition.after(o)}}a=o||u.getNode()}if(isForwards(e)&&u.isAtEnd()||isBackwards(e)&&u.isAtStart()){a=findNode$1(a,e,p,n,true);if(Ca(a,n))return getCaretCandidatePosition(e,a)}o=findNode$1(a,e,Ca,n);var s=last$1(filter$4(getParents$3(c,n),ma));if(s&&(!o||!s.contains(o))){u=isForwards(e)?CaretPosition.after(s):CaretPosition.before(s);return u}return o?getCaretCandidatePosition(e,o):null};var CaretWalker=function(e){return{next:function(t){return findCaretPosition$1(da.Forwards,t,e)},prev:function(t){return findCaretPosition$1(da.Backwards,t,e)}}};var walkToPositionIn=function(e,t,n){var a=e?CaretPosition.before(n):CaretPosition.after(n);return fromPosition(e,t,a)};var afterElement=function(e){return De(e)?CaretPosition.before(e):CaretPosition.after(e)};var isBeforeOrStart=function(e){return CaretPosition.isTextPosition(e)?0===e.offset():isCaretCandidate$3(e.getNode())};var isAfterOrEnd=function(e){if(CaretPosition.isTextPosition(e)){var t=e.container();return e.offset()===t.data.length}return isCaretCandidate$3(e.getNode(true))};var isBeforeAfterSameElement=function(e,t){return!CaretPosition.isTextPosition(e)&&!CaretPosition.isTextPosition(t)&&e.getNode()===t.getNode(true)};var isAtBr=function(e){return!CaretPosition.isTextPosition(e)&&De(e.getNode())};var shouldSkipPosition=function(e,t,n){return e?!isBeforeAfterSameElement(t,n)&&!isAtBr(t)&&isAfterOrEnd(t)&&isBeforeOrStart(n):!isBeforeAfterSameElement(n,t)&&isBeforeOrStart(t)&&isAfterOrEnd(n)};var fromPosition=function(e,t,n){var a=CaretWalker(t);return b.from(e?a.next(n):a.prev(n))};var navigate=function(e,t,n){return fromPosition(e,t,n).bind((function(a){return isInSameBlock(n,a,t)&&shouldSkipPosition(e,n,a)?fromPosition(e,t,a):b.some(a)}))};var navigateIgnore=function(e,t,n,a){return navigate(e,t,n).bind((function(n){return a(n)?navigateIgnore(e,t,n,a):b.some(n)}))};var positionIn=function(e,t){var n=e?t.firstChild:t.lastChild;return Ne(n)?b.some(CaretPosition(n,e?0:n.data.length)):n?isCaretCandidate$3(n)?b.some(e?CaretPosition.before(n):afterElement(n)):walkToPositionIn(e,t,n):b.none()};var wa=curry(fromPosition,true);var xa=curry(fromPosition,false);var Sa=curry(positionIn,true);var Ea=curry(positionIn,false);var ka="_mce_caret";var isCaretNode=function(e){return Ee(e)&&e.id===ka};var getParentCaretContainer=function(e,t){while(t&&t!==e){if(t.id===ka)return t;t=t.parentNode}return null};var isStringPathBookmark=function(e){return u(e.start)};var isRangeBookmark=function(e){return has$2(e,"rng")};var isIdBookmark=function(e){return has$2(e,"id")};var isIndexBookmark=function(e){return has$2(e,"name")};var isPathBookmark=function(e){return fe.isArray(e.start)};var addBogus=function(e,t){Ee(t)&&e.isBlock(t)&&!t.innerHTML&&!ie.ie&&(t.innerHTML='<br data-mce-bogus="1" />');return t};var resolveCaretPositionBookmark=function(e,t){var n;var a=e.createRng();n=resolve$2(e.getRoot(),t.start);a.setStart(n.container(),n.offset());n=resolve$2(e.getRoot(),t.end);a.setEnd(n.container(),n.offset());return a};var insertZwsp=function(e,t){var n=e.ownerDocument.createTextNode(dt);e.appendChild(n);t.setStart(n,0);t.setEnd(n,0)};var isEmpty$1=function(e){return false===e.hasChildNodes()};var tryFindRangePosition=function(e,t){return Ea(e).fold(g,(function(e){t.setStart(e.container(),e.offset());t.setEnd(e.container(),e.offset());return true}))};var padEmptyCaretContainer=function(e,t,n){if(isEmpty$1(t)&&getParentCaretContainer(e,t)){insertZwsp(t,n);return true}return false};var setEndPoint=function(e,t,n,a){var o=n[t?"start":"end"];var i,u,c,f;var s=e.getRoot();if(o){c=o[0];for(u=s,i=o.length-1;i>=1;i--){f=u.childNodes;if(padEmptyCaretContainer(s,u,a))return true;if(o[i]>f.length-1)return!!padEmptyCaretContainer(s,u,a)||tryFindRangePosition(u,a);u=f[o[i]]}3===u.nodeType&&(c=Math.min(o[0],u.nodeValue.length));1===u.nodeType&&(c=Math.min(o[0],u.childNodes.length));t?a.setStart(u,c):a.setEnd(u,c)}return true};var isValidTextNode=function(e){return Ne(e)&&e.data.length>0};var restoreEndPoint=function(e,t,n){var a,o,i,u,c=e.get(n.id+"_"+t);var f=n.keep;var s,l;if(c){a=c.parentNode;if("start"===t){if(f)if(c.hasChildNodes()){a=c.firstChild;o=1}else if(isValidTextNode(c.nextSibling)){a=c.nextSibling;o=0}else if(isValidTextNode(c.previousSibling)){a=c.previousSibling;o=c.previousSibling.data.length}else{a=c.parentNode;o=e.nodeIndex(c)+1}else o=e.nodeIndex(c);s=a;l=o}else{if(f)if(c.hasChildNodes()){a=c.firstChild;o=1}else if(isValidTextNode(c.previousSibling)){a=c.previousSibling;o=c.previousSibling.data.length}else{a=c.parentNode;o=e.nodeIndex(c)}else o=e.nodeIndex(c);s=a;l=o}if(!f){u=c.previousSibling;i=c.nextSibling;fe.each(fe.grep(c.childNodes),(function(e){Ne(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))}));while(c=e.get(n.id+"_"+t))e.remove(c,true);if(u&&i&&u.nodeType===i.nodeType&&Ne(u)&&!ie.opera){o=u.nodeValue.length;u.appendData(i.nodeValue);e.remove(i);s=u;l=o}}return b.some(CaretPosition(s,l))}return b.none()};var resolvePaths=function(e,t){var n=e.createRng();return setEndPoint(e,true,t,n)&&setEndPoint(e,false,t,n)?b.some(n):b.none()};var resolveId=function(e,t){var n=restoreEndPoint(e,"start",t);var a=restoreEndPoint(e,"end",t);return lift2(n,a.or(n),(function(t,n){var a=e.createRng();a.setStart(addBogus(e,t.container()),t.offset());a.setEnd(addBogus(e,n.container()),n.offset());return a}))};var resolveIndex=function(e,t){return b.from(e.select(t.name)[t.index]).map((function(t){var n=e.createRng();n.selectNode(t);return n}))};var resolve$1=function(e,t){var n=e.dom;if(t){if(isPathBookmark(t))return resolvePaths(n,t);if(isStringPathBookmark(t))return b.some(resolveCaretPositionBookmark(n,t));if(isIdBookmark(t))return resolveId(n,t);if(isIndexBookmark(t))return resolveIndex(n,t);if(isRangeBookmark(t))return b.some(t.rng)}return b.none()};var getBookmark$1=function(e,t,n){return getBookmark$2(e,t,n)};var moveToBookmark=function(e,t){resolve$1(e,t).each((function(t){e.setRng(t)}))};var isBookmarkNode$1=function(e){return Ee(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")};var is=function(e){return function(t){return e===t}};var Na=is(vt);var isWhiteSpace=function(e){return""!==e&&-1!==" \f\n\r\t\v".indexOf(e)};var isContent=function(e){return!isWhiteSpace(e)&&!Na(e)};var isNode=function(e){return!!e.nodeType};var isInlineBlock=function(e){return e&&/^(IMG)$/.test(e.nodeName)};var moveStart=function(e,t,n){var a=n.startOffset;var o=n.startContainer;if((o!==n.endContainer||!isInlineBlock(o.childNodes[a]))&&Ee(o)){var i=o.childNodes;var u=void 0;if(a<i.length){o=i[a];u=new Xe(o,e.getParent(o,e.isBlock))}else{o=i[i.length-1];u=new Xe(o,e.getParent(o,e.isBlock));u.next(true)}for(var c=u.current();c;c=u.next())if(Ne(c)&&!isWhiteSpaceNode$1(c)){n.setStart(c,0);t.setRng(n);return}}};var getNonWhiteSpaceSibling=function(e,t,n){if(e){var a=t?"nextSibling":"previousSibling";for(e=n?e:e[a];e;e=e[a])if(Ee(e)||!isWhiteSpaceNode$1(e))return e}};var isTextBlock$1=function(e,t){isNode(t)&&(t=t.nodeName);return!!e.schema.getTextBlockElements()[t.toLowerCase()]};var isValid=function(e,t,n){return e.schema.isValidChild(t,n)};var isWhiteSpaceNode$1=function(e,t){void 0===t&&(t=false);if(isNonNullable(e)&&Ne(e)){var n=t?e.data.replace(/ /g," "):e.data;return isWhitespaceText(n)}return false};var isEmptyTextNode$1=function(e){return isNonNullable(e)&&Ne(e)&&0===e.length};var replaceVars=function(e,t){d(e)?e=e(t):isNonNullable(t)&&(e=e.replace(/%(\w+)/g,(function(e,n){return t[n]||e})));return e};var isEq$5=function(e,t){e=e||"";t=t||"";e=""+(e.nodeName||e);t=""+(t.nodeName||t);return e.toLowerCase()===t.toLowerCase()};var normalizeStyleValue=function(e,t,n){"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t));"fontWeight"===n&&700===t&&(t="bold");"fontFamily"===n&&(t=t.replace(/[\'\"]/g,"").replace(/,\s+/g,","));return""+t};var getStyle=function(e,t,n){return normalizeStyleValue(e,e.getStyle(t,n),n)};var getTextDecoration=function(e,t){var n;e.getParent(t,(function(t){n=e.getStyle(t,"text-decoration");return n&&"none"!==n}));return n};var getParents$2=function(e,t,n){return e.getParents(t,n,e.getRoot())};var isVariableFormatName=function(e,t){var hasVariableValues=function(e){var isVariableValue=function(e){return e.length>1&&"%"===e.charAt(0)};return exists(["styles","attributes"],(function(t){return get$9(e,t).exists((function(e){var t=f(e)?e:values(e);return exists(t,isVariableValue)}))}))};return exists(e.formatter.get(t),hasVariableValues)};var areSimilarFormats=function(e,t,n){var a=["inline","block","selector","attributes","styles","classes"];var filterObj=function(e){return filter$3(e,(function(e,t){return exists(a,(function(e){return e===t}))}))};return exists(e.formatter.get(t),(function(t){var a=filterObj(t);return exists(e.formatter.get(n),(function(e){var t=filterObj(e);return equal$1(a,t)}))}))};var isBlockFormat=function(e){return hasNonNullableKey(e,"block")};var isSelectorFormat=function(e){return hasNonNullableKey(e,"selector")};var isInlineFormat=function(e){return hasNonNullableKey(e,"inline")};var isMixedFormat=function(e){return isSelectorFormat(e)&&isInlineFormat(e)&&is$1(get$9(e,"mixed"),true)};var shouldExpandToSelector=function(e){return isSelectorFormat(e)&&false!==e.expand&&!isInlineFormat(e)};var _a=isBookmarkNode$1;var Aa=getParents$2;var Ra=isWhiteSpaceNode$1;var Da=isTextBlock$1;var isBogusBr=function(e){return De(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling};var findParentContentEditable=function(e,t){var n=t;while(n){if(Ee(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t};var walkText=function(e,t,n,a){var o=t.data;for(var i=n;e?i>=0:i<o.length;e?i--:i++)if(a(o.charAt(i)))return e?i+1:i;return-1};var findSpace=function(e,t,n){return walkText(e,t,n,(function(e){return Na(e)||isWhiteSpace(e)}))};var findContent=function(e,t,n){return walkText(e,t,n,isContent)};var findWordEndPoint=function(e,t,n,a,o,i){var u;var c=e.getParent(n,e.isBlock)||t;var walk=function(t,n,a){var i=TextSeeker(e);var f=o?i.backwards:i.forwards;return b.from(f(t,n,(function(e,t){if(_a(e.parentNode))return-1;u=e;return a(o,e,t)}),c))};var f=walk(n,a,findSpace);return f.bind((function(e){return i?walk(e.container,e.offset+(o?-1:0),findContent):b.some(e)})).orThunk((function(){return u?b.some({container:u,offset:o?0:u.length}):b.none()}))};var findSelectorEndPoint=function(e,t,n,a,o){Ne(a)&&isEmpty$3(a.data)&&a[o]&&(a=a[o]);var i=Aa(e,a);for(var u=0;u<i.length;u++)for(var c=0;c<t.length;c++){var f=t[c];if((!isNonNullable(f.collapsed)||f.collapsed===n.collapsed)&&(isSelectorFormat(f)&&e.is(i[u],f.selector)))return i[u]}return a};var findBlockEndPoint=function(e,t,n,a){var o=n;var i=e.dom;var u=i.getRoot();var c=t[0];isBlockFormat(c)&&(o=c.wrapper?null:i.getParent(n,c.block,u));if(!o){var f=i.getParent(n,"LI,TD,TH");o=i.getParent(Ne(n)?n.parentNode:n,(function(t){return t!==u&&Da(e,t)}),f)}o&&isBlockFormat(c)&&c.wrapper&&(o=Aa(i,o,"ul,ol").reverse()[0]||o);if(!o){o=n;while(o[a]&&!i.isBlock(o[a])){o=o[a];if(isEq$5(o,"br"))break}}return o||n};var isAtBlockBoundary$1=function(e,t,n,a){var o=n.parentNode;return!isNonNullable(n[a])&&(!(o!==t&&!isNullable(o)&&!e.isBlock(o))||isAtBlockBoundary$1(e,t,o,a))};var findParentContainer=function(e,t,n,a,o){var i=n;var u=o?"previousSibling":"nextSibling";var c=e.getRoot();if(Ne(n)&&!Ra(n)&&(o?a>0:a<n.data.length))return n;while(true){if(!t[0].block_expand&&e.isBlock(i))return i;for(var f=i[u];f;f=f[u]){var s=Ne(f)&&!isAtBlockBoundary$1(e,c,f,u);if(!_a(f)&&!isBogusBr(f)&&!Ra(f,s))return i}if(i===c||i.parentNode===c){n=i;break}i=i.parentNode}return n};var isSelfOrParentBookmark=function(e){return _a(e.parentNode)||_a(e)};var expandRng=function(e,t,n,a){void 0===a&&(a=false);var o=t.startContainer,i=t.startOffset,u=t.endContainer,c=t.endOffset;var f=e.dom;var s=n[0];if(Ee(o)&&o.hasChildNodes()){o=getNode$1(o,i);Ne(o)&&(i=0)}if(Ee(u)&&u.hasChildNodes()){u=getNode$1(u,t.collapsed?c:c-1);Ne(u)&&(c=u.nodeValue.length)}o=findParentContentEditable(f,o);u=findParentContentEditable(f,u);if(isSelfOrParentBookmark(o)){o=_a(o)?o:o.parentNode;o=t.collapsed?o.previousSibling||o:o.nextSibling||o;Ne(o)&&(i=t.collapsed?o.length:0)}if(isSelfOrParentBookmark(u)){u=_a(u)?u:u.parentNode;u=t.collapsed?u.nextSibling||u:u.previousSibling||u;Ne(u)&&(c=t.collapsed?0:u.length)}if(t.collapsed){var l=findWordEndPoint(f,e.getBody(),o,i,true,a);l.each((function(e){var t=e.container,n=e.offset;o=t;i=n}));var v=findWordEndPoint(f,e.getBody(),u,c,false,a);v.each((function(e){var t=e.container,n=e.offset;u=t;c=n}))}if(isInlineFormat(s)||s.block_expand){isInlineFormat(s)&&Ne(o)&&0!==i||(o=findParentContainer(f,n,o,i,true));isInlineFormat(s)&&Ne(u)&&c!==u.nodeValue.length||(u=findParentContainer(f,n,u,c,false))}if(shouldExpandToSelector(s)){o=findSelectorEndPoint(f,n,t,o,"previousSibling");u=findSelectorEndPoint(f,n,t,u,"nextSibling")}if(isBlockFormat(s)||isSelectorFormat(s)){o=findBlockEndPoint(e,n,o,"previousSibling");u=findBlockEndPoint(e,n,u,"nextSibling");if(isBlockFormat(s)){f.isBlock(o)||(o=findParentContainer(f,n,o,i,true));f.isBlock(u)||(u=findParentContainer(f,n,u,c,false))}}if(Ee(o)){i=f.nodeIndex(o);o=o.parentNode}if(Ee(u)){c=f.nodeIndex(u)+1;u=u.parentNode}return{startContainer:o,startOffset:i,endContainer:u,endOffset:c}};var walk$2=function(e,t,n){var a=t.startOffset;var o=getNode$1(t.startContainer,a);var i=t.endOffset;var u=getNode$1(t.endContainer,i-1);var exclude=function(e){var t=e[0];Ne(t)&&t===o&&a>=t.data.length&&e.splice(0,1);var n=e[e.length-1];0===i&&e.length>0&&n===u&&Ne(n)&&e.splice(e.length-1,1);return e};var collectSiblings=function(e,t,n){var a=[];for(;e&&e!==n;e=e[t])a.push(e);return a};var findEndPoint=function(t,n){return e.getParent(t,(function(e){return e.parentNode===n}),n)};var walkBoundary=function(e,t,a){var o=a?"nextSibling":"previousSibling";for(var i=e,u=i.parentNode;i&&i!==t;i=u){u=i.parentNode;var c=collectSiblings(i===e?i:i[o],o);if(c.length){a||c.reverse();n(exclude(c))}}};if(o===u)return n(exclude([o]));var c=e.findCommonAncestor(o,u);if(e.isChildOf(o,u))return walkBoundary(o,c,true);if(e.isChildOf(u,o))return walkBoundary(u,c);var f=findEndPoint(o,c)||o;var s=findEndPoint(u,c)||u;walkBoundary(o,f,true);var l=collectSiblings(f===o?f:f.nextSibling,"nextSibling",s===u?s.nextSibling:s);l.length&&n(exclude(l));walkBoundary(u,s)};var getRanges=function(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t};var getSelectedNodes=function(e){return bind(e,(function(e){var t=getSelectedNode(e);return t?[se.fromDom(t)]:[]}))};var hasMultipleRanges=function(e){return getRanges(e).length>1};var getCellsFromRanges=function(e){return filter$4(getSelectedNodes(e),ft)};var getCellsFromElement=function(e){return descendants(e,"td[data-mce-selected],th[data-mce-selected]")};var getCellsFromElementOrRanges=function(e,t){var n=getCellsFromElement(t);return n.length>0?n:getCellsFromRanges(e)};var getCellsFromEditor=function(e){return getCellsFromElementOrRanges(getRanges(e.selection.getSel()),se.fromDom(e.getBody()))};var getClosestTable=function(e,t){return ancestor$2(e,"table",t)};var getStartNode=function(e){var t=e.startContainer,n=e.startOffset;return Ne(t)?0===n?b.some(se.fromDom(t)):b.none():b.from(t.childNodes[n]).map(se.fromDom)};var getEndNode=function(e){var t=e.endContainer,n=e.endOffset;return Ne(t)?n===t.data.length?b.some(se.fromDom(t)):b.none():b.from(t.childNodes[n-1]).map(se.fromDom)};var getFirstChildren=function(e){return firstChild(e).fold(constant([e]),(function(t){return[e].concat(getFirstChildren(t))}))};var getLastChildren$1=function(e){return lastChild(e).fold(constant([e]),(function(t){return"br"===name(t)?prevSibling(t).map((function(t){return[e].concat(getLastChildren$1(t))})).getOr([]):[e].concat(getLastChildren$1(t))}))};var hasAllContentsSelected=function(e,t){return lift2(getStartNode(t),getEndNode(t),(function(t,n){var a=find$3(getFirstChildren(e),curry(eq,t));var o=find$3(getLastChildren$1(e),curry(eq,n));return a.isSome()&&o.isSome()})).getOr(false)};var moveEndPoint=function(e,t,n,a){var o=n,i=new Xe(n,o);var u=filter$3(e.schema.getMoveCaretBeforeOnEnterElements(),(function(e,t){return!contains$3(["td","th","table"],t.toLowerCase())}));do{if(Ne(n)&&0!==fe.trim(n.nodeValue).length){a?t.setStart(n,0):t.setEnd(n,n.nodeValue.length);return}if(u[n.nodeName]){a?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n);return}}while(n=a?i.next():i.prev());"BODY"===o.nodeName&&(a?t.setStart(o,0):t.setEnd(o,o.childNodes.length))};var hasAnyRanges=function(e){var t=e.selection.getSel();return t&&t.rangeCount>0};var runOnRanges=function(e,t){var n=getCellsFromEditor(e);n.length>0?each$k(n,(function(n){var a=n.dom;var o=e.dom.createRng();o.setStartBefore(a);o.setEndAfter(a);t(o,true)})):t(e.selection.getRng(),false)};var preserve=function(e,t,n){var a=getPersistentBookmark(e,t);n(a);e.moveToBookmark(a)};var NodeValue=function(e,t){var get=function(n){if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return getOption(n).getOr("")};var getOption=function(t){return e(t)?b.from(t.dom.nodeValue):b.none()};var set=function(n,a){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=a};return{get:get,getOption:getOption,set:set}};var Ta=NodeValue(he,"text");var get$2=function(e){return Ta.get(e)};var isZeroWidth=function(e){return he(e)&&get$2(e)===dt};var context=function(e,t,n,a){return parent(t).fold((function(){return"skipping"}),(function(o){return"br"===a||isZeroWidth(t)?"valid":isAnnotation(t)?"existing":isCaretNode(t.dom)?"caret":isValid(e,n,a)&&isValid(e,name(o),n)?"valid":"invalid-child"}))};var applyWordGrab=function(e,t){var n=expandRng(e,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset);t.setEnd(n.endContainer,n.endOffset);e.selection.setRng(t)};var makeAnnotation=function(e,t,n,a){var o=t.uid,i=void 0===o?generate("mce-annotation"):o,u=__rest(t,["uid"]);var c=se.fromTag("span",e);add$1(c,An());set$1(c,""+Dn(),i);set$1(c,""+Rn(),n);var f=a(i,u),s=f.attributes,l=void 0===s?{}:s,v=f.classes,d=void 0===v?[]:v;setAll$1(c,l);add(c,d);return c};var annotate=function(e,t,n,a,o){var i=[];var u=makeAnnotation(e.getDoc(),o,n,a);var c=value();var finishWrapper=function(){c.clear()};var getOrOpenWrapper=function(){return c.get().getOrThunk((function(){var e=shallow(u);i.push(e);c.set(e);return e}))};var processElements=function(e){each$k(e,processElement)};var processElement=function(t){var n=context(e,t,"span",name(t));switch(n){case"invalid-child":finishWrapper();var a=children(t);processElements(a);finishWrapper();break;case"valid":var o=getOrOpenWrapper();wrap$3(t,o);break}};var processNodes=function(e){var t=map$3(e,se.fromDom);processElements(t)};walk$2(e.dom,t,(function(e){finishWrapper();processNodes(e)}));return i};var annotateWithBookmark=function(e,t,n,a){e.undoManager.transact((function(){var o=e.selection;var i=o.getRng();var u=getCellsFromEditor(e).length>0;i.collapsed&&!u&&applyWordGrab(e,i);if(o.getRng().collapsed&&!u){var c=makeAnnotation(e.getDoc(),a,t,n.decorate);set(c,vt);o.getRng().insertNode(c.dom);o.select(c.dom)}else preserve(o,false,(function(){runOnRanges(e,(function(o){annotate(e,o,t,n.decorate,a)}))}))}))};var Annotator=function(e){var t=create$7();setup$m(e,t);var n=setup$n(e);return{register:function(e,n){t.register(e,n)},annotate:function(n,a){t.lookup(n).each((function(t){annotateWithBookmark(e,n,t,a)}))},annotationChanged:function(e,t){n.addListener(e,t)},remove:function(t){identify(e,b.some(t)).each((function(e){var t=e.elements;each$k(t,unwrap)}))},getAll:function(t){var n=findAll(e,t);return map$2(n,(function(e){return map$3(e,(function(e){return e.dom}))}))}}};var BookmarkManager=function(e){return{getBookmark:curry(getBookmark$1,e),moveToBookmark:curry(moveToBookmark,e)}};BookmarkManager.isBookmarkNode=isBookmarkNode$1;var getContentEditableRoot$1=function(e,t){while(t&&t!==e){if(Oe(t)||Be(t))return t;t=t.parentNode}return null};var isXYWithinRange=function(e,t,n){if(n.collapsed)return false;if(ie.browser.isIE()&&n.startOffset===n.endOffset-1&&n.startContainer===n.endContainer){var a=n.startContainer.childNodes[n.startOffset];if(Ee(a))return exists(a.getClientRects(),(function(n){return containsXY(n,e,t)}))}return exists(n.getClientRects(),(function(n){return containsXY(n,e,t)}))};var firePreProcess=function(e,t){return e.fire("PreProcess",t)};var firePostProcess=function(e,t){return e.fire("PostProcess",t)};var fireRemove=function(e){return e.fire("remove")};var fireDetach=function(e){return e.fire("detach")};var fireSwitchMode=function(e,t){return e.fire("SwitchMode",{mode:t})};var fireObjectResizeStart=function(e,t,n,a,o){e.fire("ObjectResizeStart",{target:t,width:n,height:a,origin:o})};var fireObjectResized=function(e,t,n,a,o){e.fire("ObjectResized",{target:t,width:n,height:a,origin:o})};var firePreInit=function(e){return e.fire("PreInit")};var firePostRender=function(e){return e.fire("PostRender")};var fireInit=function(e){return e.fire("Init")};var firePlaceholderToggle=function(e,t){return e.fire("PlaceholderToggle",{state:t})};var fireError=function(e,t,n){return e.fire(t,n)};var fireFormatApply=function(e,t,n,a){return e.fire("FormatApply",{format:t,node:n,vars:a})};var fireFormatRemove=function(e,t,n,a){return e.fire("FormatRemove",{format:t,node:n,vars:a})};var Oa={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||Oa.metaKeyPressed(e)},metaKeyPressed:function(e){return ie.mac?e.metaKey:e.ctrlKey&&!e.altKey}};var Ba=Be;var ControlSelection=function(e,t){var n="data-mce-selected";var a=t.dom,o=fe.each;var i,u,c,f,s;var l,v,d,m,g,p,h,b;var y,C;var w=t.getDoc(),x=document;var S=Math.abs,E=Math.round,k=t.getBody();var N,_;var A={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var isImage=function(e){return e&&("IMG"===e.nodeName||t.dom.is(e,"figure.image"))};var isMedia=function(e){return Le(e)||a.hasClass(e,"mce-preview-object")};var isEventOnImageOutsideRange=function(e,t){if("longpress"===e.type||0===e.type.indexOf("touch")){var n=e.touches[0];return isImage(e.target)&&!isXYWithinRange(n.clientX,n.clientY,t)}return isImage(e.target)&&!isXYWithinRange(e.clientX,e.clientY,t)};var contextMenuSelectImage=function(e){var n=e.target;isEventOnImageOutsideRange(e,t.selection.getRng())&&!e.isDefaultPrevented()&&t.selection.select(n)};var getResizeTargets=function(e){return a.is(e,"figure.image")?[e.querySelector("img")]:a.hasClass(e,"mce-preview-object")&&isNonNullable(e.firstElementChild)?[e,e.firstElementChild]:[e]};var isResizable=function(e){var n=getObjectResizing(t);return!!n&&("false"!==e.getAttribute("data-mce-resize")&&(e!==t.getBody()&&(a.hasClass(e,"mce-preview-object")?is$2(se.fromDom(e.firstElementChild),n):is$2(se.fromDom(e),n))))};var createGhostElement=function(e){return isMedia(e)?a.create("img",{src:ie.transparentSrc}):e.cloneNode(true)};var setSizeProp=function(e,n,o){if(isNonNullable(o)){var i=getResizeTargets(e);each$k(i,(function(e){e.style[n]||!t.schema.isValid(e.nodeName.toLowerCase(),n)?a.setStyle(e,n,o):a.setAttrib(e,n,""+o)}))}};var setGhostElmSize=function(e,t,n){setSizeProp(e,"width",t);setSizeProp(e,"height",n)};var resizeGhostElement=function(e){var n,o,s;var w,x;n=e.screenX-l;o=e.screenY-v;y=n*f[2]+g;C=o*f[3]+p;y=y<5?5:y;C=C<5?5:C;s=(isImage(i)||isMedia(i))&&false!==getResizeImgProportional(t)?!Oa.modifierPressed(e):Oa.modifierPressed(e);if(s)if(S(n)>S(o)){C=E(y*h);y=E(C/h)}else{y=E(C/h);C=E(y*h)}setGhostElmSize(u,y,C);w=f.startPos.x+n;x=f.startPos.y+o;w=w>0?w:0;x=x>0?x:0;a.setStyles(c,{left:w,top:x,display:"block"});c.innerHTML=y+" &times; "+C;f[2]<0&&u.clientWidth<=y&&a.setStyle(u,"left",d+(g-y));f[3]<0&&u.clientHeight<=C&&a.setStyle(u,"top",m+(p-C));n=k.scrollWidth-N;o=k.scrollHeight-_;n+o!==0&&a.setStyles(c,{left:w-n,top:x-o});if(!b){fireObjectResizeStart(t,i,g,p,"corner-"+f.name);b=true}};var endGhostResize=function(){var e=b;b=false;if(e){setSizeProp(i,"width",y);setSizeProp(i,"height",C)}a.unbind(w,"mousemove",resizeGhostElement);a.unbind(w,"mouseup",endGhostResize);if(x!==w){a.unbind(x,"mousemove",resizeGhostElement);a.unbind(x,"mouseup",endGhostResize)}a.remove(u);a.remove(c);a.remove(s);showResizeRect(i);if(e){fireObjectResized(t,i,y,C,"corner-"+f.name);a.setAttrib(i,"style",a.getAttrib(i,"style"))}t.nodeChanged()};var showResizeRect=function(e){unbindResizeHandleEvents();var d=a.getPos(e,k);var m=d.x;var b=d.y;var S=e.getBoundingClientRect();var E=S.width||S.right-S.left;var R=S.height||S.bottom-S.top;if(i!==e){hideResizeRect();i=e;y=C=0}var D=t.fire("ObjectSelected",{target:e});var T=a.getAttrib(i,n,"1");isResizable(e)&&!D.isDefaultPrevented()?o(A,(function(e,t){var o;var startDrag=function(o){var d=getResizeTargets(i)[0];l=o.screenX;v=o.screenY;g=d.clientWidth;p=d.clientHeight;h=p/g;f=e;f.name=t;f.startPos={x:E*e[0]+m,y:R*e[1]+b};N=k.scrollWidth;_=k.scrollHeight;s=a.add(k,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"});a.setStyles(s,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"});u=createGhostElement(i);a.addClass(u,"mce-clonedresizable");a.setAttrib(u,"data-mce-bogus","all");u.contentEditable="false";a.setStyles(u,{left:m,top:b,margin:0});setGhostElmSize(u,E,R);u.removeAttribute(n);k.appendChild(u);a.bind(w,"mousemove",resizeGhostElement);a.bind(w,"mouseup",endGhostResize);if(x!==w){a.bind(x,"mousemove",resizeGhostElement);a.bind(x,"mouseup",endGhostResize)}c=a.add(k,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},g+" &times; "+p)};o=a.get("mceResizeHandle"+t);o&&a.remove(o);o=a.add(k,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:true,style:"cursor:"+t+"-resize; margin:0; padding:0"});11===ie.ie&&(o.contentEditable=false);a.bind(o,"mousedown",(function(e){e.stopImmediatePropagation();e.preventDefault();startDrag(e)}));e.elm=o;a.setStyles(o,{left:E*e[0]+m-o.offsetWidth/2,top:R*e[1]+b-o.offsetHeight/2})})):hideResizeRect();a.getAttrib(i,n)||i.setAttribute(n,T)};var hideResizeRect=function(){unbindResizeHandleEvents();i&&i.removeAttribute(n);each$j(A,(function(e,t){var n=a.get("mceResizeHandle"+t);if(n){a.unbind(n);a.remove(n)}}))};var updateResizeRect=function(i){var u,c;var isChildOrEqual=function(e,t){if(e)do{if(e===t)return true}while(e=e.parentNode)};if(!b&&!t.removed){o(a.select("img[data-mce-selected],hr[data-mce-selected]"),(function(e){e.removeAttribute(n)}));c="mousedown"===i.type?i.target:e.getNode();c=a.$(c).closest("table,img,figure.image,hr,video,span.mce-preview-object")[0];if(isChildOrEqual(c,k)){disableGeckoResize();u=e.getStart(true);if(isChildOrEqual(u,c)&&isChildOrEqual(e.getEnd(true),c)){showResizeRect(c);return}}hideResizeRect()}};var isWithinContentEditableFalse=function(e){return Ba(getContentEditableRoot$1(t.getBody(),e))};var unbindResizeHandleEvents=function(){each$j(A,(function(e){if(e.elm){a.unbind(e.elm);delete e.elm}}))};var disableGeckoResize=function(){try{t.getDoc().execCommand("enableObjectResizing",false,"false")}catch(e){}};t.on("init",(function(){disableGeckoResize();if(ie.browser.isIE()||ie.browser.isEdge()){t.on("mousedown click",(function(e){var n=e.target,a=n.nodeName;if(!b&&/^(TABLE|IMG|HR)$/.test(a)&&!isWithinContentEditableFalse(n)){2!==e.button&&t.selection.select(n,"TABLE"===a);"mousedown"===e.type&&t.nodeChanged()}}));var handleMSControlSelect_1=function(e){var delayedSelect=function(e){We.setEditorTimeout(t,(function(){return t.selection.select(e)}))};if(isWithinContentEditableFalse(e.target)||Le(e.target)){e.preventDefault();delayedSelect(e.target)}else if(/^(TABLE|IMG|HR)$/.test(e.target.nodeName)){e.preventDefault();"IMG"===e.target.tagName&&delayedSelect(e.target)}};a.bind(k,"mscontrolselect",handleMSControlSelect_1);t.on("remove",(function(){return a.unbind(k,"mscontrolselect",handleMSControlSelect_1)}))}var e=We.throttle((function(e){t.composing||updateResizeRect(e)}));t.on("nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged",e);t.on("keyup compositionend",(function(t){i&&"TABLE"===i.nodeName&&e(t)}));t.on("hide blur",hideResizeRect);t.on("contextmenu longpress",contextMenuSelectImage,true)}));t.on("remove",unbindResizeHandleEvents);var destroy=function(){i=u=s=null};return{isResizable:isResizable,showResizeRect:showResizeRect,hideResizeRect:hideResizeRect,updateResizeRect:updateResizeRect,destroy:destroy}};var hasCeProperty=function(e){return Oe(e)||Be(e)};var findParent$1=function(e,t,n){while(e&&e!==t){if(n(e))return e;e=e.parentNode}return null};var findClosestIeRange=function(e,t,n){var a;var o=n.elementFromPoint(e,t);var i=n.body.createTextRange();o&&"HTML"!==o.tagName||(o=n.body);i.moveToElementText(o);a=fe.toArray(i.getClientRects());a=a.sort((function(e,n){e=Math.abs(Math.max(e.top-t,e.bottom-t));n=Math.abs(Math.max(n.top-t,n.bottom-t));return e-n}));if(a.length>0){t=(a[0].bottom+a[0].top)/2;try{i.moveToPoint(e,t);i.collapse(true);return i}catch(e){}}return null};var moveOutOfContentEditableFalse=function(e,t){var n=e&&e.parentElement?e.parentElement():null;return Be(findParent$1(n,t,hasCeProperty))?null:e};var fromPoint=function(e,t,n){var a,o;var i=n;if(i.caretPositionFromPoint){o=i.caretPositionFromPoint(e,t);if(o){a=n.createRange();a.setStart(o.offsetNode,o.offset);a.collapse(true)}}else if(i.caretRangeFromPoint)a=i.caretRangeFromPoint(e,t);else if(i.body.createTextRange){a=i.body.createTextRange();try{a.moveToPoint(e,t);a.collapse(true)}catch(o){a=findClosestIeRange(e,t,n)}return moveOutOfContentEditableFalse(a,n.body)}return a};var isEq$4=function(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset};var findParent=function(e,t,n){while(e&&e!==t){if(n(e))return e;e=e.parentNode}return null};var hasParent$1=function(e,t,n){return null!==findParent(e,t,n)};var hasParentWithName=function(e,t,n){return hasParent$1(e,t,(function(e){return e.nodeName===n}))};var isTable=function(e){return e&&"TABLE"===e.nodeName};var isTableCell$2=function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)};var isCeFalseCaretContainer=function(e,t){return isCaretContainer$2(e)&&false===hasParent$1(e,t,isCaretNode)};var hasBrBeforeAfter=function(e,t,n){var a=new Xe(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());while(t=a[n?"prev":"next"]())if(De(t))return true};var isPrevNode=function(e,t){return e.previousSibling&&e.previousSibling.nodeName===t};var hasContentEditableFalseParent=function(e,t){while(t&&t!==e){if(Be(t))return true;t=t.parentNode}return false};var findTextNodeRelative=function(e,t,n,a,o){var i;var u=e.getRoot();var c;var f=e.schema.getNonEmptyElements();var s=e.getParent(o.parentNode,e.isBlock)||u;if(a&&De(o)&&t&&e.isEmpty(s))return b.some(CaretPosition(o.parentNode,e.nodeIndex(o)));var l=new Xe(o,s);while(c=l[a?"prev":"next"]()){if("false"===e.getContentEditableParent(c)||isCeFalseCaretContainer(c,u))return b.none();if(Ne(c)&&c.nodeValue.length>0)return false===hasParentWithName(c,u,"A")?b.some(CaretPosition(c,a?c.nodeValue.length:0)):b.none();if(e.isBlock(c)||f[c.nodeName.toLowerCase()])return b.none();i=c}return n&&i?b.some(CaretPosition(i,0)):b.none()};var normalizeEndPoint=function(e,t,n,a){var o,i;var u=e.getRoot();var c;var f,s=false;o=a[(n?"start":"end")+"Container"];i=a[(n?"start":"end")+"Offset"];var l=Ee(o)&&i===o.childNodes.length;var v=e.schema.getNonEmptyElements();f=n;if(isCaretContainer$2(o))return b.none();Ee(o)&&i>o.childNodes.length-1&&(f=false);if(Ae(o)){o=u;i=0}if(o===u){if(f){c=o.childNodes[i>0?i-1:0];if(c){if(isCaretContainer$2(c))return b.none();if(v[c.nodeName]||isTable(c))return b.none()}}if(o.hasChildNodes()){i=Math.min(!f&&i>0?i-1:i,o.childNodes.length-1);o=o.childNodes[i];i=Ne(o)&&l?o.data.length:0;if(!t&&o===u.lastChild&&isTable(o))return b.none();if(hasContentEditableFalseParent(u,o)||isCaretContainer$2(o))return b.none();if(o.hasChildNodes()&&false===isTable(o)){c=o;var d=new Xe(o,u);do{if(Be(c)||isCaretContainer$2(c)){s=false;break}if(Ne(c)&&c.nodeValue.length>0){i=f?0:c.nodeValue.length;o=c;s=true;break}if(v[c.nodeName.toLowerCase()]&&!isTableCell$2(c)){i=e.nodeIndex(c);o=c.parentNode;f||i++;s=true;break}}while(c=f?d.next():d.prev())}}}if(t){Ne(o)&&0===i&&findTextNodeRelative(e,l,t,true,o).each((function(e){o=e.container();i=e.offset();s=true}));if(Ee(o)){c=o.childNodes[i];c||(c=o.childNodes[i-1]);!c||!De(c)||isPrevNode(c,"A")||hasBrBeforeAfter(e,c,false)||hasBrBeforeAfter(e,c,true)||findTextNodeRelative(e,l,t,true,c).each((function(e){o=e.container();i=e.offset();s=true}))}}f&&!t&&Ne(o)&&i===o.nodeValue.length&&findTextNodeRelative(e,l,t,false,o).each((function(e){o=e.container();i=e.offset();s=true}));return s?b.some(CaretPosition(o,i)):b.none()};var normalize$2=function(e,t){var n=t.collapsed,a=t.cloneRange();var o=CaretPosition.fromRangeStart(t);normalizeEndPoint(e,n,true,a).each((function(e){n&&CaretPosition.isAbove(o,e)||a.setStart(e.container(),e.offset())}));n||normalizeEndPoint(e,n,false,a).each((function(e){a.setEnd(e.container(),e.offset())}));n&&a.collapse(true);return isEq$4(t,a)?b.none():b.some(a)};var splitText=function(e,t){return e.splitText(t)};var split=function(e){var t=e.startContainer,n=e.startOffset,a=e.endContainer,o=e.endOffset;if(t===a&&Ne(t)){if(n>0&&n<t.nodeValue.length){a=splitText(t,n);t=a.previousSibling;if(o>n){o-=n;t=a=splitText(a,o).previousSibling;o=a.nodeValue.length;n=0}else o=0}}else{if(Ne(t)&&n>0&&n<t.nodeValue.length){t=splitText(t,n);n=0}if(Ne(a)&&o>0&&o<a.nodeValue.length){a=splitText(a,o).previousSibling;o=a.nodeValue.length}}return{startContainer:t,startOffset:n,endContainer:a,endOffset:o}};var RangeUtils=function(e){var walk=function(t,n){return walk$2(e,t,n)};var t=split;var normalize=function(t){return normalize$2(e,t).fold(g,(function(e){t.setStart(e.startContainer,e.startOffset);t.setEnd(e.endContainer,e.endOffset);return true}))};return{walk:walk,split:t,normalize:normalize}};RangeUtils.compareRanges=isEq$4;RangeUtils.getCaretRangeFromPoint=fromPoint;RangeUtils.getSelectedNode=getSelectedNode;RangeUtils.getNode=getNode$1;var Dimension=function(e,t){var set=function(t,n){if(!m(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var a=t.dom;isSupported(a)&&(a.style[e]=n+"px")};var get=function(n){var a=t(n);if(a<=0||null===a){var o=get$5(n,e);return parseFloat(o)||0}return a};var n=get;var aggregate=function(e,t){return foldl(t,(function(t,n){var a=get$5(e,n);var o=void 0===a?0:parseInt(a,10);return isNaN(o)?t:t+o}),0)};var max=function(e,t,n){var a=aggregate(e,n);var o=t>a?t-a:0;return o};return{set:set,get:get,getOuter:n,aggregate:aggregate,max:max}};var Pa=Dimension("height",(function(e){var t=e.dom;return inBody(e)?t.getBoundingClientRect().height:t.offsetHeight}));var get$1=function(e){return Pa.get(e)};var walkUp=function(e,t){var n=e.view(t);return n.fold(constant([]),(function(t){var n=e.owner(t);var a=walkUp(e,n);return[t].concat(a)}))};var pathTo=function(e,t){var n=t.owner(e);return walkUp(t,n)};var view=function(e){var t;var n=e.dom===document?b.none():b.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement);return n.map(se.fromDom)};var owner=function(e){return documentOrOwner(e)};var La=Object.freeze({__proto__:null,view:view,owner:owner});var find$1=function(e){var t=se.fromDom(document);var n=get$8(t);var a=pathTo(e,La);var o=viewport(e);var i=foldr(a,(function(e,t){var n=viewport(t);return{left:e.left+n.left,top:e.top+n.top}}),{left:0,top:0});return Se(i.left+o.left+n.left,i.top+o.top+n.top)};var excludeFromDescend=function(e){return"textarea"===name(e)};var fireScrollIntoViewEvent=function(e,t){var n=e.fire("ScrollIntoView",t);return n.isDefaultPrevented()};var fireAfterScrollIntoViewEvent=function(e,t){e.fire("AfterScrollIntoView",t)};var descend=function(e,t){var n=children(e);if(0===n.length||excludeFromDescend(e))return{element:e,offset:t};if(t<n.length&&!excludeFromDescend(n[t]))return{element:n[t],offset:0};var a=n[n.length-1];return excludeFromDescend(a)?{element:e,offset:t}:"img"===name(a)?{element:a,offset:1}:he(a)?{element:a,offset:get$2(a).length}:{element:a,offset:children(a).length}};var markerInfo=function(e,t){var n=absolute(e);var a=get$1(e);return{element:e,bottom:n.top+a,height:a,pos:n,cleanup:t}};var createMarker=function(e,t){var n=descend(e,t);var a=se.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">'+dt+"</span>");before$4(n.element,a);return markerInfo(a,(function(){return remove$7(a)}))};var elementMarker=function(e){return markerInfo(se.fromDom(e),noop)};var withMarker=function(e,t,n,a){preserveWith(e,(function(o,i){return applyWithMarker(e,t,n,a)}),n)};var withScrollEvents=function(e,t,n,a,o){var i={elm:a.element.dom,alignToTop:o};if(!fireScrollIntoViewEvent(e,i)){var u=get$8(t).top;n(t,u,a,o);fireAfterScrollIntoViewEvent(e,i)}};var applyWithMarker=function(e,t,n,a){var o=se.fromDom(e.getBody());var i=se.fromDom(e.getDoc());reflow(o);var u=createMarker(se.fromDom(n.startContainer),n.startOffset);withScrollEvents(e,i,t,u,a);u.cleanup()};var withElement=function(e,t,n,a){var o=se.fromDom(e.getDoc());withScrollEvents(e,o,n,elementMarker(t),a)};var preserveWith=function(e,t,n){var a=n.startContainer;var o=n.startOffset;var i=n.endContainer;var u=n.endOffset;t(se.fromDom(a),se.fromDom(i));var c=e.dom.createRng();c.setStart(a,o);c.setEnd(i,u);e.selection.setRng(n)};var scrollToMarker=function(e,t,n,a){var o=e.pos;if(n)to(o.left,o.top,a);else{var i=o.top-t+e.height;to(o.left,i,a)}};var intoWindowIfNeeded=function(e,t,n,a,o){var i=n+t;var u=a.pos.top;var c=a.bottom;var f=c-u>=n;if(u<t)scrollToMarker(a,n,false!==o,e);else if(u>i){var s=f?false!==o:true===o;scrollToMarker(a,n,s,e)}else c>i&&!f&&scrollToMarker(a,n,true===o,e)};var intoWindow=function(e,t,n,a){var o=e.dom.defaultView.innerHeight;intoWindowIfNeeded(e,t,o,n,a)};var intoFrame=function(e,t,n,a){var o=e.dom.defaultView.innerHeight;intoWindowIfNeeded(e,t,o,n,a);var i=find$1(n.element);var u=getBounds(window);i.top<u.y?intoView(n.element,false!==a):i.top>u.bottom&&intoView(n.element,true===a)};var rangeIntoWindow=function(e,t,n){return withMarker(e,intoWindow,t,n)};var elementIntoWindow=function(e,t,n){return withElement(e,t,intoWindow,n)};var rangeIntoFrame=function(e,t,n){return withMarker(e,intoFrame,t,n)};var elementIntoFrame=function(e,t,n){return withElement(e,t,intoFrame,n)};var scrollElementIntoView=function(e,t,n){var a=e.inline?elementIntoWindow:elementIntoFrame;a(e,t,n)};var scrollRangeIntoView=function(e,t,n){var a=e.inline?rangeIntoWindow:rangeIntoFrame;a(e,t,n)};var getDocument=function(){return se.fromDom(document)};var focus$1=function(e){return e.dom.focus()};var hasFocus$1=function(e){var t=xe(e).dom;return e.dom===t.activeElement};var active=function(e){void 0===e&&(e=getDocument());return b.from(e.dom.activeElement).map(se.fromDom)};var search=function(e){return active(xe(e)).filter((function(t){return e.dom.contains(t.dom)}))};var create$5=function(e,t,n,a){return{start:e,soffset:t,finish:n,foffset:a}};var Ia={create:create$5};var Ma=Ve.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]);var cata=function(e,t,n,a){return e.fold(t,n,a)};var getStart$2=function(e){return e.fold(identity,identity,identity)};var Fa=Ma.before;var Ua=Ma.on;var za=Ma.after;var ja={before:Fa,on:Ua,after:za,cata:cata,getStart:getStart$2};var Ha=Ve.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]);var exactFromRange=function(e){return Ha.exact(e.start,e.soffset,e.finish,e.foffset)};var getStart$1=function(e){return e.match({domRange:function(e){return se.fromDom(e.startContainer)},relative:function(e,t){return ja.getStart(e)},exact:function(e,t,n,a){return e}})};var Va=Ha.domRange;var qa=Ha.relative;var $a=Ha.exact;var getWin=function(e){var t=getStart$1(e);return defaultView(t)};var Wa=Ia.create;var Ka={domRange:Va,relative:qa,exact:$a,exactFromRange:exactFromRange,getWin:getWin,range:Wa};var Xa=detect().browser;var clamp$1=function(e,t){var n=he(t)?get$2(t).length:children(t).length+1;return e>n?n:e<0?0:e};var normalizeRng=function(e){return Ka.range(e.start,clamp$1(e.soffset,e.start),e.finish,clamp$1(e.foffset,e.finish))};var isOrContains=function(e,t){return!isRestrictedNode(t.dom)&&(contains$1(e,t)||eq(e,t))};var isRngInRoot=function(e){return function(t){return isOrContains(e,t.start)&&isOrContains(e,t.finish)}};var shouldStore=function(e){return true===e.inline||Xa.isIE()};var nativeRangeToSelectionRange=function(e){return Ka.range(se.fromDom(e.startContainer),e.startOffset,se.fromDom(e.endContainer),e.endOffset)};var readRange=function(e){var t=e.getSelection();var n=t&&0!==t.rangeCount?b.from(t.getRangeAt(0)):b.none();return n.map(nativeRangeToSelectionRange)};var getBookmark=function(e){var t=defaultView(e);return readRange(t.dom).filter(isRngInRoot(e))};var validate=function(e,t){return b.from(t).filter(isRngInRoot(e)).map(normalizeRng)};var bookmarkToNativeRng=function(e){var t=document.createRange();try{t.setStart(e.start.dom,e.soffset);t.setEnd(e.finish.dom,e.foffset);return b.some(t)}catch(e){return b.none()}};var store=function(e){var t=shouldStore(e)?getBookmark(se.fromDom(e.getBody())):b.none();e.bookmark=t.isSome()?t:e.bookmark};var storeNative=function(e,t){var n=se.fromDom(e.getBody());var a=shouldStore(e)?b.from(t):b.none();var o=a.map(nativeRangeToSelectionRange).filter(isRngInRoot(n));e.bookmark=o.isSome()?o:e.bookmark};var getRng=function(e){var t=e.bookmark?e.bookmark:b.none();return t.bind((function(t){return validate(se.fromDom(e.getBody()),t)})).bind(bookmarkToNativeRng)};var restore=function(e){getRng(e).each((function(t){return e.selection.setRng(t)}))};var isEditorUIElement$1=function(e){var t=e.className.toString();return-1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")};var Ya={isEditorUIElement:isEditorUIElement$1};var isManualNodeChange=function(e){return"nodechange"===e.type&&e.selectionChange};var registerPageMouseUp=function(e,t){var mouseUpPage=function(){t.throttle()};DOMUtils.DOM.bind(document,"mouseup",mouseUpPage);e.on("remove",(function(){DOMUtils.DOM.unbind(document,"mouseup",mouseUpPage)}))};var registerFocusOut=function(e){e.on("focusout",(function(){store(e)}))};var registerMouseUp=function(e,t){e.on("mouseup touchend",(function(e){t.throttle()}))};var registerEditorEvents=function(e,t){var n=detect().browser;n.isIE()?registerFocusOut(e):registerMouseUp(e,t);e.on("keyup NodeChange",(function(t){isManualNodeChange(t)||store(e)}))};var register$3=function(e){var t=first((function(){store(e)}),0);e.on("init",(function(){e.inline&&registerPageMouseUp(e,t);registerEditorEvents(e,t)}));e.on("remove",(function(){t.cancel()}))};var Ga;var Ja=DOMUtils.DOM;var isEditorUIElement=function(e){return Ya.isEditorUIElement(e)};var isEditorContentAreaElement=function(e){var t=e.classList;return void 0!==t&&(t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"))};var isUIElement=function(e,t){var n=getCustomUiSelector(e);var a=Ja.getParent(t,(function(t){return isEditorUIElement(t)||!!n&&e.dom.is(t,n)}));return null!==a};var getActiveElement=function(e){try{var t=xe(se.fromDom(e.getElement()));return active(t).fold((function(){return document.body}),(function(e){return e.dom}))}catch(e){return document.body}};var registerEvents$1=function(e,t){var n=t.editor;register$3(n);n.on("focusin",(function(){var t=e.focusedEditor;if(t!==n){t&&t.fire("blur",{focusedEditor:n});e.setActive(n);e.focusedEditor=n;n.fire("focus",{blurredEditor:t});n.focus(true)}}));n.on("focusout",(function(){We.setEditorTimeout(n,(function(){var t=e.focusedEditor;if(!isUIElement(n,getActiveElement(n))&&t===n){n.fire("blur",{focusedEditor:null});e.focusedEditor=null}}))}));if(!Ga){Ga=function(t){var n=e.activeEditor;n&&getOriginalEventTarget(t).each((function(t){if(t.ownerDocument===document&&t!==document.body&&!isUIElement(n,t)&&e.focusedEditor===n){n.fire("blur",{focusedEditor:null});e.focusedEditor=null}}))};Ja.bind(document,"focusin",Ga)}};var unregisterDocumentEvents=function(e,t){e.focusedEditor===t.editor&&(e.focusedEditor=null);if(!e.activeEditor){Ja.unbind(document,"focusin",Ga);Ga=null}};var setup$l=function(e){e.on("AddEditor",curry(registerEvents$1,e));e.on("RemoveEditor",curry(unregisterDocumentEvents,e))};var getContentEditableHost=function(e,t){return e.dom.getParent(t,(function(t){return"true"===e.dom.getContentEditable(t)}))};var getCollapsedNode=function(e){return e.collapsed?b.from(getNode$1(e.startContainer,e.startOffset)).map(se.fromDom):b.none()};var getFocusInElement=function(e,t){return getCollapsedNode(t).bind((function(t){return ct(t)?b.some(t):false===contains$1(e,t)?b.some(e):b.none()}))};var normalizeSelection$1=function(e,t){getFocusInElement(se.fromDom(e.getBody()),t).bind((function(e){return Sa(e.dom)})).fold((function(){e.selection.normalize()}),(function(t){return e.selection.setRng(t.toRange())}))};var focusBody=function(e){if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()};var hasElementFocus=function(e){return hasFocus$1(e)||search(e).isSome()};var hasIframeFocus=function(e){return e.iframeElement&&hasFocus$1(se.fromDom(e.iframeElement))};var hasInlineFocus=function(e){var t=e.getBody();return t&&hasElementFocus(se.fromDom(t))};var hasUiFocus=function(e){var t=xe(se.fromDom(e.getElement()));return active(t).filter((function(t){return!isEditorContentAreaElement(t.dom)&&isUIElement(e,t.dom)})).isSome()};var hasFocus=function(e){return e.inline?hasInlineFocus(e):hasIframeFocus(e)};var hasEditorOrUiFocus=function(e){return hasFocus(e)||hasUiFocus(e)};var focusEditor=function(e){var t=e.selection;var n=e.getBody();var a=t.getRng();e.quirks.refreshContentEditable();void 0!==e.bookmark&&false===hasFocus(e)&&getRng(e).each((function(t){e.selection.setRng(t);a=t}));var o=getContentEditableHost(e,t.getNode());if(e.$.contains(n,o)){focusBody(o);normalizeSelection$1(e,a);activateEditor(e)}else{if(!e.inline){ie.opera||focusBody(n);e.getWin().focus()}if(ie.gecko||e.inline){focusBody(n);normalizeSelection$1(e,a)}activateEditor(e)}};var activateEditor=function(e){return e.editorManager.setActive(e)};var focus=function(e,t){e.removed||(t?activateEditor(e):focusEditor(e))};var getEndpointElement=function(e,t,n,a,o){var i=n?t.startContainer:t.endContainer;var u=n?t.startOffset:t.endOffset;return b.from(i).map(se.fromDom).map((function(e){return a&&t.collapsed?e:child$1(e,o(e,u)).getOr(e)})).bind((function(e){return pe(e)?b.some(e):parent(e).filter(pe)})).map((function(e){return e.dom})).getOr(e)};var getStart=function(e,t,n){return getEndpointElement(e,t,true,n,(function(e,t){return Math.min(childNodesCount(e),t)}))};var getEnd=function(e,t,n){return getEndpointElement(e,t,false,n,(function(e,t){return t>0?t-1:t}))};var skipEmptyTextNodes=function(e,t){var n=e;while(e&&Ne(e)&&0===e.length)e=t?e.nextSibling:e.previousSibling;return e||n};var getNode=function(e,t){var n,a,o;if(!t)return e;a=t.startContainer;o=t.endContainer;var i=t.startOffset;var u=t.endOffset;n=t.commonAncestorContainer;if(!t.collapsed){a===o&&u-i<2&&a.hasChildNodes()&&(n=a.childNodes[i]);if(3===a.nodeType&&3===o.nodeType){a=a.length===i?skipEmptyTextNodes(a.nextSibling,true):a.parentNode;o=0===u?skipEmptyTextNodes(o.previousSibling,false):o.parentNode;if(a&&a===o)return a}}return n&&3===n.nodeType?n.parentNode:n};var getSelectedBlocks=function(e,t,n,a){var o;var i=[];var u=e.getRoot();n=e.getParent(n||getStart(u,t,t.collapsed),e.isBlock);a=e.getParent(a||getEnd(u,t,t.collapsed),e.isBlock);n&&n!==u&&i.push(n);if(n&&a&&n!==a){o=n;var c=new Xe(n,u);while((o=c.next())&&o!==a)e.isBlock(o)&&i.push(o)}a&&n!==a&&a!==u&&i.push(a);return i};var select=function(e,t,n){return b.from(t).map((function(t){var a=e.nodeIndex(t);var o=e.createRng();o.setStart(t.parentNode,a);o.setEnd(t.parentNode,a+1);if(n){moveEndPoint(e,o,t,true);moveEndPoint(e,o,t,false)}return o}))};var processRanges=function(e,t){return map$3(t,(function(t){var n=e.fire("GetSelectionRange",{range:t});return n.range!==t?n.range:t}))};var Qa={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};var walk$1=function(e,t,n){var a=n?"lastChild":"firstChild";var o=n?"prev":"next";if(e[a])return e[a];if(e!==t){var i=e[o];if(i)return i;for(var u=e.parent;u&&u!==t;u=u.parent){i=u[o];if(i)return i}}};var isEmptyTextNode=function(e){if(!isWhitespaceText(e.value))return false;var t=e.parent;return!t||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)};var isNonEmptyElement=function(e){var t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};var Za=function(){function AstNode(e,n){(this||t).name=e;(this||t).type=n;if(1===n){(this||t).attributes=[];(this||t).attributes.map={}}}AstNode.create=function(e,t){var n=new AstNode(e,Qa[e]||1);t&&each$j(t,(function(e,t){n.attr(t,e)}));return n};AstNode.prototype.replace=function(e){var n=this||t;e.parent&&e.remove();n.insert(e,n);n.remove();return n};AstNode.prototype.attr=function(e,n){var a=this||t;var o;if("string"!==typeof e){void 0!==e&&null!==e&&each$j(e,(function(e,t){a.attr(t,e)}));return a}if(o=a.attributes){if(void 0!==n){if(null===n){if(e in o.map){delete o.map[e];var i=o.length;while(i--)if(o[i].name===e){o.splice(i,1);return a}}return a}if(e in o.map){i=o.length;while(i--)if(o[i].name===e){o[i].value=n;break}}else o.push({name:e,value:n});o.map[e]=n;return a}return o.map[e]}};AstNode.prototype.clone=function(){var e=this||t;var n=new AstNode(e.name,e.type);var a;if(a=e.attributes){var o=[];o.map={};for(var i=0,u=a.length;i<u;i++){var c=a[i];if("id"!==c.name){o[o.length]={name:c.name,value:c.value};o.map[c.name]=c.value}}n.attributes=o}n.value=e.value;n.shortEnded=e.shortEnded;return n};AstNode.prototype.wrap=function(e){var n=this||t;n.parent.insert(e,n);e.append(n);return n};AstNode.prototype.unwrap=function(){var e=this||t;for(var n=e.firstChild;n;){var a=n.next;e.insert(n,e,true);n=a}e.remove()};AstNode.prototype.remove=function(){var e=this||t,n=e.parent,a=e.next,o=e.prev;if(n){if(n.firstChild===e){n.firstChild=a;a&&(a.prev=null)}else o.next=a;if(n.lastChild===e){n.lastChild=o;o&&(o.next=null)}else a.prev=o;e.parent=e.next=e.prev=null}return e};AstNode.prototype.append=function(e){var n=this||t;e.parent&&e.remove();var a=n.lastChild;if(a){a.next=e;e.prev=a;n.lastChild=e}else n.lastChild=n.firstChild=e;e.parent=n;return e};AstNode.prototype.insert=function(e,n,a){e.parent&&e.remove();var o=n.parent||this||t;if(a){n===o.firstChild?o.firstChild=e:n.prev.next=e;e.prev=n.prev;e.next=n;n.prev=e}else{n===o.lastChild?o.lastChild=e:n.next.prev=e;e.next=n.next;e.prev=n;n.next=e}e.parent=o;return e};AstNode.prototype.getAll=function(e){var n=this||t;var a=[];for(var o=n.firstChild;o;o=walk$1(o,n))o.name===e&&a.push(o);return a};AstNode.prototype.children=function(){var e=this||t;var n=[];for(var a=e.firstChild;a;a=a.next)n.push(a);return n};AstNode.prototype.empty=function(){var e=this||t;if(e.firstChild){var n=[];for(var a=e.firstChild;a;a=walk$1(a,e))n.push(a);var o=n.length;while(o--){a=n[o];a.parent=a.firstChild=a.lastChild=a.next=a.prev=null}}e.firstChild=e.lastChild=null;return e};AstNode.prototype.isEmpty=function(e,n,a){void 0===n&&(n={});var o=this||t;var i=o.firstChild;if(isNonEmptyElement(o))return false;if(i)do{if(1===i.type){if(i.attr("data-mce-bogus"))continue;if(e[i.name])return false;if(isNonEmptyElement(i))return false}if(8===i.type)return false;if(3===i.type&&!isEmptyTextNode(i))return false;if(3===i.type&&i.parent&&n[i.parent.name]&&isWhitespaceText(i.value))return false;if(a&&a(i))return false}while(i=walk$1(i,o));return true};AstNode.prototype.walk=function(e){return walk$1(this||t,null,e)};return AstNode}();var extractBase64DataUris=function(e){var t=/data:[^;]+;base64,([a-z0-9\+\/=\s]+)/gi;var n=[];var a={};var o=generate("img");var i;var u=0;var c=0;while(i=t.exec(e)){var f=i[0];var s=o+"_"+c++;a[s]=f;u<i.index&&n.push(e.substr(u,i.index-u));n.push(s);u=i.index+f.length}var l=new RegExp(o+"_[0-9]+","g");if(0===u)return{prefix:o,uris:a,html:e,re:l};u<e.length&&n.push(e.substr(u));return{prefix:o,uris:a,html:n.join(""),re:l}};var restoreDataUris=function(e,t){return e.replace(t.re,(function(e){return get$9(t.uris,e).getOr(e)}))};var parseDataUri$1=function(e){var t=/data:([^;]+);base64,([a-z0-9\+\/=\s]+)/i.exec(e);return t?b.some({type:t[1],data:decodeURIComponent(t[2])}):b.none()};var eo=fe.each,ro=fe.trim;var no="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");var ao={ftp:21,http:80,https:443,mailto:25};var oo=["img","video"];var blockSvgDataUris=function(e,t){return isNonNullable(e)?!e:!isNonNullable(t)||!contains$3(oo,t)};var isInvalidUri=function(e,t,n){return!e.allow_html_data_urls&&(/^data:image\//i.test(t)?blockSvgDataUris(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(t):/^data:/i.test(t))};var io=function(){function URI(e,n){e=ro(e);(this||t).settings=n||{};var a=(this||t).settings.base_uri;var o=this||t;if(/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e))o.source=e;else{var i=0===e.indexOf("//");0!==e.indexOf("/")||i||(e=(a&&a.protocol||"http")+"://mce_host"+e);if(!/^[\w\-]*:?\/\//.test(e)){var u=(this||t).settings.base_uri?(this||t).settings.base_uri.path:new URI(document.location.href).directory;if((this||t).settings.base_uri&&""==(this||t).settings.base_uri.protocol)e="//mce_host"+o.toAbsPath(u,e);else{var c=/([^#?]*)([#?]?.*)/.exec(e);e=(a&&a.protocol||"http")+"://mce_host"+o.toAbsPath(u,c[1])+c[2]}}e=e.replace(/@@/g,"(mce_at)");var f=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e);eo(no,(function(e,t){var n=f[t];n&&(n=n.replace(/\(mce_at\)/g,"@@"));o[e]=n}));if(a){o.protocol||(o.protocol=a.protocol);o.userInfo||(o.userInfo=a.userInfo);o.port||"mce_host"!==o.host||(o.port=a.port);o.host&&"mce_host"!==o.host||(o.host=a.host);o.source=""}i&&(o.protocol="")}}URI.parseDataUri=function(e){var t;var n=decodeURIComponent(e).split(",");var a=/data:([^;]+)/.exec(n[0]);a&&(t=a[1]);return{type:t,data:n[1]}};URI.isDomSafe=function(e,t,n){void 0===n&&(n={});if(n.allow_script_urls)return true;var a=Ut.decode(e).replace(/[\s\u0000-\u001F]+/g,"");try{a=decodeURIComponent(a)}catch(e){a=unescape(a)}return!/((java|vb)script|mhtml):/i.test(a)&&!isInvalidUri(n,a,t)};URI.getDocumentBaseUrl=function(e){var t;t=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname;if(/^[^:]+:\/\/\/?[^\/]+\//.test(t)){t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");/[\/\\]$/.test(t)||(t+="/")}return t};URI.prototype.setPath=function(e){var n=/^(.*?)\/?(\w+)?$/.exec(e);(this||t).path=n[0];(this||t).directory=n[1];(this||t).file=n[2];(this||t).source="";this.getURI()};URI.prototype.toRelative=function(e){var n;if("./"===e)return e;var a=new URI(e,{base_uri:this||t});if("mce_host"!==a.host&&(this||t).host!==a.host&&a.host||(this||t).port!==a.port||(this||t).protocol!==a.protocol&&""!==a.protocol)return a.getURI();var o=this.getURI(),i=a.getURI();if(o===i||"/"===o.charAt(o.length-1)&&o.substr(0,o.length-1)===i)return o;n=this.toRelPath((this||t).path,a.path);a.query&&(n+="?"+a.query);a.anchor&&(n+="#"+a.anchor);return n};URI.prototype.toAbsolute=function(e,n){var a=new URI(e,{base_uri:this||t});return a.getURI(n&&this.isSameOrigin(a))};URI.prototype.isSameOrigin=function(e){if((this||t).host==e.host&&(this||t).protocol==e.protocol){if((this||t).port==e.port)return true;var n=ao[(this||t).protocol];if(n&&((this||t).port||n)==(e.port||n))return true}return false};URI.prototype.toRelPath=function(e,t){var n,a,o=0,i="";var u=e.substring(0,e.lastIndexOf("/")).split("/");var c=t.split("/");if(u.length>=c.length)for(n=0,a=u.length;n<a;n++)if(n>=c.length||u[n]!==c[n]){o=n+1;break}if(u.length<c.length)for(n=0,a=c.length;n<a;n++)if(n>=u.length||u[n]!==c[n]){o=n+1;break}if(1===o)return t;for(n=0,a=u.length-(o-1);n<a;n++)i+="../";for(n=o-1,a=c.length;n<a;n++)i+=n!==o-1?"/"+c[n]:c[n];return i};URI.prototype.toAbsPath=function(e,t){var n,a,o=0,i=[];var u=/\/$/.test(t)?"/":"";var c=e.split("/");var f=t.split("/");eo(c,(function(e){e&&i.push(e)}));c=i;for(n=f.length-1,i=[];n>=0;n--)0!==f[n].length&&"."!==f[n]&&(".."!==f[n]?o>0?o--:i.push(f[n]):o++);n=c.length-o;a=n<=0?reverse(i).join("/"):c.slice(0,n).join("/")+"/"+reverse(i).join("/");0!==a.indexOf("/")&&(a="/"+a);u&&a.lastIndexOf("/")!==a.length-1&&(a+=u);return a};URI.prototype.getURI=function(e){void 0===e&&(e=false);var n;if(!(this||t).source||e){n="";if(!e){(this||t).protocol?n+=(this||t).protocol+"://":n+="//";(this||t).userInfo&&(n+=(this||t).userInfo+"@");(this||t).host&&(n+=(this||t).host);(this||t).port&&(n+=":"+(this||t).port)}(this||t).path&&(n+=(this||t).path);(this||t).query&&(n+="?"+(this||t).query);(this||t).anchor&&(n+="#"+(this||t).anchor);(this||t).source=n}return(this||t).source};return URI}();var uo=fe.makeMap("button,fieldset,form,iframe,img,image,input,object,output,select,textarea");var isValidPrefixAttrName=function(e){return 0===e.indexOf("data-")||0===e.indexOf("aria-")};var findMatchingEndTagIndex=function(e,t,n){var a=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g;var o=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g;var i=e.getShortEndedElements();var u=1,c=n;while(0!==u){a.lastIndex=c;while(true){var f=a.exec(t);if(null===f)return c;if("!"===f[1]){c=startsWith(f[2],"--")?findCommentEndIndex(t,false,f.index+"!--".length):findCommentEndIndex(t,true,f.index+1);break}o.lastIndex=a.lastIndex;var l=o.exec(t);if(!s(l)&&l.index===a.lastIndex){"/"===f[1]?u-=1:has$2(i,f[2])||(u+=1);c=a.lastIndex+l[0].length;break}}}return c};var isConditionalComment=function(e,t){return/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(e.substr(t))};var findCommentEndIndex=function(e,t,n){void 0===n&&(n=0);var a=e.toLowerCase();if(-1!==a.indexOf("[if ",n)&&isConditionalComment(a,n)){var o=a.indexOf("[endif]",n);return a.indexOf(">",o)}if(t){var i=a.indexOf(">",n);return-1!==i?i:a.length}var u=/--!?>/g;u.lastIndex=n;var c=u.exec(e);return c?c.index+c[0].length:a.length};var checkBogusAttribute=function(e,t){var n=e.exec(t);if(n){var a=n[1];var o=n[2];return"string"===typeof a&&"data-mce-bogus"===a.toLowerCase()?o:null}return null};var SaxParser=function(e,t){var n;void 0===t&&(t=Schema());e=e||{};var a=null!==(n=e.document)&&void 0!==n?n:document;var o=a.createElement("form");false!==e.fix_self_closing&&(e.fix_self_closing=true);var i=e.comment?e.comment:noop;var u=e.cdata?e.cdata:noop;var c=e.text?e.text:noop;var f=e.start?e.start:noop;var s=e.end?e.end:noop;var l=e.pi?e.pi:noop;var v=e.doctype?e.doctype:noop;var parseInternal=function(n,d){void 0===d&&(d="html");var m=n.html;var g,p,h,b=0;var y=[];var C,w,x,S;var E,k;var N,_,A,R,D,T;var O,B,P;var L,I,M=0;var F=Ut.decode;var U=fe.makeMap("src,href,data,background,action,formaction,poster,xlink:href");var z="html"===d?0:1;var processEndTag=function(e){var t,n;t=y.length;while(t--)if(y[t].name===e)break;if(t>=0){for(n=y.length-1;n>=t;n--){e=y[n];e.valid&&s(e.name)}y.length=t}};var processText=function(e,t){return c(restoreDataUris(e,n),t)};var processComment=function(t){if(""!==t){">"===t.charAt(0)&&(t=" "+t);e.allow_conditional_comments||"[if"!==t.substr(0,3).toLowerCase()||(t=" "+t);i(restoreDataUris(t,n))}};var processAttr=function(e){return restoreDataUris(e,n)};var processMalformedComment=function(e,t){var n=e||"";var a=!startsWith(n,"--");var o=findCommentEndIndex(m,a,t);e=m.substr(t,o-t);processComment(a?n+e:e);return o+1};var parseAttribute=function(t,n,i,u,c){n=n.toLowerCase();i=processAttr(n in $?n:F(i||u||c||""));if(W&&!E&&false===isValidPrefixAttrName(n)){var f=D[n];if(!f&&T){var s=T.length;while(s--){f=T[s];if(f.pattern.test(n))break}-1===s&&(f=null)}if(!f)return;if(f.validValues&&!(i in f.validValues))return}var l="name"===n||"id"===n;if((!l||!(t in uo)||!(i in a)&&!(i in o))&&(!U[n]||io.isDomSafe(i,t,e))&&(!E||!(n in U)&&0!==n.indexOf("on"))){C.map[n]=i;C.push({name:n,value:i})}};var j=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_:.]*)(\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>))","g");var H=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g;var V=t.getShortEndedElements();var q=e.self_closing_elements||t.getSelfClosingElements();var $=t.getBoolAttrs();var W=e.validate;var K=e.remove_internals;var X=e.fix_self_closing;var Y=t.getSpecialElements();var G=m+">";while(g=j.exec(G)){var J=g[0];b<g.index&&processText(F(m.substr(b,g.index-b)));if(p=g[7]){p=p.toLowerCase();":"===p.charAt(0)&&(p=p.substr(1));processEndTag(p)}else if(p=g[8]){if(g.index+J.length>m.length){processText(F(m.substr(g.index)));b=g.index+J.length;continue}p=p.toLowerCase();":"===p.charAt(0)&&(p=p.substr(1));k=p in V;X&&q[p]&&y.length>0&&y[y.length-1].name===p&&processEndTag(p);var Q=checkBogusAttribute(H,g[9]);if(null!==Q){if("all"===Q){b=findMatchingEndTagIndex(t,m,j.lastIndex);j.lastIndex=b;continue}_=false}if(!W||(N=t.getElementRule(p))){_=true;if(W){D=N.attributes;T=N.attributePatterns}if(R=g[9]){E=-1!==R.indexOf("data-mce-type");E&&K&&(_=false);C=[];C.map={};R.replace(H,(function(e,t,n,a,o){parseAttribute(p,t,n,a,o);return""}))}else{C=[];C.map={}}if(W&&!E){O=N.attributesRequired;B=N.attributesDefault;P=N.attributesForced;L=N.removeEmptyAttrs;L&&!C.length&&(_=false);if(P){w=P.length;while(w--){A=P[w];S=A.name;I=A.value;"{$uid}"===I&&(I="mce_"+M++);C.map[S]=I;C.push({name:S,value:I})}}if(B){w=B.length;while(w--){A=B[w];S=A.name;if(!(S in C.map)){I=A.value;"{$uid}"===I&&(I="mce_"+M++);C.map[S]=I;C.push({name:S,value:I})}}}if(O){w=O.length;while(w--)if(O[w]in C.map)break;-1===w&&(_=false)}if(A=C.map["data-mce-bogus"]){if("all"===A){b=findMatchingEndTagIndex(t,m,j.lastIndex);j.lastIndex=b;continue}_=false}}_&&f(p,C,k)}else _=false;if(h=Y[p]){h.lastIndex=b=g.index+J.length;if(g=h.exec(m)){_&&(x=m.substr(b,g.index-b));b=g.index+g[0].length}else{x=m.substr(b);b=m.length}if(_){x.length>0&&processText(x,true);s(p)}j.lastIndex=b;continue}k||(R&&R.indexOf("/")===R.length-1?_&&s(p):y.push({name:p,valid:_}))}else if(p=g[1])processComment(p);else if(p=g[2]){var Z=1===z||e.preserve_cdata||y.length>0&&t.isValidChild(y[y.length-1].name,"#cdata");if(!Z){b=processMalformedComment("",g.index+2);j.lastIndex=b;continue}u(p)}else if(p=g[3])v(p);else{if((p=g[4])||"<!"===J){b=processMalformedComment(p,g.index+J.length);j.lastIndex=b;continue}if(p=g[5]){if(1!==z){b=processMalformedComment("?",g.index+2);j.lastIndex=b;continue}l(p,g[6])}}b=g.index+J.length}b<m.length&&processText(F(m.substr(b)));for(w=y.length-1;w>=0;w--){p=y[w];p.valid&&s(p.name)}};var parse=function(e,t){void 0===t&&(t="html");parseInternal(extractBase64DataUris(e),t)};return{parse:parse}};SaxParser.findEndTag=findMatchingEndTagIndex;var trimHtml=function(e,t){var n=new RegExp(["\\s?("+e.join("|")+')="[^"]+"'].join("|"),"gi");return t.replace(n,"")};var trimInternal=function(e,t){var n=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g;var a=e.schema;var o=trimHtml(e.getTempAttrs(),t);var i=a.getShortEndedElements();var u;while(u=n.exec(o)){var c=n.lastIndex;var f=u[0].length;var s=void 0;s=i[u[1]]?c:SaxParser.findEndTag(a,o,c);o=o.substring(0,c-f)+o.substring(s);n.lastIndex=c-f}return gt(o)};var co=trimInternal;var trimEmptyContents=function(e,t){var n=getForcedRootBlock(e);var a=new RegExp("^(<"+n+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+n+">[\r\n]*|<br \\/>[\r\n]*)$");return t.replace(a,"")};var setupArgs$3=function(e,t){return __assign(__assign({},e),{format:t,get:true,getInner:true})};var getContentFromBody=function(e,t,n,a){var o=setupArgs$3(t,n);var i=t.no_events?o:e.fire("BeforeGetContent",o);var u;u="raw"===i.format?fe.trim(co(e.serializer,a.innerHTML)):"text"===i.format?e.dom.isEmpty(a)?"":gt(a.innerText||a.textContent):"tree"===i.format?e.serializer.serialize(a,i):trimEmptyContents(e,e.serializer.serialize(a,i));contains$3(["text","tree"],i.format)||st(se.fromDom(a))?i.content=u:i.content=fe.trim(u);return i.no_events?i.content:e.fire("GetContent",i).content};var getContentInternal=function(e,t,n){return b.from(e.getBody()).fold(constant("tree"===t.format?new Za("body",11):""),(function(a){return getContentFromBody(e,t,n,a)}))};var fo=fe.each;var ElementUtils=function(e){var compare=function(t,n){if(t.nodeName!==n.nodeName)return false;var getAttribs=function(t){var n={};fo(e.getAttribs(t),(function(a){var o=a.nodeName.toLowerCase();0!==o.indexOf("_")&&"style"!==o&&0!==o.indexOf("data-")&&(n[o]=e.getAttrib(t,o))}));return n};var compareObjects=function(e,t){var n,a;for(a in e)if(has$2(e,a)){n=t[a];if("undefined"===typeof n)return false;if(e[a]!==n)return false;delete t[a]}for(a in t)if(has$2(t,a))return false;return true};return!!compareObjects(getAttribs(t),getAttribs(n))&&(!!compareObjects(e.parseStyle(e.getAttrib(t,"style")),e.parseStyle(e.getAttrib(n,"style")))&&(!isBookmarkNode$1(t)&&!isBookmarkNode$1(n)))};return{compare:compare}};var so=fe.makeMap;var Writer=function(e){var t=[];e=e||{};var n=e.indent;var a=so(e.indent_before||"");var o=so(e.indent_after||"");var i=Ut.getEncodeFunc(e.entity_encoding||"raw",e.entities);var u="html"===e.element_format;return{start:function(e,c,f){var s,l,v,d;if(n&&a[e]&&t.length>0){d=t[t.length-1];d.length>0&&"\n"!==d&&t.push("\n")}t.push("<",e);if(c)for(s=0,l=c.length;s<l;s++){v=c[s];t.push(" ",v.name,'="',i(v.value,true),'"')}t[t.length]=!f||u?">":" />";if(f&&n&&o[e]&&t.length>0){d=t[t.length-1];d.length>0&&"\n"!==d&&t.push("\n")}},end:function(e){var a;t.push("</",e,">");if(n&&o[e]&&t.length>0){a=t[t.length-1];a.length>0&&"\n"!==a&&t.push("\n")}},text:function(e,n){e.length>0&&(t[t.length]=n?e:i(e))},cdata:function(e){t.push("<![CDATA[",e,"]]>")},comment:function(e){t.push("\x3c!--",e,"--\x3e")},pi:function(e,a){a?t.push("<?",e," ",i(a),"?>"):t.push("<?",e,"?>");n&&t.push("\n")},doctype:function(e){t.push("<!DOCTYPE",e,">",n?"\n":"")},reset:function(){t.length=0},getContent:function(){return t.join("").replace(/\n$/,"")}}};var HtmlSerializer=function(e,t){void 0===t&&(t=Schema());var n=Writer(e);e=e||{};e.validate=!("validate"in e)||e.validate;var serialize=function(a){var o=e.validate;var i={3:function(e){n.text(e.value,e.raw)},8:function(e){n.comment(e.value)},7:function(e){n.pi(e.name,e.value)},10:function(e){n.doctype(e.value)},4:function(e){n.cdata(e.value)},11:function(e){if(e=e.firstChild)do{walk(e)}while(e=e.next)}};n.reset();var walk=function(e){var a=i[e.type];if(a)a(e);else{var u=e.name;var c=e.shortEnded;var f=e.attributes;if(o&&f&&f.length>1){var s=[];s.map={};var l=t.getElementRule(e.name);if(l){for(var v=0,d=l.attributesOrder.length;v<d;v++){var m=l.attributesOrder[v];if(m in f.map){var g=f.map[m];s.map[m]=g;s.push({name:m,value:g})}}for(v=0,d=f.length;v<d;v++){m=f[v].name;if(!(m in s.map)){g=f.map[m];s.map[m]=g;s.push({name:m,value:g})}}f=s}}n.start(e.name,f,c);if(!c){if(e=e.firstChild)do{walk(e)}while(e=e.next);n.end(u)}}};1!==a.type||e.inner?i[11](a):walk(a);return n.getContent()};return{serialize:serialize}};var lo=new Set;(function(){var e=["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"];each$k(e,(function(e){lo.add(e)}))})();var vo=["font","text-decoration","text-emphasis"];var getStyleProps=function(e,t){return S(e.parseStyle(e.getAttrib(t,"style")))};var isNonInheritableStyle=function(e){return lo.has(e)};var hasInheritableStyles=function(e,t){return forall(getStyleProps(e,t),(function(e){return!isNonInheritableStyle(e)}))};var getLonghandStyleProps=function(e){return filter$4(e,(function(e){return exists(vo,(function(t){return startsWith(e,t)}))}))};var hasStyleConflict=function(e,t,n){var a=getStyleProps(e,t);var o=getStyleProps(e,n);var valueMismatch=function(a){var o=e.getStyle(t,a);var i=e.getStyle(n,a);return isNotEmpty(o)&&isNotEmpty(i)&&o!==i};return exists(a,(function(e){var propExists=function(t){return exists(t,(function(t){return t===e}))};if(!propExists(o)&&propExists(vo)){var t=getLonghandStyleProps(o);return exists(t,valueMismatch)}return valueMismatch(e)}))};var isChar=function(e,t,n){return b.from(n.container()).filter(Ne).exists((function(a){var o=e?0:-1;return t(a.data.charAt(n.offset()+o))}))};var mo=curry(isChar,true,isWhiteSpace);var go=curry(isChar,false,isWhiteSpace);var isEmptyText=function(e){var t=e.container();return Ne(t)&&(0===t.data.length||mt(t.data)&&BookmarkManager.isBookmarkNode(t.parentNode))};var matchesElementPosition=function(e,t){return function(n){return b.from(getChildNodeAtRelativeOffset(e?0:-1,n)).filter(t).isSome()}};var isImageBlock=function(e){return Te(e)&&"block"===get$5(se.fromDom(e),"display")};var isCefNode=function(e){return Be(e)&&!isBogusAll$1(e)};var po=matchesElementPosition(true,isImageBlock);var ho=matchesElementPosition(false,isImageBlock);var bo=matchesElementPosition(true,Le);var yo=matchesElementPosition(false,Le);var Co=matchesElementPosition(true,isTable$3);var wo=matchesElementPosition(false,isTable$3);var xo=matchesElementPosition(true,isCefNode);var So=matchesElementPosition(false,isCefNode);var getLastChildren=function(e){var t=[];var n=e.dom;while(n){t.push(se.fromDom(n));n=n.lastChild}return t};var removeTrailingBr=function(e){var t=descendants(e,"br");var n=filter$4(getLastChildren(e).slice(-1),isBr$4);t.length===n.length&&each$k(n,remove$7)};var fillWithPaddingBr=function(e){empty(e);append$1(e,se.fromHtml('<br data-mce-bogus="1">'))};var trimBlockTrailingBr=function(e){lastChild(e).each((function(t){prevSibling(t).each((function(n){at(e)&&isBr$4(t)&&at(n)&&remove$7(t)}))}))};var dropLast=function(e){return e.slice(0,-1)};var parentsUntil=function(e,t,n){return contains$1(t,e)?dropLast(parents$1(e,(function(e){return n(e)||eq(e,t)}))):[]};var parents=function(e,t){return parentsUntil(e,t,g)};var parentsAndSelf=function(e,t){return[e].concat(parents(e,t))};var navigateIgnoreEmptyTextNodes=function(e,t,n){return navigateIgnore(e,t,n,isEmptyText)};var getClosestBlock$1=function(e,t){return find$3(parentsAndSelf(se.fromDom(t.container()),e),at)};var isAtBeforeAfterBlockBoundary=function(e,t,n){return navigateIgnoreEmptyTextNodes(e,t.dom,n).forall((function(e){return getClosestBlock$1(t,n).fold((function(){return false===isInSameBlock(e,n,t.dom)}),(function(a){return false===isInSameBlock(e,n,t.dom)&&contains$1(a,se.fromDom(e.container()))}))}))};var isAtBlockBoundary=function(e,t,n){return getClosestBlock$1(t,n).fold((function(){return navigateIgnoreEmptyTextNodes(e,t.dom,n).forall((function(e){return false===isInSameBlock(e,n,t.dom)}))}),(function(t){return navigateIgnoreEmptyTextNodes(e,t.dom,n).isNone()}))};var Eo=curry(isAtBlockBoundary,false);var ko=curry(isAtBlockBoundary,true);var No=curry(isAtBeforeAfterBlockBoundary,false);var _o=curry(isAtBeforeAfterBlockBoundary,true);var isBr=function(e){return getElementFromPosition(e).exists(isBr$4)};var findBr=function(e,t,n){var a=filter$4(parentsAndSelf(se.fromDom(n.container()),t),at);var o=head(a).getOr(t);return fromPosition(e,o.dom,n).filter(isBr)};var isBeforeBr$1=function(e,t){return getElementFromPosition(t).exists(isBr$4)||findBr(true,e,t).isSome()};var isAfterBr=function(e,t){return getElementFromPrevPosition(t).exists(isBr$4)||findBr(false,e,t).isSome()};var Ao=curry(findBr,false);var Ro=curry(findBr,true);var isInMiddleOfText=function(e){return CaretPosition.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd()};var getClosestBlock=function(e,t){var n=filter$4(parentsAndSelf(se.fromDom(t.container()),e),at);return head(n).getOr(e)};var hasSpaceBefore=function(e,t){return isInMiddleOfText(t)?go(t):go(t)||xa(getClosestBlock(e,t).dom,t).exists(go)};var hasSpaceAfter=function(e,t){return isInMiddleOfText(t)?mo(t):mo(t)||wa(getClosestBlock(e,t).dom,t).exists(mo)};var isPreValue=function(e){return contains$3(["pre","pre-wrap"],e)};var isInPre=function(e){return getElementFromPosition(e).bind((function(e){return closest$3(e,pe)})).exists((function(e){return isPreValue(get$5(e,"white-space"))}))};var isAtBeginningOfBody=function(e,t){return xa(e.dom,t).isNone()};var isAtEndOfBody=function(e,t){return wa(e.dom,t).isNone()};var isAtLineBoundary=function(e,t){return isAtBeginningOfBody(e,t)||isAtEndOfBody(e,t)||Eo(e,t)||ko(e,t)||isAfterBr(e,t)||isBeforeBr$1(e,t)};var needsToHaveNbsp=function(e,t){return!isInPre(t)&&(isAtLineBoundary(e,t)||hasSpaceBefore(e,t)||hasSpaceAfter(e,t))};var needsToBeNbspLeft=function(e,t){return!isInPre(t)&&(Eo(e,t)||No(e,t)||isAfterBr(e,t)||hasSpaceBefore(e,t))};var leanRight=function(e){var t=e.container();var n=e.offset();return Ne(t)&&n<t.data.length?CaretPosition(t,n+1):e};var needsToBeNbspRight=function(e,t){return!isInPre(t)&&(ko(e,t)||_o(e,t)||isBeforeBr$1(e,t)||hasSpaceAfter(e,t))};var needsToBeNbsp=function(e,t){return needsToBeNbspLeft(e,t)||needsToBeNbspRight(e,leanRight(t))};var isNbspAt=function(e,t){return Na(e.charAt(t))};var hasNbsp=function(e){var t=e.container();return Ne(t)&&contains$2(t.data,vt)};var normalizeNbspMiddle=function(e){var t=e.split("");return map$3(t,(function(e,n){return Na(e)&&n>0&&n<t.length-1&&isContent(t[n-1])&&isContent(t[n+1])?" ":e})).join("")};var normalizeNbspAtStart=function(e,t){var n=t.data;var a=CaretPosition(t,0);if(isNbspAt(n,0)&&!needsToBeNbsp(e,a)){t.data=" "+n.slice(1);return true}return false};var normalizeNbspInMiddleOfTextNode=function(e){var t=e.data;var n=normalizeNbspMiddle(t);if(n!==t){e.data=n;return true}return false};var normalizeNbspAtEnd=function(e,t){var n=t.data;var a=CaretPosition(t,n.length-1);if(isNbspAt(n,n.length-1)&&!needsToBeNbsp(e,a)){t.data=n.slice(0,-1)+" ";return true}return false};var normalizeNbsps=function(e,t){return b.some(t).filter(hasNbsp).bind((function(t){var n=t.container();var a=normalizeNbspAtStart(e,n)||normalizeNbspInMiddleOfTextNode(n)||normalizeNbspAtEnd(e,n);return a?b.some(t):b.none()}))};var normalizeNbspsInEditor=function(e){var t=se.fromDom(e.getBody());e.selection.isCollapsed()&&normalizeNbsps(t,CaretPosition.fromRangeStart(e.selection.getRng())).each((function(t){e.selection.setRng(t.toRange())}))};var normalizeContent=function(e,t,n){var a=foldl(e,(function(a,o){return isWhiteSpace(o)||Na(o)?a.previousCharIsSpace||""===a.str&&t||a.str.length===e.length-1&&n?{previousCharIsSpace:false,str:a.str+vt}:{previousCharIsSpace:true,str:a.str+" "}:{previousCharIsSpace:false,str:a.str+o}}),{previousCharIsSpace:false,str:""});return a.str};var normalize$1=function(e,t,n){if(0!==n){var a=se.fromDom(e);var o=ancestor$3(a,at).getOr(a);var i=e.data.slice(t,t+n);var u=t+n>=e.data.length&&needsToBeNbspRight(o,CaretPosition(e,e.data.length));var c=0===t&&needsToBeNbspLeft(o,CaretPosition(e,0));e.replaceData(t,n,normalizeContent(i,c,u))}};var normalizeWhitespaceAfter=function(e,t){var n=e.data.slice(t);var a=n.length-A(n).length;normalize$1(e,t,a)};var normalizeWhitespaceBefore=function(e,t){var n=e.data.slice(0,t);var a=n.length-R(n).length;normalize$1(e,t-a,a)};var mergeTextNodes=function(e,t,n,a){void 0===a&&(a=true);var o=R(e.data).length;var i=a?e:t;var u=a?t:e;a?i.appendData(u.data):i.insertData(0,u.data);remove$7(se.fromDom(u));n&&normalizeWhitespaceAfter(i,o);return i};var needsReposition=function(e,t){var n=e.container();var a=e.offset();return false===CaretPosition.isTextPosition(e)&&n===t.parentNode&&a>CaretPosition.before(t).offset()};var reposition=function(e,t){return needsReposition(t,e)?CaretPosition(t.container(),t.offset()-1):t};var beforeOrStartOf=function(e){return Ne(e)?CaretPosition(e,0):CaretPosition.before(e)};var afterOrEndOf=function(e){return Ne(e)?CaretPosition(e,e.data.length):CaretPosition.after(e)};var getPreviousSiblingCaretPosition=function(e){return isCaretCandidate$3(e.previousSibling)?b.some(afterOrEndOf(e.previousSibling)):e.previousSibling?Ea(e.previousSibling):b.none()};var getNextSiblingCaretPosition=function(e){return isCaretCandidate$3(e.nextSibling)?b.some(beforeOrStartOf(e.nextSibling)):e.nextSibling?Sa(e.nextSibling):b.none()};var findCaretPositionBackwardsFromElm=function(e,t){var n=CaretPosition.before(t.previousSibling?t.previousSibling:t.parentNode);return xa(e,n).fold((function(){return wa(e,CaretPosition.after(t))}),b.some)};var findCaretPositionForwardsFromElm=function(e,t){return wa(e,CaretPosition.after(t)).fold((function(){return xa(e,CaretPosition.before(t))}),b.some)};var findCaretPositionBackwards=function(e,t){return getPreviousSiblingCaretPosition(t).orThunk((function(){return getNextSiblingCaretPosition(t)})).orThunk((function(){return findCaretPositionBackwardsFromElm(e,t)}))};var findCaretPositionForward=function(e,t){return getNextSiblingCaretPosition(t).orThunk((function(){return getPreviousSiblingCaretPosition(t)})).orThunk((function(){return findCaretPositionForwardsFromElm(e,t)}))};var findCaretPosition=function(e,t,n){return e?findCaretPositionForward(t,n):findCaretPositionBackwards(t,n)};var findCaretPosOutsideElmAfterDelete=function(e,t,n){return findCaretPosition(e,t,n).map(curry(reposition,n))};var setSelection$1=function(e,t,n){n.fold((function(){e.focus()}),(function(n){e.selection.setRng(n.toRange(),t)}))};var eqRawNode=function(e){return function(t){return t.dom===e}};var isBlock=function(e,t){return t&&has$2(e.schema.getBlockElements(),name(t))};var paddEmptyBlock=function(e){if(isEmpty$2(e)){var t=se.fromHtml('<br data-mce-bogus="1">');empty(e);append$1(e,t);return b.some(CaretPosition.before(t.dom))}return b.none()};var deleteNormalized=function(e,t,n){var a=prevSibling(e).filter(he);var o=nextSibling(e).filter(he);remove$7(e);return lift3(a,o,t,(function(e,t,a){var o=e.dom,i=t.dom;var u=o.data.length;mergeTextNodes(o,i,n);return a.container()===i?CaretPosition(o,u):a})).orThunk((function(){if(n){a.each((function(e){return normalizeWhitespaceBefore(e.dom,e.dom.length)}));o.each((function(e){return normalizeWhitespaceAfter(e.dom,0)}))}return t}))};var isInlineElement=function(e,t){return has$2(e.schema.getTextInlineElements(),name(t))};var deleteElement$2=function(e,t,n,a){void 0===a&&(a=true);var o=findCaretPosOutsideElmAfterDelete(t,e.getBody(),n.dom);var i=ancestor$3(n,curry(isBlock,e),eqRawNode(e.getBody()));var u=deleteNormalized(n,o,isInlineElement(e,n));if(e.dom.isEmpty(e.getBody())){e.setContent("");e.selection.setCursorLocation()}else i.bind(paddEmptyBlock).fold((function(){a&&setSelection$1(e,t,u)}),(function(n){a&&setSelection$1(e,t,b.some(n))}))};var isRootFromElement=function(e){return function(t){return eq(e,t)}};var getTableCells=function(e){return descendants(e,"td,th")};var getTableDetailsFromRange=function(e,t){var getTable=function(e){return getClosestTable(se.fromDom(e),t)};var n=getTable(e.startContainer);var a=getTable(e.endContainer);var o=n.isSome();var i=a.isSome();var u=lift2(n,a,eq).getOr(false);var c=!u&&o&&i;return{startTable:n,endTable:a,isStartInTable:o,isEndInTable:i,isSameTable:u,isMultiTable:c}};var tableCellRng=function(e,t){return{start:e,end:t}};var tableSelection=function(e,t,n){return{rng:e,table:t,cells:n}};var Do=Ve.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]);var getClosestCell$1=function(e,t){return closest$2(se.fromDom(e),"td,th",t)};var isExpandedCellRng=function(e){return!eq(e.start,e.end)};var getTableFromCellRng=function(e,t){return getClosestTable(e.start,t).bind((function(n){return getClosestTable(e.end,t).bind((function(e){return someIf(eq(n,e),n)}))}))};var isSingleCellTable=function(e,t){return!isExpandedCellRng(e)&&getTableFromCellRng(e,t).exists((function(e){var t=e.dom.rows;return 1===t.length&&1===t[0].cells.length}))};var getCellRng=function(e,t){var n=getClosestCell$1(e.startContainer,t);var a=getClosestCell$1(e.endContainer,t);return lift2(n,a,tableCellRng)};var getCellRangeFromStartTable=function(e){return function(t){return getClosestTable(t,e).bind((function(e){return last$2(getTableCells(e)).map((function(e){return tableCellRng(t,e)}))}))}};var getCellRangeFromEndTable=function(e){return function(t){return getClosestTable(t,e).bind((function(e){return head(getTableCells(e)).map((function(e){return tableCellRng(e,t)}))}))}};var getTableSelectionFromCellRng=function(e){return function(t){return getTableFromCellRng(t,e).map((function(e){return tableSelection(t,e,getTableCells(e))}))}};var getTableSelections=function(e,t,n,a){if(n.collapsed||!e.forall(isExpandedCellRng))return b.none();if(t.isSameTable){var o=e.bind(getTableSelectionFromCellRng(a));return b.some({start:o,end:o})}var i=getClosestCell$1(n.startContainer,a);var u=getClosestCell$1(n.endContainer,a);var c=i.bind(getCellRangeFromStartTable(a)).bind(getTableSelectionFromCellRng(a));var f=u.bind(getCellRangeFromEndTable(a)).bind(getTableSelectionFromCellRng(a));return b.some({start:c,end:f})};var getCellIndex=function(e,t){return findIndex$2(e,(function(e){return eq(e,t)}))};var getSelectedCells=function(e){return lift2(getCellIndex(e.cells,e.rng.start),getCellIndex(e.cells,e.rng.end),(function(t,n){return e.cells.slice(t,n+1)}))};var isSingleCellTableContentSelected=function(e,t,n){return e.exists((function(e){return isSingleCellTable(e,n)&&hasAllContentsSelected(e.start,t)}))};var unselectCells=function(e,t){var n=t.startTable,a=t.endTable;var o=e.cloneRange();n.each((function(e){return o.setStartAfter(e.dom)}));a.each((function(e){return o.setEndBefore(e.dom)}));return o};var handleSingleTable=function(e,t,n,a){return getTableSelections(e,t,n,a).bind((function(e){var t=e.start,n=e.end;return t.or(n)})).bind((function(e){var a=t.isSameTable;var o=getSelectedCells(e).getOr([]);if(a&&e.cells.length===o.length)return b.some(Do.fullTable(e.table));if(o.length>0){if(a)return b.some(Do.partialTable(o,b.none()));var i=unselectCells(n,t);return b.some(Do.partialTable(o,b.some(__assign(__assign({},t),{rng:i}))))}return b.none()}))};var handleMultiTable=function(e,t,n,a){return getTableSelections(e,t,n,a).bind((function(e){var a=e.start,o=e.end;var i=a.bind(getSelectedCells).getOr([]);var u=o.bind(getSelectedCells).getOr([]);if(i.length>0&&u.length>0){var c=unselectCells(n,t);return b.some(Do.multiTable(i,u,c))}return b.none()}))};var getActionFromRange=function(e,t){var n=isRootFromElement(e);var a=getCellRng(t,n);var o=getTableDetailsFromRange(t,n);return isSingleCellTableContentSelected(a,t,n)?a.map((function(e){return Do.singleCellTable(t,e.start)})):o.isMultiTable?handleMultiTable(a,o,t,n):handleSingleTable(a,o,t,n)};var freefallRtl=function(e){var t=isComment$1(e)?prevSibling(e):lastChild(e);return t.bind(freefallRtl).orThunk((function(){return b.some(e)}))};var cleanCells=function(e){return each$k(e,(function(e){remove$6(e,"contenteditable");fillWithPaddingBr(e)}))};var getOutsideBlock=function(e,t){return b.from(e.dom.getParent(t,e.dom.isBlock)).map(se.fromDom)};var handleEmptyBlock=function(e,t,n){n.each((function(n){if(t)remove$7(n);else{fillWithPaddingBr(n);e.selection.setCursorLocation(n.dom,0)}}))};var deleteContentInsideCell=function(e,t,n,a){var o=n.cloneRange();if(a){o.setStart(n.startContainer,n.startOffset);o.setEndAfter(t.dom.lastChild)}else{o.setStartBefore(t.dom.firstChild);o.setEnd(n.endContainer,n.endOffset)}deleteCellContents(e,o,t,false)};var collapseAndRestoreCellSelection=function(e){var t=getCellsFromEditor(e);var n=se.fromDom(e.selection.getNode());Pe(n.dom)&&isEmpty$2(n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(true);t.length>1&&exists(t,(function(e){return eq(e,n)}))&&set$1(n,"data-mce-selected","1")};var emptySingleTableCells=function(e,t,n){var a=e.selection.getRng();var o=n.bind((function(n){var o=n.rng,i=n.isStartInTable;var u=getOutsideBlock(e,i?o.endContainer:o.startContainer);o.deleteContents();handleEmptyBlock(e,i,u.filter(isEmpty$2));var c=i?t[0]:t[t.length-1];deleteContentInsideCell(e,c,a,i);return isEmpty$2(c)?b.none():b.some(i?t.slice(1):t.slice(0,-1))})).getOr(t);cleanCells(o);collapseAndRestoreCellSelection(e);return true};var emptyMultiTableCells=function(e,t,n,a){var o=e.selection.getRng();var i=t[0];var u=n[n.length-1];deleteContentInsideCell(e,i,o,true);deleteContentInsideCell(e,u,o,false);var c=isEmpty$2(i)?t:t.slice(1);var f=isEmpty$2(u)?n:n.slice(0,-1);cleanCells(c.concat(f));a.deleteContents();collapseAndRestoreCellSelection(e);return true};var deleteCellContents=function(e,t,n,a){void 0===a&&(a=true);t.deleteContents();var o=freefallRtl(n).getOr(n);var i=se.fromDom(e.dom.getParent(o.dom,e.dom.isBlock));if(isEmpty$2(i)){fillWithPaddingBr(i);a&&e.selection.setCursorLocation(i.dom,0)}if(!eq(n,i)){var u=is$1(parent(i),n)?[]:siblings(i);each$k(u.concat(children(n)),(function(e){eq(e,i)||contains$1(e,i)||!isEmpty$2(e)||remove$7(e)}))}return true};var deleteTableElement=function(e,t){deleteElement$2(e,false,t);return true};var deleteCellRange=function(e,t,n){return getActionFromRange(t,n).map((function(t){return t.fold(curry(deleteCellContents,e),curry(deleteTableElement,e),curry(emptySingleTableCells,e),curry(emptyMultiTableCells,e))}))};var deleteCaptionRange=function(e,t){return emptyElement(e,t)};var deleteTableRange=function(e,t,n,a){return getParentCaption(t,a).fold((function(){return deleteCellRange(e,t,n)}),(function(t){return deleteCaptionRange(e,t)})).getOr(false)};var deleteRange$2=function(e,t,n){var a=se.fromDom(e.getBody());var o=e.selection.getRng();return 0!==n.length?emptySingleTableCells(e,n,b.none()):deleteTableRange(e,a,o,t)};var getParentCell=function(e,t){return find$3(parentsAndSelf(t,e),ft)};var getParentCaption=function(e,t){return find$3(parentsAndSelf(t,e),isTag("caption"))};var deleteBetweenCells=function(e,t,n,a,o){return navigate(n,e.getBody(),o).bind((function(e){return getParentCell(t,se.fromDom(e.getNode())).map((function(e){return false===eq(e,a)}))}))};var emptyElement=function(e,t){fillWithPaddingBr(t);e.selection.setCursorLocation(t.dom,0);return b.some(true)};var isDeleteOfLastCharPos=function(e,t,n,a){return Sa(e.dom).bind((function(o){return Ea(e.dom).map((function(e){return t?n.isEqual(o)&&a.isEqual(e):n.isEqual(e)&&a.isEqual(o)}))})).getOr(true)};var emptyCaretCaption=function(e,t){return emptyElement(e,t)};var validateCaretCaption=function(e,t,n){return getParentCaption(e,se.fromDom(n.getNode())).map((function(e){return false===eq(e,t)}))};var deleteCaretInsideCaption=function(e,t,n,a,o){return navigate(n,e.getBody(),o).bind((function(i){return isDeleteOfLastCharPos(a,n,o,i)?emptyCaretCaption(e,a):validateCaretCaption(t,a,i)})).or(b.some(true))};var deleteCaretCells=function(e,t,n,a){var o=CaretPosition.fromRangeStart(e.selection.getRng());return getParentCell(n,a).bind((function(a){return isEmpty$2(a)?emptyElement(e,a):deleteBetweenCells(e,n,t,a,o)})).getOr(false)};var deleteCaretCaption=function(e,t,n,a){var o=CaretPosition.fromRangeStart(e.selection.getRng());return isEmpty$2(a)?emptyElement(e,a):deleteCaretInsideCaption(e,n,t,a,o)};var isNearTable=function(e,t){return e?Co(t):wo(t)};var isBeforeOrAfterTable=function(e,t){var n=CaretPosition.fromRangeStart(e.selection.getRng());return isNearTable(t,n)||fromPosition(t,e.getBody(),n).exists((function(e){return isNearTable(t,e)}))};var deleteCaret$3=function(e,t,n){var a=se.fromDom(e.getBody());return getParentCaption(a,n).fold((function(){return deleteCaretCells(e,t,a,n)||isBeforeOrAfterTable(e,t)}),(function(n){return deleteCaretCaption(e,t,a,n).getOr(false)}))};var backspaceDelete$9=function(e,t){var n=se.fromDom(e.selection.getStart(true));var a=getCellsFromEditor(e);return e.selection.isCollapsed()&&0===a.length?deleteCaret$3(e,t,n):deleteRange$2(e,n,a)};var createRange=function(e,t,n,a){var o=document.createRange();o.setStart(e,t);o.setEnd(n,a);return o};var normalizeBlockSelectionRange=function(e){var t=CaretPosition.fromRangeStart(e);var n=CaretPosition.fromRangeEnd(e);var a=e.commonAncestorContainer;return fromPosition(false,a,n).map((function(o){return!isInSameBlock(t,n,a)&&isInSameBlock(t,o,a)?createRange(t.container(),t.offset(),o.container(),o.offset()):e})).getOr(e)};var normalize=function(e){return e.collapsed?e:normalizeBlockSelectionRange(e)};var hasOnlyOneChild$1=function(e){return e.firstChild&&e.firstChild===e.lastChild};var isPaddingNode=function(e){return"br"===e.name||e.value===vt};var isPaddedEmptyBlock=function(e,t){var n=e.getBlockElements();return n[t.name]&&hasOnlyOneChild$1(t)&&isPaddingNode(t.firstChild)};var isEmptyFragmentElement=function(e,t){var n=e.getNonEmptyElements();return t&&(t.isEmpty(n)||isPaddedEmptyBlock(e,t))};var isListFragment=function(e,t){var n=t.firstChild;var a=t.lastChild;n&&"meta"===n.name&&(n=n.next);a&&"mce_marker"===a.attr("id")&&(a=a.prev);isEmptyFragmentElement(e,a)&&(a=a.prev);return!(!n||n!==a)&&("ul"===n.name||"ol"===n.name)};var cleanupDomFragment=function(e){var t=e.firstChild;var n=e.lastChild;t&&"META"===t.nodeName&&t.parentNode.removeChild(t);n&&"mce_marker"===n.id&&n.parentNode.removeChild(n);return e};var toDomFragment=function(e,t,n){var a=t.serialize(n);var o=e.createFragment(a);return cleanupDomFragment(o)};var listItems=function(e){return filter$4(e.childNodes,(function(e){return"LI"===e.nodeName}))};var isPadding=function(e){return e.data===vt||De(e)};var isListItemPadded=function(e){return e&&e.firstChild&&e.firstChild===e.lastChild&&isPadding(e.firstChild)};var isEmptyOrPadded=function(e){return!e.firstChild||isListItemPadded(e)};var trimListItems=function(e){return e.length>0&&isEmptyOrPadded(e[e.length-1])?e.slice(0,-1):e};var getParentLi=function(e,t){var n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null};var isParentBlockLi=function(e,t){return!!getParentLi(e,t)};var getSplit=function(e,t){var n=t.cloneRange();var a=t.cloneRange();n.setStartBefore(e);a.setEndAfter(e);return[n.cloneContents(),a.cloneContents()]};var findFirstIn=function(e,t){var n=CaretPosition.before(e);var a=CaretWalker(t);var o=a.next(n);return o?o.toRange():null};var findLastOf=function(e,t){var n=CaretPosition.after(e);var a=CaretWalker(t);var o=a.prev(n);return o?o.toRange():null};var insertMiddle=function(e,t,n,a){var o=getSplit(e,a);var i=e.parentNode;i.insertBefore(o[0],e);fe.each(t,(function(t){i.insertBefore(t,e)}));i.insertBefore(o[1],e);i.removeChild(e);return findLastOf(t[t.length-1],n)};var insertBefore$1=function(e,t,n){var a=e.parentNode;fe.each(t,(function(t){a.insertBefore(t,e)}));return findFirstIn(e,n)};var insertAfter$1=function(e,t,n,a){a.insertAfter(t.reverse(),e);return findLastOf(t[0],n)};var insertAtCaret$1=function(e,t,n,a){var o=toDomFragment(t,e,a);var i=getParentLi(t,n.startContainer);var u=trimListItems(listItems(o.firstChild));var c=1,f=2;var s=t.getRoot();var isAt=function(e){var a=CaretPosition.fromRangeStart(n);var o=CaretWalker(t.getRoot());var u=e===c?o.prev(a):o.next(a);return!u||getParentLi(t,u.getNode())!==i};return isAt(c)?insertBefore$1(i,u,s):isAt(f)?insertAfter$1(i,u,s,t):insertMiddle(i,u,s,n)};var trimOrPadLeftRight=function(e,t,n){var a=se.fromDom(e.getRoot());n=needsToBeNbspLeft(a,CaretPosition.fromRangeStart(t))?n.replace(/^ /,"&nbsp;"):n.replace(/^&nbsp;/," ");n=needsToBeNbspRight(a,CaretPosition.fromRangeEnd(t))?n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n.replace(/&nbsp;(<br( \/)?>)?$/," ");return n};var To=Pe;var isTableCellContentSelected=function(e,t,n){if(null!==n){var a=e.getParent(t.endContainer,To);return n===a&&hasAllContentsSelected(se.fromDom(n),t)}return false};var validInsertion=function(e,t,n){if("all"===n.getAttribute("data-mce-bogus"))n.parentNode.insertBefore(e.dom.createFragment(t),n);else{var a=n.firstChild;var o=n.lastChild;!a||a===o&&"BR"===a.nodeName?e.dom.setHTML(n,t):e.selection.setContent(t)}};var trimBrsFromTableCell=function(e,t){b.from(e.getParent(t,"td,th")).map(se.fromDom).each(trimBlockTrailingBr)};var reduceInlineTextElements=function(e,t){var n=e.schema.getTextInlineElements();var a=e.dom;if(t){var o=e.getBody();var i=ElementUtils(a);fe.each(a.select("*[data-mce-fragment]"),(function(e){var t=isNonNullable(n[e.nodeName.toLowerCase()]);if(t&&hasInheritableStyles(a,e))for(var u=e.parentNode;isNonNullable(u)&&u!==o;u=u.parentNode){var c=hasStyleConflict(a,e,u);if(c)break;if(i.compare(u,e)){a.remove(e,true);break}}}))}};var markFragmentElements=function(e){var t=e;while(t=t.walk())1===t.type&&t.attr("data-mce-fragment","1")};var unmarkFragmentElements=function(e){fe.each(e.getElementsByTagName("*"),(function(e){e.removeAttribute("data-mce-fragment")}))};var isPartOfFragment=function(e){return!!e.getAttribute("data-mce-fragment")};var canHaveChildren=function(e,t){return t&&!e.schema.getShortEndedElements()[t.nodeName]};var moveSelectionToMarker=function(e,t){var n;var a=e.dom;var o=e.selection;if(t){o.scrollIntoView(t);var i=getContentEditableRoot$1(e.getBody(),t);if("false"!==a.getContentEditable(i)){var u=a.createRng();var c=t.previousSibling;if(Ne(c)){u.setStart(c,c.nodeValue.length);if(!ie.ie){var f=t.nextSibling;if(Ne(f)){c.appendData(f.data);f.parentNode.removeChild(f)}}}else{u.setStartBefore(t);u.setEndBefore(t)}var findNextCaretRng=function(t){var n=CaretPosition.fromRangeStart(t);var a=CaretWalker(e.getBody());n=a.next(n);if(n)return n.toRange()};var s=a.getParent(t,a.isBlock);a.remove(t);if(s&&a.isEmpty(s)){e.$(s).empty();u.setStart(s,0);u.setEnd(s,0);if(To(s)||isPartOfFragment(s)||!(n=findNextCaretRng(u)))a.add(s,a.create("br",{"data-mce-bogus":"1"}));else{u=n;a.remove(s)}}o.setRng(u)}else{a.remove(t);o.select(i)}}};var deleteSelectedContent=function(e){var t=e.dom;var n=normalize(e.selection.getRng());e.selection.setRng(n);var a=t.getParent(n.startContainer,To);isTableCellContentSelected(t,n,a)?deleteCellContents(e,n,se.fromDom(a)):e.getDoc().execCommand("Delete",false,null)};var insertHtmlAtCaret=function(e,t,n){var a;var o,i;var u=e.selection;var c=e.dom;/^ | $/.test(t)&&(t=trimOrPadLeftRight(c,u.getRng(),t));var f=e.parser;var s=n.merge;var l=HtmlSerializer({validate:shouldValidate(e)},e.schema);var v='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';var d=e.fire("BeforeSetContent",{content:t,format:"html",selection:true,paste:n.paste});if(d.isDefaultPrevented())e.fire("SetContent",{content:d.content,format:"html",selection:true,paste:n.paste});else{t=d.content;-1===t.indexOf("{$caret}")&&(t+="{$caret}");t=t.replace(/\{\$caret\}/,v);o=u.getRng();var m=o.startContainer||(o.parentElement?o.parentElement():null);var g=e.getBody();if(m===g&&u.isCollapsed()&&c.isBlock(g.firstChild)&&canHaveChildren(e,g.firstChild)&&c.isEmpty(g.firstChild)){o=c.createRng();o.setStart(g.firstChild,0);o.setEnd(g.firstChild,0);u.setRng(o)}u.isCollapsed()||deleteSelectedContent(e);a=u.getNode();var p={context:a.nodeName.toLowerCase(),data:n.data,insert:true};var h=f.parse(t,p);if(true===n.paste&&isListFragment(e.schema,h)&&isParentBlockLi(c,a)){o=insertAtCaret$1(l,c,u.getRng(),h);u.setRng(o);e.fire("SetContent",d)}else{markFragmentElements(h);i=h.lastChild;if("mce_marker"===i.attr("id")){var b=i;for(i=i.prev;i;i=i.walk(true))if(3===i.type||!c.isBlock(i.name)){e.schema.isValidChild(i.parent.name,"span")&&i.parent.insert(b,i,"br"===i.name);break}}e._selectionOverrides.showBlockCaretContainer(a);if(p.invalid){e.selection.setContent(v);a=u.getNode();var y=e.getBody();9===a.nodeType?a=i=y:i=a;while(i!==y){a=i;i=i.parentNode}t=a===y?y.innerHTML:c.getOuterHTML(a);t=l.serialize(f.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,(function(){return l.serialize(h)}))));a===y?c.setHTML(y,t):c.setOuterHTML(a,t)}else{t=l.serialize(h);validInsertion(e,t,a)}reduceInlineTextElements(e,s);moveSelectionToMarker(e,c.get("mce_marker"));unmarkFragmentElements(e.getBody());trimBrsFromTableCell(c,u.getStart());e.fire("SetContent",d);e.addVisual()}}};var traverse=function(e,t){t(e);e.firstChild&&traverse(e.firstChild,t);e.next&&traverse(e.next,t)};var findMatchingNodes=function(e,t,n){var a={};var o={};var i=[];n.firstChild&&traverse(n.firstChild,(function(n){each$k(e,(function(e){e.name===n.name&&(a[e.name]?a[e.name].nodes.push(n):a[e.name]={filter:e,nodes:[n]})}));each$k(t,(function(e){"string"===typeof n.attr(e.name)&&(o[e.name]?o[e.name].nodes.push(n):o[e.name]={filter:e,nodes:[n]})}))}));for(var u in a)has$2(a,u)&&i.push(a[u]);for(var c in o)has$2(o,c)&&i.push(o[c]);return i};var filter$1=function(e,t,n){var a=findMatchingNodes(e,t,n);each$k(a,(function(e){each$k(e.filter.callbacks,(function(t){t(e.nodes,e.filter.name,{})}))}))};var Oo="html";var isTreeNode=function(e){return e instanceof Za};var moveSelection=function(e){hasFocus(e)&&Sa(e.getBody()).each((function(t){var n=t.getNode();var a=isTable$3(n)?Sa(n).getOr(t):t;e.selection.setRng(a.toRange())}))};var setEditorHtml=function(e,t,n){e.dom.setHTML(e.getBody(),t);true!==n&&moveSelection(e)};var setContentString=function(e,t,n,a){if(0===n.length||/^\s+$/.test(n)){var o='<br data-mce-bogus="1">';"TABLE"===t.nodeName?n="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+o+"</li>");var i=getForcedRootBlock(e);if(i&&e.schema.isValidChild(t.nodeName.toLowerCase(),i.toLowerCase())){n=o;n=e.dom.createHTML(i,getForcedRootBlockAttrs(e),n)}else n||(n='<br data-mce-bogus="1">');setEditorHtml(e,n,a.no_selection);e.fire("SetContent",a)}else{"raw"!==a.format&&(n=HtmlSerializer({validate:e.validate},e.schema).serialize(e.parser.parse(n,{isRootContent:true,insert:true})));a.content=st(se.fromDom(t))?n:fe.trim(n);setEditorHtml(e,a.content,a.no_selection);a.no_events||e.fire("SetContent",a)}return a.content};var setContentTree=function(e,t,n,a){filter$1(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);var o=HtmlSerializer({validate:e.validate},e.schema).serialize(n);a.content=st(se.fromDom(t))?o:fe.trim(o);setEditorHtml(e,a.content,a.no_selection);a.no_events||e.fire("SetContent",a);return n};var setupArgs$2=function(e,t){return __assign(__assign({format:Oo},e),{set:true,content:isTreeNode(t)?"":t})};var setContentInternal=function(e,t,n){var a=setupArgs$2(n,t);var o=n.no_events?a:e.fire("BeforeSetContent",a);isTreeNode(t)||(t=o.content);return b.from(e.getBody()).fold(constant(t),(function(n){return isTreeNode(t)?setContentTree(e,n,t,o):setContentString(e,n,t,o)}))};var sibling=function(e,t){return sibling$2(e,t).isSome()};var ensureIsRoot=function(e){return d(e)?e:g};var ancestor=function(e,t,n){var a=e.dom;var o=ensureIsRoot(n);while(a.parentNode){a=a.parentNode;var i=se.fromDom(a);var u=t(i);if(u.isSome())return u;if(o(i))break}return b.none()};var closest$1=function(e,t,n){var a=t(e);var o=ensureIsRoot(n);return a.orThunk((function(){return o(e)?b.none():ancestor(e,t,o)}))};var Bo=isEq$5;var matchesUnInheritedFormatSelector=function(e,t,n){var a=e.formatter.get(n);if(a)for(var o=0;o<a.length;o++){var i=a[o];if(isSelectorFormat(i)&&false===i.inherit&&e.dom.is(t,i.selector))return true}return false};var matchParents=function(e,t,n,a,o){var i=e.dom.getRoot();if(t===i)return false;t=e.dom.getParent(t,(function(t){return!!matchesUnInheritedFormatSelector(e,t,n)||(t.parentNode===i||!!matchNode(e,t,n,a,true))}));return!!matchNode(e,t,n,a,o)};var matchName$1=function(e,t,n){return!!Bo(t,n.inline)||(!!Bo(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0))};var matchItems=function(e,t,n,a,o,i){var u=n[a];if(d(n.onmatch))return n.onmatch(t,n,a);if(u)if(v(u.length)){for(var c in u)if(has$2(u,c)){var f="attributes"===a?e.getAttrib(t,c):getStyle(e,t,c);var s=replaceVars(u[c],i);var l=isNullable(f)||isEmpty$3(f);if(l&&isNullable(s))continue;if(o&&l&&!n.exact)return false;if((!o||n.exact)&&!Bo(f,normalizeStyleValue(e,s,c)))return false}}else for(var m=0;m<u.length;m++)if("attributes"===a?e.getAttrib(t,u[m]):getStyle(e,t,u[m]))return true;return true};var matchNode=function(e,t,n,a,o){var i=e.formatter.get(n);var u=e.dom;if(i&&t)for(var c=0;c<i.length;c++){var f=i[c];if(matchName$1(e.dom,t,f)&&matchItems(u,t,f,"attributes",o,a)&&matchItems(u,t,f,"styles",o,a)){var s=f.classes;if(s)for(var l=0;l<s.length;l++)if(!e.dom.hasClass(t,replaceVars(s[l],a)))return;return f}}};var match$2=function(e,t,n,a,o){if(a)return matchParents(e,a,t,n,o);a=e.selection.getNode();if(matchParents(e,a,t,n,o))return true;var i=e.selection.getStart();return!(i===a||!matchParents(e,i,t,n,o))};var matchAll=function(e,t,n){var a=[];var o={};var i=e.selection.getStart();e.dom.getParent(i,(function(i){for(var u=0;u<t.length;u++){var c=t[u];if(!o[c]&&matchNode(e,i,c,n)){o[c]=true;a.push(c)}}}),e.dom.getRoot());return a};var closest=function(e,t){var isRoot=function(t){return eq(t,se.fromDom(e.getBody()))};var match=function(t,n){return matchNode(e,t.dom,n)?b.some(n):b.none()};return b.from(e.selection.getStart(true)).bind((function(e){return closest$1(se.fromDom(e),(function(e){return findMap(t,(function(t){return match(e,t)}))}),isRoot)})).getOrNull()};var canApply=function(e,t){var n=e.formatter.get(t);var a=e.dom;if(n){var o=e.selection.getStart();var i=getParents$2(a,o);for(var u=n.length-1;u>=0;u--){var c=n[u];if(!isSelectorFormat(c)||isNonNullable(c.defaultBlock))return true;for(var f=i.length-1;f>=0;f--)if(a.is(i[f],c.selector))return true}}return false};var matchAllOnNode=function(e,t,n){return foldl(n,(function(n,a){var o=isVariableFormatName(e,a);return e.formatter.matchNode(t,a,{},o)?n.concat([a]):n}),[])};var Po=dt,Lo="_mce_caret";var importNode=function(e,t){return e.importNode(t,true)};var getEmptyCaretContainers=function(e){var t=[];while(e){if(3===e.nodeType&&e.nodeValue!==Po||e.childNodes.length>1)return[];1===e.nodeType&&t.push(e);e=e.firstChild}return t};var isCaretContainerEmpty=function(e){return getEmptyCaretContainers(e).length>0};var findFirstTextNode=function(e){if(e){var t=new Xe(e,e);for(e=t.current();e;e=t.next())if(Ne(e))return e}return null};var createCaretContainer=function(e){var t=se.fromTag("span");setAll$1(t,{id:Lo,"data-mce-bogus":"1","data-mce-type":"format-caret"});e&&append$1(t,se.fromText(Po));return t};var trimZwspFromCaretContainer=function(e){var t=findFirstTextNode(e);t&&t.nodeValue.charAt(0)===Po&&t.deleteData(0,1);return t};var removeCaretContainerNode=function(e,t,n){void 0===n&&(n=true);var a=e.dom,o=e.selection;if(isCaretContainerEmpty(t))deleteElement$2(e,false,se.fromDom(t),n);else{var i=o.getRng();var u=a.getParent(t,a.isBlock);var c=i.startContainer;var f=i.startOffset;var s=i.endContainer;var l=i.endOffset;var v=trimZwspFromCaretContainer(t);a.remove(t,true);c===v&&f>0&&i.setStart(v,f-1);s===v&&l>0&&i.setEnd(v,l-1);u&&a.isEmpty(u)&&fillWithPaddingBr(se.fromDom(u));o.setRng(i)}};var removeCaretContainer=function(e,t,n){void 0===n&&(n=true);var a=e.dom,o=e.selection;if(t)removeCaretContainerNode(e,t,n);else{t=getParentCaretContainer(e.getBody(),o.getStart());if(!t)while(t=a.get(Lo))removeCaretContainerNode(e,t,false)}};var insertCaretContainerNode=function(e,t,n){var a=e.dom,o=a.getParent(n,curry(isTextBlock$1,e));if(o&&a.isEmpty(o))n.parentNode.replaceChild(t,n);else{removeTrailingBr(se.fromDom(n));a.isEmpty(n)?n.parentNode.replaceChild(t,n):a.insertAfter(t,n)}};var appendNode=function(e,t){e.appendChild(t);return t};var insertFormatNodesIntoCaretContainer=function(e,t){var n=foldr(e,(function(e,t){return appendNode(e,t.cloneNode(false))}),t);return appendNode(n,n.ownerDocument.createTextNode(Po))};var cleanFormatNode=function(e,t,n,a,o,i){var u=e.formatter;var c=e.dom;var f=filter$4(S(u.get()),(function(e){return e!==a&&!contains$2(e,"removeformat")}));var s=matchAllOnNode(e,n,f);var l=filter$4(s,(function(t){return!areSimilarFormats(e,t,a)}));if(l.length>0){var v=n.cloneNode(false);c.add(t,v);u.remove(a,o,v,i);c.remove(v);return b.some(v)}return b.none()};var applyCaretFormat=function(e,t,n){var a,o;var i=e.selection;var u=i.getRng();var c=u.startOffset;var f=u.startContainer;var s=f.nodeValue;a=getParentCaretContainer(e.getBody(),i.getStart());a&&(o=findFirstTextNode(a));var l=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(s&&c>0&&c<s.length&&l.test(s.charAt(c))&&l.test(s.charAt(c-1))){var v=i.getBookmark();u.collapse(true);var d=expandRng(e,u,e.formatter.get(t));d=split(d);e.formatter.apply(t,n,d);i.moveToBookmark(v)}else{if(a&&o.nodeValue===Po)e.formatter.apply(t,n,a);else{a=importNode(e.getDoc(),createCaretContainer(true).dom);o=a.firstChild;u.insertNode(a);c=1;e.formatter.apply(t,n,a)}i.setCursorLocation(o,c)}};var removeCaretFormat=function(e,t,n,a){var o=e.dom;var i=e.selection;var u,c,f;var s=[];var l=i.getRng();var v=l.startContainer;var d=l.startOffset;c=v;if(3===v.nodeType){d!==v.nodeValue.length&&(u=true);c=c.parentNode}while(c){if(matchNode(e,c,t,n,a)){f=c;break}c.nextSibling&&(u=true);s.push(c);c=c.parentNode}if(f)if(u){var m=i.getBookmark();l.collapse(true);var g=expandRng(e,l,e.formatter.get(t),true);g=split(g);e.formatter.remove(t,n,g,a);i.moveToBookmark(m)}else{var p=getParentCaretContainer(e.getBody(),f);var h=createCaretContainer(false).dom;insertCaretContainerNode(e,h,null!==p?p:f);var b=cleanFormatNode(e,h,f,t,n,a);var y=insertFormatNodesIntoCaretContainer(s.concat(b.toArray()),h);removeCaretContainerNode(e,p,false);i.setCursorLocation(y,1);o.isEmpty(f)&&o.remove(f)}};var disableCaretContainer=function(e,t){var n=e.selection,a=e.getBody();removeCaretContainer(e,null,false);8!==t&&46!==t||!n.isCollapsed()||n.getStart().innerHTML!==Po||removeCaretContainer(e,getParentCaretContainer(a,n.getStart()));37!==t&&39!==t||removeCaretContainer(e,getParentCaretContainer(a,n.getStart()))};var setup$k=function(e){e.on("mouseup keydown",(function(t){disableCaretContainer(e,t.keyCode)}))};var replaceWithCaretFormat=function(e,t){var n=createCaretContainer(false);var a=insertFormatNodesIntoCaretContainer(t,n.dom);before$4(se.fromDom(e),n);remove$7(se.fromDom(e));return CaretPosition(a,0)};var isFormatElement=function(e,t){var n=e.schema.getTextInlineElements();return has$2(n,name(t))&&!isCaretNode(t.dom)&&!isBogus$2(t.dom)};var isEmptyCaretFormatElement=function(e){return isCaretNode(e.dom)&&isCaretContainerEmpty(e.dom)};var Io={};var Mo=filter$2;var Fo=each$i;var addPostProcessHook=function(e,t){var n=Io[e];n||(Io[e]=[]);Io[e].push(t)};var postProcess$1=function(e,t){Fo(Io[e],(function(e){e(t)}))};addPostProcessHook("pre",(function(e){var t=e.selection.getRng();var n;var hasPreSibling=function(e){return a(e.previousSibling)&&-1!==indexOf$1(n,e.previousSibling)};var joinPre=function(e,t){vn(t).remove();vn(e).append("<br><br>").append(t.childNodes)};var a=matchNodeNames(["pre"]);if(!t.collapsed){n=e.selection.getSelectedBlocks();Fo(Mo(Mo(n,a),hasPreSibling),(function(e){joinPre(e.previousSibling,e)}))}}));var Uo=fe.each;var isElementNode$1=function(e){return Ee(e)&&!isBookmarkNode$1(e)&&!isCaretNode(e)&&!isBogus$2(e)};var findElementSibling=function(e,t){for(var n=e;n;n=n[t]){if(Ne(n)&&isNotEmpty(n.data))return e;if(Ee(n)&&!isBookmarkNode$1(n))return n}return e};var mergeSiblingsNodes=function(e,t,n){var a=ElementUtils(e);if(t&&n){t=findElementSibling(t,"previousSibling");n=findElementSibling(n,"nextSibling");if(a.compare(t,n)){for(var o=t.nextSibling;o&&o!==n;){var i=o;o=o.nextSibling;t.appendChild(i)}e.remove(n);fe.each(fe.grep(n.childNodes),(function(e){t.appendChild(e)}));return t}}return n};var mergeSiblings=function(e,t,n,a){if(a&&false!==t.merge_siblings){var o=mergeSiblingsNodes(e,getNonWhiteSpaceSibling(a),a);mergeSiblingsNodes(e,o,getNonWhiteSpaceSibling(o,true))}};var clearChildStyles=function(e,t,n){if(t.clear_child_styles){var a=t.links?"*:not(a)":"*";Uo(e.select(a,n),(function(n){isElementNode$1(n)&&Uo(t.styles,(function(t,a){e.setStyle(n,a,"")}))}))}};var processChildElements=function(e,t,n){Uo(e.childNodes,(function(e){if(isElementNode$1(e)){t(e)&&n(e);e.hasChildNodes()&&processChildElements(e,t,n)}}))};var unwrapEmptySpan=function(e,t){"SPAN"===t.nodeName&&0===e.getAttribs(t).length&&e.remove(t,true)};var hasStyle=function(e,t){return function(n){return!!(n&&getStyle(e,n,t))}};var applyStyle=function(e,t,n){return function(a){e.setStyle(a,t,n);""===a.getAttribute("style")&&a.removeAttribute("style");unwrapEmptySpan(e,a)}};var zo=Ve.generate([{keep:[]},{rename:["name"]},{removed:[]}]);var jo=/^(src|href|style)$/;var Ho=fe.each;var Vo=isEq$5;var isTableCellOrRow=function(e){return/^(TR|TH|TD)$/.test(e.nodeName)};var isChildOfInlineParent=function(e,t,n){return e.isChildOf(t,n)&&t!==n&&!e.isBlock(n)};var getContainer=function(e,t,n){var a=t[n?"startContainer":"endContainer"];var o=t[n?"startOffset":"endOffset"];if(Ee(a)){var i=a.childNodes.length-1;!n&&o&&o--;a=a.childNodes[o>i?i:o]}Ne(a)&&n&&o>=a.nodeValue.length&&(a=new Xe(a,e.getBody()).next()||a);Ne(a)&&!n&&0===o&&(a=new Xe(a,e.getBody()).prev()||a);return a};var normalizeTableSelection=function(e,t){var n=t?"firstChild":"lastChild";if(isTableCellOrRow(e)&&e[n]){var a=e[n];return"TR"===e.nodeName&&a[n]||a}return e};var wrap$1=function(e,t,n,a){var o=e.create(n,a);t.parentNode.insertBefore(o,t);o.appendChild(t);return o};var wrapWithSiblings=function(e,t,n,a,o){var i=se.fromDom(t);var u=se.fromDom(e.create(a,o));var c=n?nextSiblings(i):prevSiblings(i);append(u,c);if(n){before$4(i,u);prepend(u,i)}else{after$3(i,u);append$1(u,i)}return u.dom};var matchName=function(e,t,n){return!(!isInlineFormat(n)||!Vo(t,n.inline))||(!(!isBlockFormat(n)||!Vo(t,n.block))||(isSelectorFormat(n)?Ee(t)&&e.is(t,n.selector):void 0))};var isColorFormatAndAnchor=function(e,t){return t.links&&"A"===e.nodeName};var find=function(e,t,n,a){var o=getNonWhiteSpaceSibling(t,n,a);return isNullable(o)||"BR"===o.nodeName||e.isBlock(o)};var removeNode=function(e,t,n){var a=t.parentNode;var o;var i=e.dom,u=getForcedRootBlock(e);if(isBlockFormat(n))if(u)a===i.getRoot()&&(n.list_block&&Vo(t,n.list_block)||each$k(x(t.childNodes),(function(t){if(isValid(e,u,t.nodeName.toLowerCase()))if(o)o.appendChild(t);else{o=wrap$1(i,t,u);i.setAttribs(o,e.settings.forced_root_block_attrs)}else o=null})));else if(i.isBlock(t)&&!i.isBlock(a)){find(i,t,false)||find(i,t.firstChild,true,true)||t.insertBefore(i.create("br"),t.firstChild);find(i,t,true)||find(i,t.lastChild,false,true)||t.appendChild(i.create("br"))}isMixedFormat(n)&&!Vo(n.inline,t)||i.remove(t,true)};var removeFormatInternal=function(e,t,n,a,o){var i;var u=e.dom;if(!matchName(u,a,t)&&!isColorFormatAndAnchor(a,t))return zo.keep();var c=a;if(isInlineFormat(t)&&"all"===t.remove&&f(t.preserve_attributes)){var s=filter$4(u.getAttribs(c),(function(e){return contains$3(t.preserve_attributes,e.name.toLowerCase())}));u.removeAllAttribs(c);each$k(s,(function(e){return u.setAttrib(c,e.name,e.value)}));if(s.length>0)return zo.rename("span")}if("all"!==t.remove){Ho(t.styles,(function(e,a){e=normalizeStyleValue(u,replaceVars(e,n),a+"");if(m(a)){a=e;o=null}(t.remove_similar||!o||Vo(getStyle(u,o,a),e))&&u.setStyle(c,a,"");i=true}));if(i&&""===u.getAttrib(c,"style")){c.removeAttribute("style");c.removeAttribute("data-mce-style")}Ho(t.attributes,(function(e,a){var i;e=replaceVars(e,n);if(m(a)){a=e;o=null}if(t.remove_similar||!o||Vo(u.getAttrib(o,a),e)){if("class"===a){e=u.getAttrib(c,a);if(e){i="";each$k(e.split(/\s+/),(function(e){/mce\-\w+/.test(e)&&(i+=(i?" ":"")+e)}));if(i){u.setAttrib(c,a,i);return}}}jo.test(a)&&c.removeAttribute("data-mce-"+a);if("style"===a&&matchNodeNames(["li"])(c)&&"none"===u.getStyle(c,"list-style-type")){c.removeAttribute(a);u.setStyle(c,"list-style-type","none");return}"class"===a&&c.removeAttribute("className");c.removeAttribute(a)}}));Ho(t.classes,(function(e){e=replaceVars(e,n);o&&!u.hasClass(o,e)||u.removeClass(c,e)}));var l=u.getAttribs(c);for(var v=0;v<l.length;v++){var d=l[v].nodeName;if(0!==d.indexOf("_")&&0!==d.indexOf("data-"))return zo.keep()}}if("none"!==t.remove){removeNode(e,c,t);return zo.removed()}return zo.keep()};var removeFormat$1=function(e,t,n,a,o){return removeFormatInternal(e,t,n,a,o).fold(g,(function(t){e.dom.rename(a,t);return true}),p)};var findFormatRoot=function(e,t,n,a,o){var i;each$k(getParents$2(e.dom,t.parentNode).reverse(),(function(t){if(!i&&"_start"!==t.id&&"_end"!==t.id){var u=matchNode(e,t,n,a,o);u&&false!==u.split&&(i=t)}}));return i};var removeFormatFromClone=function(e,t,n,a){return removeFormatInternal(e,t,n,a,a).fold(constant(a),(function(t){var n=e.dom.createFragment();n.appendChild(a);return e.dom.rename(a,t)}),constant(null))};var wrapAndSplit=function(e,t,n,a,o,i,u,c){var f,s,l;var v=e.dom;if(n){var d=n.parentNode;for(var m=a.parentNode;m&&m!==d;m=m.parentNode){f=v.clone(m,false);for(var g=0;g<t.length;g++){f=removeFormatFromClone(e,t[g],c,f);if(null===f)break}if(f){s&&f.appendChild(s);l||(l=f);s=f}}!i||u.mixed&&v.isBlock(n)||(a=v.split(n,a));if(s){o.parentNode.insertBefore(s,o);l.appendChild(o);isInlineFormat(u)&&mergeSiblings(v,u,c,s)}}return a};var remove$1=function(e,t,n,a,o){var i=e.formatter.get(t);var u=i[0];var c=true;var f=e.dom;var s=e.selection;var splitToFormatRoot=function(a){var c=findFormatRoot(e,a,t,n,o);return wrapAndSplit(e,i,c,a,a,true,u,n)};var isRemoveBookmarkNode=function(e){return isBookmarkNode$1(e)&&Ee(e)&&("_start"===e.id||"_end"===e.id)};var removeNodeFormat=function(t){return exists(i,(function(a){return removeFormat$1(e,a,n,t,t)}))};var process=function(t){var n=true;var a=false;if(Ee(t)&&f.getContentEditable(t)){n=c;c="true"===f.getContentEditable(t);a=true}var o=x(t.childNodes);if(c&&!a){var i=removeNodeFormat(t);var s=t.parentNode;!i&&isNonNullable(s)&&shouldExpandToSelector(u)&&removeNodeFormat(s)}if(u.deep&&o.length){for(var l=0;l<o.length;l++)process(o[l]);a&&(c=n)}var v=["underline","line-through","overline"];each$k(v,(function(n){Ee(t)&&e.dom.getStyle(t,"text-decoration")===n&&t.parentNode&&getTextDecoration(f,t.parentNode)===n&&removeFormat$1(e,{deep:false,exact:true,inline:"span",styles:{textDecoration:n}},null,t)}))};var unwrap=function(e){var t=f.get(e?"_start":"_end");var n=t[e?"firstChild":"lastChild"];isRemoveBookmarkNode(n)&&(n=n[e?"firstChild":"lastChild"]);Ne(n)&&0===n.data.length&&(n=e?t.previousSibling||t.nextSibling:t.nextSibling||t.previousSibling);f.remove(t,true);return n};var removeRngStyle=function(t){var n,a;var o=expandRng(e,t,i,t.collapsed);if(u.split){o=split(o);n=getContainer(e,o,true);a=getContainer(e,o);if(n!==a){n=normalizeTableSelection(n,true);a=normalizeTableSelection(a,false);if(isChildOfInlineParent(f,n,a)){var c=b.from(n.firstChild).getOr(n);splitToFormatRoot(wrapWithSiblings(f,c,true,"span",{id:"_start","data-mce-type":"bookmark"}));unwrap(true);return}if(isChildOfInlineParent(f,a,n)){c=b.from(a.lastChild).getOr(a);splitToFormatRoot(wrapWithSiblings(f,c,false,"span",{id:"_end","data-mce-type":"bookmark"}));unwrap(false);return}n=wrap$1(f,n,"span",{id:"_start","data-mce-type":"bookmark"});a=wrap$1(f,a,"span",{id:"_end","data-mce-type":"bookmark"});var s=f.createRng();s.setStartAfter(n);s.setEndBefore(a);walk$2(f,s,(function(e){each$k(e,(function(e){isBookmarkNode$1(e)||isBookmarkNode$1(e.parentNode)||splitToFormatRoot(e)}))}));splitToFormatRoot(n);splitToFormatRoot(a);n=unwrap(true);a=unwrap()}else n=a=splitToFormatRoot(n);o.startContainer=n.parentNode?n.parentNode:n;o.startOffset=f.nodeIndex(n);o.endContainer=a.parentNode?a.parentNode:a;o.endOffset=f.nodeIndex(a)+1}walk$2(f,o,(function(e){each$k(e,process)}))};if(a){if(isNode(a)){var l=f.createRng();l.setStartBefore(a);l.setEndAfter(a);removeRngStyle(l)}else removeRngStyle(a);fireFormatRemove(e,t,a,n)}else if("false"!==f.getContentEditable(s.getNode())){if(s.isCollapsed()&&isInlineFormat(u)&&!getCellsFromEditor(e).length)removeCaretFormat(e,t,n,o);else{preserve(s,true,(function(){runOnRanges(e,removeRngStyle)}));isInlineFormat(u)&&match$2(e,t,n,s.getStart())&&moveStart(f,s,s.getRng());e.nodeChanged()}fireFormatRemove(e,t,a,n)}else{a=s.getNode();for(var v=0;v<i.length;v++)if(i[v].ceFalseOverride&&removeFormat$1(e,i[v],n,a,a))break;fireFormatRemove(e,t,a,n)}};var qo=fe.each;var mergeTextDecorationsAndColor=function(e,t,n,a){var processTextDecorationsAndColor=function(t){if(1===t.nodeType&&t.parentNode&&1===t.parentNode.nodeType){var n=getTextDecoration(e,t.parentNode);e.getStyle(t,"color")&&n?e.setStyle(t,"text-decoration",n):e.getStyle(t,"text-decoration")===n&&e.setStyle(t,"text-decoration",null)}};if(t.styles&&(t.styles.color||t.styles.textDecoration)){fe.walk(a,processTextDecorationsAndColor,"childNodes");processTextDecorationsAndColor(a)}};var mergeBackgroundColorAndFontSize=function(e,t,n,a){t.styles&&t.styles.backgroundColor&&processChildElements(a,hasStyle(e,"fontSize"),applyStyle(e,"backgroundColor",replaceVars(t.styles.backgroundColor,n)))};var mergeSubSup=function(e,t,n,a){if(isInlineFormat(t)&&("sub"===t.inline||"sup"===t.inline)){processChildElements(a,hasStyle(e,"fontSize"),applyStyle(e,"fontSize",""));e.remove(e.select("sup"===t.inline?"sub":"sup",a),true)}};var mergeWithChildren=function(e,t,n,a){qo(t,(function(t){isInlineFormat(t)&&qo(e.dom.select(t.inline,a),(function(a){isElementNode$1(a)&&removeFormat$1(e,t,n,a,t.exact?a:null)}));clearChildStyles(e.dom,t,a)}))};var mergeWithParents=function(e,t,n,a,o){matchNode(e,o.parentNode,n,a)&&removeFormat$1(e,t,a,o)||t.merge_with_parents&&e.dom.getParent(o.parentNode,(function(i){if(matchNode(e,i,n,a)){removeFormat$1(e,t,a,o);return true}}))};var $o=fe.each;var isElementNode=function(e){return Ee(e)&&!isBookmarkNode$1(e)&&!isCaretNode(e)&&!isBogus$2(e)};var canFormatBR=function(e,t,n,a){if(canFormatEmptyLines(e)&&isInlineFormat(t)){var o=__assign(__assign({},e.schema.getTextBlockElements()),{td:{},th:{},li:{},dt:{},dd:{},figcaption:{},caption:{},details:{},summary:{}});var i=sibling(se.fromDom(n),(function(e){return isCaretNode(e.dom)}));return hasNonNullableKey(o,a)&&isEmpty$2(se.fromDom(n.parentNode),false)&&!i}return false};var applyFormat$1=function(e,t,n,a){var o=e.formatter.get(t);var i=o[0];var c=!a&&e.selection.isCollapsed();var f=e.dom;var s=e.selection;var setElementFormat=function(e,t){void 0===t&&(t=i);d(t.onformat)&&t.onformat(e,t,n,a);$o(t.styles,(function(t,a){f.setStyle(e,a,replaceVars(t,n))}));if(t.styles){var o=f.getAttrib(e,"style");o&&f.setAttrib(e,"data-mce-style",o)}$o(t.attributes,(function(t,a){f.setAttrib(e,a,replaceVars(t,n))}));$o(t.classes,(function(t){t=replaceVars(t,n);f.hasClass(e,t)||f.addClass(e,t)}))};var applyNodeStyle=function(e,t){var n=false;$o(e,(function(e){if(!isSelectorFormat(e))return false;if((!isNonNullable(e.collapsed)||e.collapsed===c)&&f.is(t,e.selector)&&!isCaretNode(t)){setElementFormat(t,e);n=true;return false}}));return n};var createWrapElement=function(e){if(u(e)){var t=f.create(e);setElementFormat(t);return t}return null};var applyRngStyle=function(a,u,c){var f=[];var s=true;var l=i.inline||i.block;var v=createWrapElement(l);walk$2(a,u,(function(u){var d;var process=function(u){var m=false;var g=s;var p=u.nodeName.toLowerCase();var h=u.parentNode;var b=h.nodeName.toLowerCase();if(Ee(u)&&a.getContentEditable(u)){g=s;s="true"===a.getContentEditable(u);m=true}if(!De(u)||canFormatBR(e,i,u,b))if(isBlockFormat(i)&&i.wrapper&&matchNode(e,u,t,n))d=null;else if(s&&!m&&isBlockFormat(i)&&!i.wrapper&&isTextBlock$1(e,p)&&isValid(e,b,l)){var y=a.rename(u,l);setElementFormat(y);f.push(y);d=null}else{if(isSelectorFormat(i)){var C=applyNodeStyle(o,u);!C&&isNonNullable(h)&&shouldExpandToSelector(i)&&(C=applyNodeStyle(o,h));if(!isInlineFormat(i)||C){d=null;return}}if(!s||m||!isValid(e,l,p)||!isValid(e,b,l)||!c&&Ne(u)&&mt(u.data)||isCaretNode(u)||isInlineFormat(i)&&a.isBlock(u)){d=null;each$k(x(u.childNodes),process);m&&(s=g);d=null}else{if(!d){d=a.clone(v,false);u.parentNode.insertBefore(d,u);f.push(d)}d.appendChild(u)}}else{d=null;isBlockFormat(i)&&a.remove(u)}};each$k(u,process)}));true===i.links&&each$k(f,(function(e){var process=function(e){"A"===e.nodeName&&setElementFormat(e,i);each$k(x(e.childNodes),process)};process(e)}));each$k(f,(function(u){var getChildCount=function(e){var t=0;each$k(e.childNodes,(function(e){isEmptyTextNode$1(e)||isBookmarkNode$1(e)||t++}));return t};var mergeStyles=function(e){var t=find$3(e.childNodes,isElementNode).filter((function(e){return matchName$1(a,e,i)}));return t.map((function(t){var n=a.clone(t,false);setElementFormat(n);a.replace(n,e,true);a.remove(t,true);return n})).getOr(e)};var c=getChildCount(u);if(!(f.length>1)&&a.isBlock(u)||0!==c){if(isInlineFormat(i)||isBlockFormat(i)&&i.wrapper){i.exact||1!==c||(u=mergeStyles(u));mergeWithChildren(e,o,n,u);mergeWithParents(e,i,t,n,u);mergeBackgroundColorAndFontSize(a,i,n,u);mergeTextDecorationsAndColor(a,i,n,u);mergeSubSup(a,i,n,u);mergeSiblings(a,i,n,u)}}else a.remove(u,true)}))};if("false"!==f.getContentEditable(s.getNode())){if(i){if(a)if(isNode(a)){if(!applyNodeStyle(o,a)){var l=f.createRng();l.setStartBefore(a);l.setEndAfter(a);applyRngStyle(f,expandRng(e,l,o),true)}}else applyRngStyle(f,a,true);else if(c&&isInlineFormat(i)&&!getCellsFromEditor(e).length)applyCaretFormat(e,t,n);else{var v=s.getNode();var m=o[0];e.settings.forced_root_block||!m.defaultBlock||f.getParent(v,f.isBlock)||applyFormat$1(e,m.defaultBlock);s.setRng(normalize(s.getRng()));preserve(s,true,(function(){runOnRanges(e,(function(t,n){var a=n?t:expandRng(e,t,o);applyRngStyle(f,a,false)}))}));moveStart(f,s,s.getRng());e.nodeChanged()}postProcess$1(t,e)}fireFormatApply(e,t,a,n)}else{a=s.getNode();for(var g=0,p=o.length;g<p;g++){var h=o[g];if(h.ceFalseOverride&&isSelectorFormat(h)&&f.is(a,h.selector)){setElementFormat(a,h);break}}fireFormatApply(e,t,a,n)}};var hasVars=function(e){return has$2(e,"vars")};var setup$j=function(e,t){e.set({});t.on("NodeChange",(function(n){updateAndFireChangeCallbacks(t,n.element,e.get())}));t.on("FormatApply FormatRemove",(function(n){var a=b.from(n.node).map((function(e){return isNode(e)?e:e.startContainer})).bind((function(e){return Ee(e)?b.some(e):b.from(e.parentElement)})).getOrThunk((function(){return fallbackElement(t)}));updateAndFireChangeCallbacks(t,a,e.get())}))};var fallbackElement=function(e){return e.selection.getStart()};var matchingNode=function(e,t,n,a,o){var isMatchingNode=function(t){var i=e.formatter.matchNode(t,n,null!==o&&void 0!==o?o:{},a);return!v(i)};var isUnableToMatch=function(t){return!!matchesUnInheritedFormatSelector(e,t,n)||!a&&isNonNullable(e.formatter.matchNode(t,n,o,true))};return findUntil$1(t,isMatchingNode,isUnableToMatch)};var getParents=function(e,t){var n=null!==t&&void 0!==t?t:fallbackElement(e);return filter$4(getParents$2(e.dom,n),(function(e){return Ee(e)&&!isBogus$2(e)}))};var updateAndFireChangeCallbacks=function(e,t,n){var a=getParents(e,t);each$j(n,(function(n,o){var runIfChanged=function(n){var i=matchingNode(e,a,o,n.similar,hasVars(n)?n.vars:void 0);var u=i.isSome();if(n.state.get()!==u){n.state.set(u);var c=i.getOr(t);hasVars(n)?n.callback(u,{node:c,format:o,parents:a}):each$k(n.callbacks,(function(e){return e(u,{node:c,format:o,parents:a})}))}};each$k([n.withSimilar,n.withoutSimilar],runIfChanged);each$k(n.withVars,runIfChanged)}))};var addListeners=function(e,t,n,a,o,i){var u=t.get();each$k(n.split(","),(function(t){var n=get$9(u,t).getOrThunk((function(){var e={withSimilar:{state:Cell(false),similar:true,callbacks:[]},withoutSimilar:{state:Cell(false),similar:false,callbacks:[]},withVars:[]};u[t]=e;return e}));var getCurrent=function(){var n=getParents(e);return matchingNode(e,n,t,o,i).isSome()};if(v(i)){var c=o?n.withSimilar:n.withoutSimilar;c.callbacks.push(a);1===c.callbacks.length&&c.state.set(getCurrent())}else n.withVars.push({state:Cell(getCurrent()),similar:o,vars:i,callback:a})}));t.set(u)};var removeListeners=function(e,t,n){var a=e.get();each$k(t.split(","),(function(e){return get$9(a,e).each((function(t){a[e]={withSimilar:__assign(__assign({},t.withSimilar),{callbacks:filter$4(t.withSimilar.callbacks,(function(e){return e!==n}))}),withoutSimilar:__assign(__assign({},t.withoutSimilar),{callbacks:filter$4(t.withoutSimilar.callbacks,(function(e){return e!==n}))}),withVars:filter$4(t.withVars,(function(e){return e.callback!==n}))}}))}));e.set(a)};var formatChangedInternal=function(e,t,n,a,o,i){null===t.get()&&setup$j(t,e);addListeners(e,t,n,a,o,i);return{unbind:function(){return removeListeners(t,n,a)}}};var toggle=function(e,t,n,a){var o=e.formatter.get(t);!match$2(e,t,n,a)||"toggle"in o[0]&&!o[0].toggle?applyFormat$1(e,t,n,a):remove$1(e,t,n,a)};var fromElements=function(e,t){var n=t||document;var a=n.createDocumentFragment();each$k(e,(function(e){a.appendChild(e.dom)}));return se.fromDom(a)};var tableModel=function(e,t,n){return{element:e,width:t,rows:n}};var tableRow=function(e,t){return{element:e,cells:t}};var cellPosition=function(e,t){return{x:e,y:t}};var getSpan=function(e,t){var n=parseInt(get$6(e,t),10);return isNaN(n)?1:n};var fillout=function(e,t,n,a,o){var i=getSpan(o,"rowspan");var u=getSpan(o,"colspan");var c=e.rows;for(var f=n;f<n+i;f++){c[f]||(c[f]=tableRow(deep$1(a),[]));for(var s=t;s<t+u;s++){var l=c[f].cells;l[s]=f===n&&s===t?o:shallow(o)}}};var cellExists=function(e,t,n){var a=e.rows;var o=a[n]?a[n].cells:[];return!!o[t]};var skipCellsX=function(e,t,n){while(cellExists(e,t,n))t++;return t};var getWidth=function(e){return foldl(e,(function(e,t){return t.cells.length>e?t.cells.length:e}),0)};var findElementPos=function(e,t){var n=e.rows;for(var a=0;a<n.length;a++){var o=n[a].cells;for(var i=0;i<o.length;i++)if(eq(o[i],t))return b.some(cellPosition(i,a))}return b.none()};var extractRows=function(e,t,n,a,o){var i=[];var u=e.rows;for(var c=n;c<=o;c++){var f=u[c].cells;var s=t<a?f.slice(t,a+1):f.slice(a,t+1);i.push(tableRow(u[c].element,s))}return i};var subTable=function(e,t,n){var a=t.x,o=t.y;var i=n.x,u=n.y;var c=o<u?extractRows(e,a,o,i,u):extractRows(e,a,u,i,o);return tableModel(e.element,getWidth(c),c)};var createDomTable=function(e,t){var n=shallow(e.element);var a=se.fromTag("tbody");append(a,t);append$1(n,a);return n};var modelRowsToDomRows=function(e){return map$3(e.rows,(function(e){var t=map$3(e.cells,(function(e){var t=deep$1(e);remove$6(t,"colspan");remove$6(t,"rowspan");return t}));var n=shallow(e.element);append(n,t);return n}))};var fromDom=function(e){var t=tableModel(shallow(e),0,[]);each$k(descendants(e,"tr"),(function(e,n){each$k(descendants(e,"td,th"),(function(a,o){fillout(t,skipCellsX(t,o,n),n,e,a)}))}));return tableModel(t.element,getWidth(t.rows),t.rows)};var toDom=function(e){return createDomTable(e,modelRowsToDomRows(e))};var subsection=function(e,t,n){return findElementPos(e,t).bind((function(t){return findElementPos(e,n).map((function(n){return subTable(e,t,n)}))}))};var findParentListContainer=function(e){return find$3(e,(function(e){return"ul"===name(e)||"ol"===name(e)}))};var getFullySelectedListWrappers=function(e,t){return find$3(e,(function(e){return"li"===name(e)&&hasAllContentsSelected(e,t)})).fold(constant([]),(function(t){return findParentListContainer(e).map((function(e){var t=se.fromTag(name(e));var n=filter$3(getAllRaw(e),(function(e,t){return startsWith(t,"list-style")}));setAll(t,n);return[se.fromTag("li"),t]})).getOr([])}))};var wrap=function(e,t){var n=foldl(t,(function(e,t){append$1(t,e);return t}),e);return t.length>0?fromElements([n]):n};var directListWrappers=function(e){return ut(e)?parent(e).filter(it).fold(constant([]),(function(t){return[e,t]})):it(e)?[e]:[]};var getWrapElements=function(e,t){var n=se.fromDom(t.commonAncestorContainer);var a=parentsAndSelf(n,e);var o=filter$4(a,(function(e){return isInline$1(e)||nt(e)}));var i=getFullySelectedListWrappers(a,t);var u=o.concat(i.length?i:directListWrappers(n));return map$3(u,shallow)};var emptyFragment=function(){return fromElements([])};var getFragmentFromRange=function(e,t){return wrap(se.fromDom(t.cloneContents()),getWrapElements(e,t))};var getParentTable=function(e,t){return ancestor$2(t,"table",curry(eq,e))};var getTableFragment=function(e,t){return getParentTable(e,t[0]).bind((function(e){var n=t[0];var a=t[t.length-1];var o=fromDom(e);return subsection(o,n,a).map((function(e){return fromElements([toDom(e)])}))})).getOrThunk(emptyFragment)};var getSelectionFragment=function(e,t){return t.length>0&&t[0].collapsed?emptyFragment():getFragmentFromRange(e,t[0])};var read$3=function(e,t){var n=getCellsFromElementOrRanges(t,e);return n.length>0?getTableFragment(e,n):getSelectionFragment(e,t)};var trimLeadingCollapsibleText=function(e){return e.replace(/^[ \f\n\r\t\v]+/,"")};var isCollapsibleWhitespace=function(e,t){return t>=0&&t<e.length&&isWhiteSpace(e.charAt(t))};var getInnerText=function(e,t){var n=gt(e.innerText);return t?trimLeadingCollapsibleText(n):n};var getContextNodeName=function(e){return e.map((function(e){return e.nodeName})).getOr("div").toLowerCase()};var getTextContent=function(e){return b.from(e.selection.getRng()).map((function(t){var n=b.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock));var a=e.getBody();var o=getContextNodeName(n);var i=ie.browser.isIE()&&"pre"!==o;var u=e.dom.add(a,o,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},t.cloneContents());var c=getInnerText(u,i);var f=gt(u.textContent);e.dom.remove(u);if(isCollapsibleWhitespace(f,0)||isCollapsibleWhitespace(f,f.length-1)){var s=n.getOr(a);var l=getInnerText(s,i);var v=l.indexOf(c);if(-1===v)return c;var d=isCollapsibleWhitespace(l,v-1);var m=isCollapsibleWhitespace(l,v+c.length);return(d?" ":"")+c+(m?" ":"")}return c})).getOr("")};var getSerializedContent=function(e,t){var n=e.selection.getRng(),a=e.dom.create("body");var o=e.selection.getSel();var i=processRanges(e,getRanges(o));var u=t.contextual?read$3(se.fromDom(e.getBody()),i).dom:n.cloneContents();u&&a.appendChild(u);return e.selection.serializer.serialize(a,t)};var setupArgs$1=function(e,t){return __assign(__assign({},e),{format:t,get:true,selection:true})};var getSelectedContentInternal=function(e,t,n){void 0===n&&(n={});var a=setupArgs$1(n,t);var o=e.fire("BeforeGetContent",a);if(o.isDefaultPrevented()){e.fire("GetContent",o);return o.content}if("text"===o.format)return getTextContent(e);o.getInner=true;var i=getSerializedContent(e,o);if("tree"===o.format)return i;o.content=e.selection.isCollapsed()?"":i;e.fire("GetContent",o);return o.content};var Wo=0,Ko=1,Xo=2;var diff=function(e,t){var n=e.length+t.length+2;var a=new Array(n);var o=new Array(n);var snake=function(e,t,n){return{start:e,end:t,diag:n}};var buildScript=function(n,a,o,i,u){var c=getMiddleSnake(n,a,o,i);if(null===c||c.start===a&&c.diag===a-i||c.end===n&&c.diag===n-o){var f=n;var s=o;while(f<a||s<i)if(f<a&&s<i&&e[f]===t[s]){u.push([Wo,e[f]]);++f;++s}else if(a-n>i-o){u.push([Xo,e[f]]);++f}else{u.push([Ko,t[s]]);++s}}else{buildScript(n,c.start,o,c.start-c.diag,u);for(var l=c.start;l<c.end;++l)u.push([Wo,e[l]]);buildScript(c.end,a,c.end-c.diag,i,u)}};var buildSnake=function(n,a,o,i){var u=n;while(u-a<i&&u<o&&e[u]===t[u-a])++u;return snake(n,u,a)};var getMiddleSnake=function(n,i,u,c){var f=i-n;var s=c-u;if(0===f||0===s)return null;var l=f-s;var v=s+f;var d=(v%2===0?v:v+1)/2;a[1+d]=n;o[1+d]=i+1;var m,g,p,h,b;for(m=0;m<=d;++m){for(g=-m;g<=m;g+=2){p=g+d;g===-m||g!==m&&a[p-1]<a[p+1]?a[p]=a[p+1]:a[p]=a[p-1]+1;h=a[p];b=h-n+u-g;while(h<i&&b<c&&e[h]===t[b]){a[p]=++h;++b}if(l%2!==0&&l-m<=g&&g<=l+m&&o[p-l]<=a[p])return buildSnake(o[p-l],g+n-u,i,c)}for(g=l-m;g<=l+m;g+=2){p=g+d-l;g===l-m||g!==l+m&&o[p+1]<=o[p-1]?o[p]=o[p+1]-1:o[p]=o[p-1];h=o[p]-1;b=h-n+u-g;while(h>=n&&b>=u&&e[h]===t[b]){o[p]=h--;b--}if(l%2===0&&-m<=g&&g<=m&&o[p]<=a[p+l])return buildSnake(o[p],g+n-u,i,c)}}};var i=[];buildScript(0,e.length,0,t.length,i);return i};var getOuterHtml=function(e){return Ee(e)?e.outerHTML:Ne(e)?Ut.encodeRaw(e.data,false):_e(e)?"\x3c!--"+e.data+"--\x3e":""};var createFragment=function(e){var t;var n=document.createElement("div");var a=document.createDocumentFragment();e&&(n.innerHTML=e);while(t=n.firstChild)a.appendChild(t);return a};var insertAt=function(e,t,n){var a=createFragment(t);if(e.hasChildNodes()&&n<e.childNodes.length){var o=e.childNodes[n];o.parentNode.insertBefore(a,o)}else e.appendChild(a)};var removeAt=function(e,t){if(e.hasChildNodes()&&t<e.childNodes.length){var n=e.childNodes[t];n.parentNode.removeChild(n)}};var applyDiff=function(e,t){var n=0;each$k(e,(function(e){if(e[0]===Wo)n++;else if(e[0]===Ko){insertAt(t,e[1],n);n++}else e[0]===Xo&&removeAt(t,n)}))};var read$2=function(e){return filter$4(map$3(x(e.childNodes),getOuterHtml),(function(e){return e.length>0}))};var write=function(e,t){var n=map$3(x(t.childNodes),getOuterHtml);applyDiff(diff(n,e),t);return t};var Yo=cached((function(){return document.implementation.createHTMLDocument("undo")}));var hasIframes=function(e){return-1!==e.indexOf("</iframe>")};var createFragmentedLevel=function(e){return{type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}};var createCompleteLevel=function(e){return{type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}};var createFromEditor=function(e){var t=read$2(e.getBody());var n=bind(t,(function(t){var n=trimInternal(e.serializer,t);return n.length>0?[n]:[]}));var a=n.join("");return hasIframes(a)?createFragmentedLevel(n):createCompleteLevel(a)};var applyToEditor=function(e,t,n){var a=n?t.beforeBookmark:t.bookmark;"fragmented"===t.type?write(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:!isNonNullable(a)||!isPathBookmark(a)||!a.isFakeCaret});e.selection.moveToBookmark(a)};var getLevelContent=function(e){return"fragmented"===e.type?e.fragments.join(""):e.content};var getCleanLevelContent=function(e){var t=se.fromTag("body",Yo());set(t,getLevelContent(e));each$k(descendants(t,"*[data-mce-bogus]"),unwrap);return get$3(t)};var hasEqualContent=function(e,t){return getLevelContent(e)===getLevelContent(t)};var hasEqualCleanedContent=function(e,t){return getCleanLevelContent(e)===getCleanLevelContent(t)};var isEq$1=function(e,t){return!(!e||!t)&&(!!hasEqualContent(e,t)||hasEqualCleanedContent(e,t))};var isUnlocked=function(e){return 0===e.get()};var setTyping=function(e,t,n){isUnlocked(n)&&(e.typing=t)};var endTyping=function(e,t){if(e.typing){setTyping(e,false,t);e.add()}};var endTypingLevelIgnoreLocks=function(e){if(e.typing){e.typing=false;e.add()}};var beforeChange$1=function(e,t,n){isUnlocked(t)&&n.set(Xn(e.selection))};var addUndoLevel$1=function(e,t,n,a,o,i,u){var c=createFromEditor(e);i=i||{};i=fe.extend(i,c);if(false===isUnlocked(a)||e.removed)return null;var f=t.data[n.get()];if(e.fire("BeforeAddUndo",{level:i,lastLevel:f,originalEvent:u}).isDefaultPrevented())return null;if(f&&isEq$1(f,i))return null;t.data[n.get()]&&o.get().each((function(e){t.data[n.get()].beforeBookmark=e}));var s=getCustomUndoRedoLevels(e);if(s&&t.data.length>s){for(var l=0;l<t.data.length-1;l++)t.data[l]=t.data[l+1];t.data.length--;n.set(t.data.length)}i.bookmark=Xn(e.selection);n.get()<t.data.length-1&&(t.data.length=n.get()+1);t.data.push(i);n.set(t.data.length-1);var v={level:i,lastLevel:f,originalEvent:u};if(n.get()>0){e.setDirty(true);e.fire("AddUndo",v);e.fire("change",v)}else e.fire("AddUndo",v);return i};var clear$1=function(e,t,n){t.data=[];n.set(0);t.typing=false;e.fire("ClearUndos")};var extra$1=function(e,t,n,a,o){if(t.transact(a)){var i=t.data[n.get()].bookmark;var u=t.data[n.get()-1];applyToEditor(e,u,true);t.transact(o)&&(t.data[n.get()-1].beforeBookmark=i)}};var redo$1=function(e,t,n){var a;if(t.get()<n.length-1){t.set(t.get()+1);a=n[t.get()];applyToEditor(e,a,false);e.setDirty(true);e.fire("Redo",{level:a})}return a};var undo$1=function(e,t,n,a){var o;if(t.typing){t.add();t.typing=false;setTyping(t,false,n)}if(a.get()>0){a.set(a.get()-1);o=t.data[a.get()];applyToEditor(e,o,true);e.setDirty(true);e.fire("Undo",{level:o})}return o};var reset$1=function(e){e.clear();e.add()};var hasUndo$1=function(e,t,n){return n.get()>0||t.typing&&t.data[0]&&!isEq$1(createFromEditor(e),t.data[0])};var hasRedo$1=function(e,t){return t.get()<e.data.length-1&&!e.typing};var transact$1=function(e,t,n){endTyping(e,t);e.beforeChange();e.ignore(n);return e.add()};var ignore$1=function(e,t){try{e.set(e.get()+1);t()}finally{e.set(e.get()-1)}};var addVisualInternal=function(e,t){var n=e.dom;var a=isNonNullable(t)?t:e.getBody();v(e.hasVisual)&&(e.hasVisual=isVisualAidsEnabled(e));each$k(n.select("table,a",a),(function(t){switch(t.nodeName){case"TABLE":var a=getVisualAidsTableClass(e);var o=n.getAttrib(t,"border");o&&"0"!==o||!e.hasVisual?n.removeClass(t,a):n.addClass(t,a);break;case"A":if(!n.getAttrib(t,"href")){var i=n.getAttrib(t,"name")||t.id;var u=getVisualAidsAnchorClass(e);i&&e.hasVisual?n.addClass(t,u):n.removeClass(t,u)}break}}));e.fire("VisualAid",{element:t,hasVisual:e.hasVisual})};var makePlainAdaptor=function(e){return{undoManager:{beforeChange:function(t,n){return beforeChange$1(e,t,n)},add:function(t,n,a,o,i,u){return addUndoLevel$1(e,t,n,a,o,i,u)},undo:function(t,n,a){return undo$1(e,t,n,a)},redo:function(t,n){return redo$1(e,t,n)},clear:function(t,n){return clear$1(e,t,n)},reset:function(e){return reset$1(e)},hasUndo:function(t,n){return hasUndo$1(e,t,n)},hasRedo:function(e,t){return hasRedo$1(e,t)},transact:function(e,t,n){return transact$1(e,t,n)},ignore:function(e,t){return ignore$1(e,t)},extra:function(t,n,a,o){return extra$1(e,t,n,a,o)}},formatter:{match:function(t,n,a,o){return match$2(e,t,n,a,o)},matchAll:function(t,n){return matchAll(e,t,n)},matchNode:function(t,n,a,o){return matchNode(e,t,n,a,o)},canApply:function(t){return canApply(e,t)},closest:function(t){return closest(e,t)},apply:function(t,n,a){return applyFormat$1(e,t,n,a)},remove:function(t,n,a,o){return remove$1(e,t,n,a,o)},toggle:function(t,n,a){return toggle(e,t,n,a)},formatChanged:function(t,n,a,o,i){return formatChangedInternal(e,t,n,a,o,i)}},editor:{getContent:function(t,n){return getContentInternal(e,t,n)},setContent:function(t,n){return setContentInternal(e,t,n)},insertContent:function(t,n){return insertHtmlAtCaret(e,t,n)},addVisual:function(t){return addVisualInternal(e,t)}},selection:{getContent:function(t,n){return getSelectedContentInternal(e,t,n)}},raw:{getModel:function(){return b.none()}}}};var makeRtcAdaptor=function(e){var defaultVars=function(e){return c(e)?e:{}};var t=e.undoManager,n=e.formatter,a=e.editor,o=e.selection,i=e.raw;return{undoManager:{beforeChange:t.beforeChange,add:t.add,undo:t.undo,redo:t.redo,clear:t.clear,reset:t.reset,hasUndo:t.hasUndo,hasRedo:t.hasRedo,transact:function(e,n,a){return t.transact(a)},ignore:function(e,n){return t.ignore(n)},extra:function(e,n,a,o){return t.extra(a,o)}},formatter:{match:function(e,t,a,o){return n.match(e,defaultVars(t),o)},matchAll:n.matchAll,matchNode:n.matchNode,canApply:function(e){return n.canApply(e)},closest:function(e){return n.closest(e)},apply:function(e,t,a){return n.apply(e,defaultVars(t))},remove:function(e,t,a,o){return n.remove(e,defaultVars(t))},toggle:function(e,t,a){return n.toggle(e,defaultVars(t))},formatChanged:function(e,t,a,o,i){return n.formatChanged(t,a,o,i)}},editor:{getContent:function(e,t){return a.getContent(e)},setContent:function(e,t){return a.setContent(e,t)},insertContent:function(e,t){return a.insertContent(e)},addVisual:a.addVisual},selection:{getContent:function(e,t){return o.getContent(t)}},raw:{getModel:function(){return b.some(i.getRawModel())}}}};var makeNoopAdaptor=function(){var e=constant(null);var t=constant("");return{undoManager:{beforeChange:noop,add:e,undo:e,redo:e,clear:noop,reset:noop,hasUndo:g,hasRedo:g,transact:e,ignore:noop,extra:noop},formatter:{match:g,matchAll:constant([]),matchNode:constant(void 0),canApply:g,closest:t,apply:noop,remove:noop,toggle:noop,formatChanged:constant({unbind:noop})},editor:{getContent:t,setContent:t,insertContent:noop,addVisual:noop},selection:{getContent:t},raw:{getModel:constant(b.none())}}};var isRtc=function(e){return has$2(e.plugins,"rtc")};var getRtcSetup=function(e){return get$9(e.plugins,"rtc").bind((function(e){return b.from(e.setup)}))};var setup$i=function(e){var t=e;return getRtcSetup(e).fold((function(){t.rtcInstance=makePlainAdaptor(e);return b.none()}),(function(e){t.rtcInstance=makeNoopAdaptor();return b.some((function(){return e().then((function(e){t.rtcInstance=makeRtcAdaptor(e);return e.rtc.isRemote}))}))}))};var getRtcInstanceWithFallback=function(e){return e.rtcInstance?e.rtcInstance:makePlainAdaptor(e)};var getRtcInstanceWithError=function(e){var t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")};var beforeChange=function(e,t,n){getRtcInstanceWithError(e).undoManager.beforeChange(t,n)};var addUndoLevel=function(e,t,n,a,o,i,u){return getRtcInstanceWithError(e).undoManager.add(t,n,a,o,i,u)};var undo=function(e,t,n,a){return getRtcInstanceWithError(e).undoManager.undo(t,n,a)};var redo=function(e,t,n){return getRtcInstanceWithError(e).undoManager.redo(t,n)};var clear=function(e,t,n){getRtcInstanceWithError(e).undoManager.clear(t,n)};var reset=function(e,t){getRtcInstanceWithError(e).undoManager.reset(t)};var hasUndo=function(e,t,n){return getRtcInstanceWithError(e).undoManager.hasUndo(t,n)};var hasRedo=function(e,t,n){return getRtcInstanceWithError(e).undoManager.hasRedo(t,n)};var transact=function(e,t,n,a){return getRtcInstanceWithError(e).undoManager.transact(t,n,a)};var ignore=function(e,t,n){getRtcInstanceWithError(e).undoManager.ignore(t,n)};var extra=function(e,t,n,a,o){getRtcInstanceWithError(e).undoManager.extra(t,n,a,o)};var matchFormat=function(e,t,n,a,o){return getRtcInstanceWithError(e).formatter.match(t,n,a,o)};var matchAllFormats=function(e,t,n){return getRtcInstanceWithError(e).formatter.matchAll(t,n)};var matchNodeFormat=function(e,t,n,a,o){return getRtcInstanceWithError(e).formatter.matchNode(t,n,a,o)};var canApplyFormat=function(e,t){return getRtcInstanceWithError(e).formatter.canApply(t)};var closestFormat=function(e,t){return getRtcInstanceWithError(e).formatter.closest(t)};var applyFormat=function(e,t,n,a){getRtcInstanceWithError(e).formatter.apply(t,n,a)};var removeFormat=function(e,t,n,a,o){getRtcInstanceWithError(e).formatter.remove(t,n,a,o)};var toggleFormat=function(e,t,n,a){getRtcInstanceWithError(e).formatter.toggle(t,n,a)};var formatChanged=function(e,t,n,a,o,i){return getRtcInstanceWithError(e).formatter.formatChanged(t,n,a,o,i)};var getContent$2=function(e,t,n){return getRtcInstanceWithFallback(e).editor.getContent(t,n)};var setContent$2=function(e,t,n){return getRtcInstanceWithFallback(e).editor.setContent(t,n)};var insertContent=function(e,t,n){return getRtcInstanceWithFallback(e).editor.insertContent(t,n)};var getSelectedContent=function(e,t,n){return getRtcInstanceWithError(e).selection.getContent(t,n)};var addVisual$1=function(e,t){return getRtcInstanceWithError(e).editor.addVisual(t)};var getContent$1=function(e,t){void 0===t&&(t={});var n=t.format?t.format:"html";return getSelectedContent(e,n,t)};var removeEmpty=function(e){if(0===e.dom.length){remove$7(e);return b.none()}return b.some(e)};var walkPastBookmark=function(e,t){return e.filter((function(e){return BookmarkManager.isBookmarkNode(e.dom)})).bind(t?nextSibling:prevSibling)};var merge=function(e,t,n,a){var o=e.dom;var i=t.dom;var u=a?o.length:i.length;if(a){mergeTextNodes(o,i,false,!a);n.setStart(i,u)}else{mergeTextNodes(i,o,false,!a);n.setEnd(i,u)}};var normalizeTextIfRequired=function(e,t){parent(e).each((function(n){var a=e.dom;t&&needsToBeNbspLeft(n,CaretPosition(a,0))?normalizeWhitespaceAfter(a,0):!t&&needsToBeNbspRight(n,CaretPosition(a,a.length))&&normalizeWhitespaceBefore(a,a.length)}))};var mergeAndNormalizeText=function(e,t,n,a){e.bind((function(e){var o=a?normalizeWhitespaceBefore:normalizeWhitespaceAfter;o(e.dom,a?e.dom.length:0);return t.filter(he).map((function(t){return merge(e,t,n,a)}))})).orThunk((function(){var e=walkPastBookmark(t,a).or(t).filter(he);return e.map((function(e){return normalizeTextIfRequired(e,a)}))}))};var rngSetContent=function(e,t){var n=b.from(t.firstChild).map(se.fromDom);var a=b.from(t.lastChild).map(se.fromDom);e.deleteContents();e.insertNode(t);var o=n.bind(prevSibling).filter(he).bind(removeEmpty);var i=a.bind(nextSibling).filter(he).bind(removeEmpty);mergeAndNormalizeText(o,n,e,true);mergeAndNormalizeText(i,a,e,false);e.collapse(false)};var setupArgs=function(e,t){return __assign(__assign({format:"html"},e),{set:true,selection:true,content:t})};var cleanContent=function(e,t){if("raw"!==t.format){var n=e.selection.getRng();var a=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock);var o=a?{context:a.nodeName.toLowerCase()}:{};var i=e.parser.parse(t.content,__assign(__assign({isRootContent:true,forced_root_block:false},o),t));return HtmlSerializer({validate:e.validate},e.schema).serialize(i)}return t.content};var setContent$1=function(e,t,n){void 0===n&&(n={});var a=setupArgs(n,t);var o=a;if(!a.no_events){var i=e.fire("BeforeSetContent",a);if(i.isDefaultPrevented()){e.fire("SetContent",i);return}o=i}o.content=cleanContent(e,o);var u=e.selection.getRng();rngSetContent(u,u.createContextualFragment(o.content));e.selection.setRng(u);scrollRangeIntoView(e,u);o.no_events||e.fire("SetContent",o)};var deleteFromCallbackMap=function(e,t,n){if(e&&has$2(e,t)){var a=filter$4(e[t],(function(e){return e!==n}));0===a.length?delete e[t]:e[t]=a}};function SelectorChanged(e,t){var n;var a;var findMatchingNode=function(t,n){return find$3(n,(function(n){return e.is(n,t)}))};var getParents=function(t){return e.getParents(t,null,e.getRoot())};return{selectorChangedWithUnbind:function(e,o){if(!n){n={};a={};t.on("NodeChange",(function(e){var t=e.element;var o=getParents(t);var i={};fe.each(n,(function(e,t){findMatchingNode(t,o).each((function(n){if(!a[t]){each$k(e,(function(e){e(true,{node:n,selector:t,parents:o})}));a[t]=e}i[t]=e}))}));fe.each(a,(function(e,n){if(!i[n]){delete a[n];fe.each(e,(function(e){e(false,{node:t,selector:n,parents:o})}))}}))}))}n[e]||(n[e]=[]);n[e].push(o);findMatchingNode(e,getParents(t.selection.getStart())).each((function(){a[e]=n[e]}));return{unbind:function(){deleteFromCallbackMap(n,e,o);deleteFromCallbackMap(a,e,o)}}}}}var isNativeIeSelection=function(e){return!!e.select};var isAttachedToDom=function(e){return!!(e&&e.ownerDocument)&&contains$1(se.fromDom(e.ownerDocument),se.fromDom(e))};var isValidRange=function(e){return!!e&&(!!isNativeIeSelection(e)||isAttachedToDom(e.startContainer)&&isAttachedToDom(e.endContainer))};var EditorSelection=function(e,t,n,a){var o;var i;var u=SelectorChanged(e,a).selectorChangedWithUnbind;var setCursorLocation=function(t,n){var o=e.createRng();if(isNonNullable(t)&&isNonNullable(n)){o.setStart(t,n);o.setEnd(t,n);setRng(o);collapse(false)}else{moveEndPoint(e,o,a.getBody(),true);setRng(o)}};var getContent=function(e){return getContent$1(a,e)};var setContent=function(e,t){return setContent$1(a,e,t)};var getStart$1=function(e){return getStart(a.getBody(),getRng$1(),e)};var getEnd$1=function(e){return getEnd(a.getBody(),getRng$1(),e)};var getBookmark=function(e,t){return f.getBookmark(e,t)};var moveToBookmark=function(e){return f.moveToBookmark(e)};var select$1=function(t,n){select(e,t,n).each(setRng);return t};var isCollapsed=function(){var e=getRng$1(),t=getSel();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)};var collapse=function(e){var t=getRng$1();t.collapse(!!e);setRng(t)};var getSel=function(){return t.getSelection?t.getSelection():t.document.selection};var getRng$1=function(){var n,u,c;var tryCompareBoundaryPoints=function(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(e){return-1}};var f=t.document;if(void 0!==a.bookmark&&false===hasFocus(a)){var s=getRng(a);if(s.isSome())return s.map((function(e){return processRanges(a,[e])[0]})).getOr(f.createRange())}try{if((n=getSel())&&!isRestrictedNode(n.anchorNode)){u=n.rangeCount>0?n.getRangeAt(0):n.createRange?n.createRange():f.createRange();u=processRanges(a,[u])[0]}}catch(e){}u||(u=f.createRange?f.createRange():f.body.createTextRange());if(u.setStart&&9===u.startContainer.nodeType&&u.collapsed){c=e.getRoot();u.setStart(c,0);u.setEnd(c,0)}if(o&&i)if(0===tryCompareBoundaryPoints(u.START_TO_START,u,o)&&0===tryCompareBoundaryPoints(u.END_TO_END,u,o))u=i;else{o=null;i=null}return u};var setRng=function(e,t){var n;if(isValidRange(e)){var u=isNativeIeSelection(e)?e:null;if(u){i=null;try{u.select()}catch(e){}}else{var c=getSel();var f=a.fire("SetSelectionRange",{range:e,forward:t});e=f.range;if(c){i=e;try{c.removeAllRanges();c.addRange(e)}catch(e){}if(false===t&&c.extend){c.collapse(e.endContainer,e.endOffset);c.extend(e.startContainer,e.startOffset)}o=c.rangeCount>0?c.getRangeAt(0):null}if(!e.collapsed&&e.startContainer===e.endContainer&&c.setBaseAndExtent&&!ie.ie&&e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()){n=e.startContainer.childNodes[e.startOffset];if(n&&"IMG"===n.tagName){c.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset);c.anchorNode===e.startContainer&&c.focusNode===e.endContainer||c.setBaseAndExtent(n,0,n,1)}}a.fire("AfterSetSelectionRange",{range:e,forward:t})}}};var setNode=function(t){setContent(e.getOuterHTML(t));return t};var getNode$1=function(){return getNode(a.getBody(),getRng$1())};var getSelectedBlocks$1=function(t,n){return getSelectedBlocks(e,getRng$1(),t,n)};var isForward=function(){var t=getSel();var n=null===t||void 0===t?void 0:t.anchorNode;var a=null===t||void 0===t?void 0:t.focusNode;if(!t||!n||!a||isRestrictedNode(n)||isRestrictedNode(a))return true;var o=e.createRng();o.setStart(n,t.anchorOffset);o.collapse(true);var i=e.createRng();i.setStart(a,t.focusOffset);i.collapse(true);return o.compareBoundaryPoints(o.START_TO_START,i)<=0};var normalize=function(){var t=getRng$1();var n=getSel();if(!hasMultipleRanges(n)&&hasAnyRanges(a)){var o=normalize$2(e,t);o.each((function(e){setRng(e,isForward())}));return o.getOr(t)}return t};var selectorChanged=function(e,t){u(e,t);return c};var getScrollContainer=function(){var t;var n=e.getRoot();while(n&&"BODY"!==n.nodeName){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t};var scrollIntoView=function(e,t){isNonNullable(e)?scrollElementIntoView(a,e,t):scrollRangeIntoView(a,getRng$1(),t)};var placeCaretAt=function(e,t){return setRng(fromPoint(e,t,a.getDoc()))};var getBoundingClientRect=function(){var e=getRng$1();return e.collapsed?CaretPosition.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()};var destroy=function(){t=o=i=null;s.destroy()};var c={bookmarkManager:null,controlSelection:null,dom:e,win:t,serializer:n,editor:a,collapse:collapse,setCursorLocation:setCursorLocation,getContent:getContent,setContent:setContent,getBookmark:getBookmark,moveToBookmark:moveToBookmark,select:select$1,isCollapsed:isCollapsed,isForward:isForward,setNode:setNode,getNode:getNode$1,getSel:getSel,setRng:setRng,getRng:getRng$1,getStart:getStart$1,getEnd:getEnd$1,getSelectedBlocks:getSelectedBlocks$1,normalize:normalize,selectorChanged:selectorChanged,selectorChangedWithUnbind:u,getScrollContainer:getScrollContainer,scrollIntoView:scrollIntoView,placeCaretAt:placeCaretAt,getBoundingClientRect:getBoundingClientRect,destroy:destroy};var f=BookmarkManager(c);var s=ControlSelection(c,a);c.bookmarkManager=f;c.controlSelection=s;return c};var removeAttrs=function(e,t){each$k(t,(function(t){e.attr(t,null)}))};var addFontToSpansFilter=function(e,t,n){e.addNodeFilter("font",(function(e){each$k(e,(function(e){var a=t.parse(e.attr("style"));var o=e.attr("color");var i=e.attr("face");var u=e.attr("size");o&&(a.color=o);i&&(a["font-family"]=i);u&&(a["font-size"]=n[parseInt(e.attr("size"),10)-1]);e.name="span";e.attr("style",t.serialize(a));removeAttrs(e,["color","face","size"])}))}))};var addStrikeToSpanFilter=function(e,t){e.addNodeFilter("strike",(function(e){each$k(e,(function(e){var n=t.parse(e.attr("style"));n["text-decoration"]="line-through";e.name="span";e.attr("style",t.serialize(n))}))}))};var addFilters=function(e,t){var n=Styles();t.convert_fonts_to_spans&&addFontToSpansFilter(e,n,fe.explode(t.font_size_legacy_values));addStrikeToSpanFilter(e,n)};var register$2=function(e,t){t.inline_styles&&addFilters(e,t)};var blobUriToBlob=function(e){return new qe((function(t,n){var rejectWithError=function(){n("Cannot convert "+e+" to Blob. Resource might not exist or is inaccessible.")};try{var a=new XMLHttpRequest;a.open("GET",e,true);a.responseType="blob";a.onload=function(){200===a.status?t(a.response):rejectWithError()};a.onerror=rejectWithError;a.send()}catch(e){rejectWithError()}}))};var parseDataUri=function(e){var t;var n=decodeURIComponent(e).split(",");var a=/data:([^;]+)/.exec(n[0]);a&&(t=a[1]);return{type:t,data:n[1]}};var buildBlob=function(e,t){var n;try{n=atob(t)}catch(e){return b.none()}var a=new Uint8Array(n.length);for(var o=0;o<a.length;o++)a[o]=n.charCodeAt(o);return b.some(new Blob([a],{type:e}))};var dataUriToBlob=function(e){return new qe((function(t){var n=parseDataUri(e),a=n.type,o=n.data;buildBlob(a,o).fold((function(){return t(new Blob([]))}),t)}))};var uriToBlob=function(e){return 0===e.indexOf("blob:")?blobUriToBlob(e):0===e.indexOf("data:")?dataUriToBlob(e):null};var blobToDataUri=function(e){return new qe((function(t){var n=new FileReader;n.onloadend=function(){t(n.result)};n.readAsDataURL(e)}))};var Go=0;var uniqueId=function(e){return(e||"blobid")+Go++};var imageToBlobInfo=function(e,t,n,a){var o,i;if(0!==t.src.indexOf("blob:")){var u=parseDataUri(t.src),c=u.data,f=u.type;o=c;i=e.getByData(o,f);i?n({image:t,blobInfo:i}):uriToBlob(t.src).then((function(a){i=e.create(uniqueId(),a,o);e.add(i);n({image:t,blobInfo:i})}),(function(e){a(e)}))}else{i=e.getByUri(t.src);i?n({image:t,blobInfo:i}):uriToBlob(t.src).then((function(a){blobToDataUri(a).then((function(u){o=parseDataUri(u).data;i=e.create(uniqueId(),a,o);e.add(i);n({image:t,blobInfo:i})}))}),(function(e){a(e)}))}};var getAllImages=function(e){return e?x(e.getElementsByTagName("img")):[]};var ImageScanner=function(e,t){var n={};var findAll=function(a,o){o||(o=p);var i=filter$4(getAllImages(a),(function(t){var n=t.src;return!!ie.fileApi&&(!t.hasAttribute("data-mce-bogus")&&(!t.hasAttribute("data-mce-placeholder")&&(!(!n||n===ie.transparentSrc)&&(0===n.indexOf("blob:")?!e.isUploaded(n)&&o(t):0===n.indexOf("data:")&&o(t)))))}));var u=map$3(i,(function(e){if(void 0!==n[e.src])return new qe((function(t){n[e.src].then((function(n){if("string"===typeof n)return n;t({image:e,blobInfo:n.blobInfo})}))}));var a=new qe((function(n,a){imageToBlobInfo(t,e,n,a)})).then((function(e){delete n[e.image.src];return e})).catch((function(t){delete n[e.src];return t}));n[e.src]=a;return a}));return qe.all(u)};return{findAll:findAll}};var paddEmptyNode=function(e,t,n,a){var o=e.padd_empty_with_br||t.insert;o&&n[a.name]?a.empty().append(new Za("br",1)).shortEnded=true:a.empty().append(new Za("#text",3)).value=vt};var isPaddedWithNbsp=function(e){return hasOnlyChild(e,"#text")&&e.firstChild.value===vt};var hasOnlyChild=function(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t};var isPadded=function(e,t){var n=e.getElementRule(t.name);return n&&n.paddEmpty};var isEmpty=function(e,t,n,a){return a.isEmpty(t,n,(function(t){return isPadded(e,t)}))};var isLineBreakNode=function(e,t){return e&&(has$2(t,e.name)||"br"===e.name)};var isBogusImage=function(e){return isNonNullable(e.attr("data-mce-bogus"))};var isInternalImageSource=function(e){return e.attr("src")===ie.transparentSrc||isNonNullable(e.attr("data-mce-placeholder"))};var isValidDataImg=function(e,t){if(t.images_dataimg_filter){var n=new Image;n.src=e.attr("src");each$j(e.attributes.map,(function(e,t){n.setAttribute(t,e)}));return t.images_dataimg_filter(n)}return true};var registerBase64ImageFilter=function(e,t){var n=t.blob_cache;var processImage=function(e){var a=e.attr("src");isInternalImageSource(e)||isBogusImage(e)||parseDataUri$1(a).filter((function(){return isValidDataImg(e,t)})).bind((function(e){var t=e.type,a=e.data;return b.from(n.getByData(a,t)).orThunk((function(){return buildBlob(t,a).map((function(e){var t=n.create(uniqueId(),e,a);n.add(t);return t}))}))})).each((function(t){e.attr("src",t.blobUri())}))};n&&e.addAttributeFilter("src",(function(e){return each$k(e,processImage)}))};var register$1=function(e,t){var n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",(function(e,a,o){var i;var u=e.length;var c;var f=fe.extend({},n.getBlockElements());var s=n.getNonEmptyElements();var l,v,d,m;var g=n.getWhiteSpaceElements();var p,h;f.body=1;for(i=0;i<u;i++){c=e[i];l=c.parent;if(f[c.parent.name]&&c===l.lastChild){d=c.prev;while(d){m=d.name;if("span"!==m||"bookmark"!==d.attr("data-mce-type")){"br"===m&&(c=null);break}d=d.prev}if(c){c.remove();if(isEmpty(n,s,g,l)){p=n.getElementRule(l.name);p&&(p.removeEmpty?l.remove():p.paddEmpty&&paddEmptyNode(t,o,f,l))}}}else{v=c;while(l&&l.firstChild===v&&l.lastChild===v){v=l;if(f[l.name])break;l=l.parent}if(v===l&&true!==t.padd_empty_with_br){h=new Za("#text",3);h.value=vt;c.replace(h)}}}}));e.addAttributeFilter("href",(function(e){var n=e.length;var appendRel=function(e){var t=e.split(" ").filter((function(e){return e.length>0}));return t.concat(["noopener"]).sort().join(" ")};var addNoOpener=function(e){var t=e?fe.trim(e):"";return/\b(noopener)\b/g.test(t)?t:appendRel(t)};if(!t.allow_unsafe_link_target)while(n--){var a=e[n];"a"===a.name&&"_blank"===a.attr("target")&&a.attr("rel",addNoOpener(a.attr("rel")))}}));t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",(function(e){var t,n,a,o,i=e.length;while(i--){o=e[i];if("a"===o.name&&o.firstChild&&!o.attr("href")){a=o.parent;t=o.lastChild;do{n=t.prev;a.insert(t,o);t=n}while(t)}}}));t.fix_list_elements&&e.addNodeFilter("ul,ol",(function(e){var t,n,a=e.length;while(a--){t=e[a];n=t.parent;if("ul"===n.name||"ol"===n.name)if(t.prev&&"li"===t.prev.name)t.prev.append(t);else{var o=new Za("li",1);o.attr("style","list-style-type: none");t.wrap(o)}}}));t.validate&&n.getValidClasses()&&e.addAttributeFilter("class",(function(e){var t=n.getValidClasses();var a=e.length;while(a--){var o=e[a];var i=o.attr("class").split(" ");var u="";for(var c=0;c<i.length;c++){var f=i[c];var s=false;var l=t["*"];l&&l[f]&&(s=true);l=t[o.name];!s&&l&&l[f]&&(s=true);if(s){u&&(u+=" ");u+=f}}u.length||(u=null);o.attr("class",u)}}));registerBase64ImageFilter(e,t)};var Jo=fe.makeMap,Qo=fe.each,Zo=fe.explode,ei=fe.extend;var DomParser=function(e,t){void 0===t&&(t=Schema());var n={};var a=[];var o={};var i={};e=e||{};e.validate=!("validate"in e)||e.validate;e.root_name=e.root_name||"body";var fixInvalidChildren=function(e){var n=Jo("tr,td,th,tbody,thead,tfoot,table");var a=t.getNonEmptyElements();var o=t.getWhiteSpaceElements();var i=t.getTextBlockElements();var u=t.getSpecialElements();var removeOrUnwrapInvalidNode=function(e,n){void 0===n&&(n=e.parent);if(u[e.name])e.empty().remove();else{var a=e.children();for(var o=0,i=a;o<i.length;o++){var c=i[o];t.isValidChild(n.name,c.name)||removeOrUnwrapInvalidNode(c,n)}e.unwrap()}};for(var c=0;c<e.length;c++){var f=e[c];var s=void 0,l=void 0,v=void 0;if(f.parent&&!f.fixed)if(i[f.name]&&"li"===f.parent.name){var d=f.next;while(d){if(!i[d.name])break;d.name="li";d.fixed=true;f.parent.insert(d,f.parent);d=d.next}f.unwrap()}else{var m=[f];for(s=f.parent;s&&!t.isValidChild(s.name,f.name)&&!n[s.name];s=s.parent)m.push(s);if(s&&m.length>1)if(t.isValidChild(s.name,f.name)){m.reverse();l=filterNode(m[0].clone());var g=l;for(var p=0;p<m.length-1;p++){if(t.isValidChild(g.name,m[p].name)){v=filterNode(m[p].clone());g.append(v)}else v=g;for(var h=m[p].firstChild;h&&h!==m[p+1];){var b=h.next;v.append(h);h=b}g=v}if(isEmpty(t,a,o,l))s.insert(f,m[0],true);else{s.insert(l,m[0],true);s.insert(f,l)}s=m[0];(isEmpty(t,a,o,s)||hasOnlyChild(s,"br"))&&s.empty().remove()}else removeOrUnwrapInvalidNode(f);else if(f.parent){if("li"===f.name){d=f.prev;if(d&&("ul"===d.name||"ol"===d.name)){d.append(f);continue}d=f.next;if(d&&("ul"===d.name||"ol"===d.name)){d.insert(f,d.firstChild,true);continue}f.wrap(filterNode(new Za("ul",1)));continue}t.isValidChild(f.parent.name,"div")&&t.isValidChild("div",f.name)?f.wrap(filterNode(new Za("div",1))):removeOrUnwrapInvalidNode(f)}}}};var filterNode=function(e){var t=e.name;if(t in n){var u=o[t];u?u.push(e):o[t]=[e]}var c=a.length;while(c--){var f=a[c].name;if(f in e.attributes.map){u=i[f];u?u.push(e):i[f]=[e]}}return e};var addNodeFilter=function(e,t){Qo(Zo(e),(function(e){var a=n[e];a||(n[e]=a=[]);a.push(t)}))};var getNodeFilters=function(){var e=[];for(var t in n)has$2(n,t)&&e.push({name:t,callbacks:n[t]});return e};var addAttributeFilter=function(e,t){Qo(Zo(e),(function(e){var n;for(n=0;n<a.length;n++)if(a[n].name===e){a[n].callbacks.push(t);return}a.push({name:e,callbacks:[t]})}))};var getAttributeFilters=function(){return[].concat(a)};var parse=function(u,c){var f,s,l,v,d,m,g;var p=[];var h;var getRootBlockName=function(e){return false===e?"":true===e?"p":e};c=c||{};o={};i={};var b=ei(Jo("script,style,head,html,body,title,meta,param"),t.getBlockElements());var y=t.getNonEmptyElements();var C=t.children;var w=e.validate;var x="forced_root_block"in c?c.forced_root_block:e.forced_root_block;var S=getRootBlockName(x);var E=t.getWhiteSpaceElements();var k=/^[ \t\r\n]+/;var N=/[ \t\r\n]+$/;var _=/[ \t\r\n]+/g;var A=/^[ \t\r\n]+$/;var R=has$2(E,c.context)||has$2(E,e.root_name);var addRootBlocks=function(){var n=T.firstChild,a=null;var trim=function(e){if(e){n=e.firstChild;n&&3===n.type&&(n.value=n.value.replace(k,""));n=e.lastChild;n&&3===n.type&&(n.value=n.value.replace(N,""))}};if(t.isValidChild(T.name,S.toLowerCase())){while(n){var o=n.next;if(3===n.type||1===n.type&&"p"!==n.name&&!b[n.name]&&!n.attr("data-mce-type"))if(a)a.append(n);else{a=createNode(S,1);a.attr(e.forced_root_block_attrs);T.insert(a,n);a.append(n)}else{trim(a);a=null}n=o}trim(a)}};var createNode=function(e,t){var a=new Za(e,t);var i;if(e in n){i=o[e];i?i.push(a):o[e]=[a]}return a};var removeWhitespaceBefore=function(e){var n=t.getBlockElements();for(var a=e.prev;a&&3===a.type;){var o=a.value.replace(N,"");if(o.length>0){a.value=o;return}var i=a.next;if(i){if(3===i.type&&i.value.length){a=a.prev;continue}if(!n[i.name]&&"script"!==i.name&&"style"!==i.name){a=a.prev;continue}}var u=a.prev;a.remove();a=u}};var cloneAndExcludeBlocks=function(e){var t={};for(var n in e)"li"!==n&&"p"!==n&&(t[n]=e[n]);return t};var D=SaxParser({validate:w,document:e.document,allow_html_data_urls:e.allow_html_data_urls,allow_svg_data_urls:e.allow_svg_data_urls,allow_script_urls:e.allow_script_urls,allow_conditional_comments:e.allow_conditional_comments,preserve_cdata:e.preserve_cdata,self_closing_elements:cloneAndExcludeBlocks(t.getSelfClosingElements()),cdata:function(e){h.append(createNode("#cdata",4)).value=e},text:function(e,t){var n;if(!R){e=e.replace(_," ");isLineBreakNode(h.lastChild,b)&&(e=e.replace(k,""))}if(0!==e.length){n=createNode("#text",3);n.raw=!!t;h.append(n).value=e}},comment:function(e){h.append(createNode("#comment",8)).value=e},pi:function(e,t){h.append(createNode(e,7)).value=t;removeWhitespaceBefore(h)},doctype:function(e){var t=h.append(createNode("#doctype",10));t.value=e;removeWhitespaceBefore(h)},start:function(e,n,o){var u=w?t.getElementRule(e):{};if(u){var c=createNode(u.outputName||e,1);c.attributes=n;c.shortEnded=o;h.append(c);var f=C[h.name];f&&C[c.name]&&!f[c.name]&&p.push(c);var s=a.length;while(s--){var l=a[s].name;if(l in n.map){m=i[l];m?m.push(c):i[l]=[c]}}b[e]&&removeWhitespaceBefore(c);o||(h=c);!R&&E[e]&&(R=true)}},end:function(n){var a,o,i,u;var f=w?t.getElementRule(n):{};if(f){if(b[n]&&!R){a=h.firstChild;if(a&&3===a.type){o=a.value.replace(k,"");if(o.length>0){a.value=o;a=a.next}else{i=a.next;a.remove();a=i;while(a&&3===a.type){o=a.value;i=a.next;if(0===o.length||A.test(o)){a.remove();a=i}a=i}}}a=h.lastChild;if(a&&3===a.type){o=a.value.replace(N,"");if(o.length>0){a.value=o;a=a.prev}else{i=a.prev;a.remove();a=i;while(a&&3===a.type){o=a.value;i=a.prev;if(0===o.length||A.test(o)){a.remove();a=i}a=i}}}}R&&E[n]&&(R=false);if(f.removeEmpty&&isEmpty(t,y,E,h)){u=h.parent;b[h.name]?h.empty().remove():h.unwrap();h=u;return}f.paddEmpty&&(isPaddedWithNbsp(h)||isEmpty(t,y,E,h))&&paddEmptyNode(e,c,b,h);h=h.parent}}},t);var T=h=new Za(c.context||e.root_name,11);D.parse(u,c.format);w&&p.length&&(c.context?c.invalid=true:fixInvalidChildren(p));S&&("body"===T.name||c.isRootContent)&&addRootBlocks();if(!c.invalid){for(g in o)if(has$2(o,g)){m=n[g];f=o[g];v=f.length;while(v--)f[v].parent||f.splice(v,1);for(s=0,l=m.length;s<l;s++)m[s](f,g,c)}for(s=0,l=a.length;s<l;s++){m=a[s];if(m.name in i){f=i[m.name];v=f.length;while(v--)f[v].parent||f.splice(v,1);for(v=0,d=m.callbacks.length;v<d;v++)m.callbacks[v](f,m.name,c)}}}return T};var u={schema:t,addAttributeFilter:addAttributeFilter,getAttributeFilters:getAttributeFilters,addNodeFilter:addNodeFilter,getNodeFilters:getNodeFilters,filterNode:filterNode,parse:parse};register$1(u,e);register$2(u,e);return u};var register=function(e,t,n){e.addAttributeFilter("data-mce-tabindex",(function(e,t){var n=e.length;while(n--){var a=e[n];a.attr("tabindex",a.attr("data-mce-tabindex"));a.attr(t,null)}}));e.addAttributeFilter("src,href,style",(function(e,a){var o="data-mce-"+a;var i=t.url_converter;var u=t.url_converter_scope;var c=e.length;while(c--){var f=e[c];var s=f.attr(o);if(void 0!==s){f.attr(a,s.length>0?s:null);f.attr(o,null)}else{s=f.attr(a);"style"===a?s=n.serializeStyle(n.parseStyle(s),f.name):i&&(s=i.call(u,s,a,f.name));f.attr(a,s.length>0?s:null)}}}));e.addAttributeFilter("class",(function(e){var t=e.length;while(t--){var n=e[t];var a=n.attr("class");if(a){a=n.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,"");n.attr("class",a.length>0?a:null)}}}));e.addAttributeFilter("data-mce-type",(function(e,t,n){var a=e.length;while(a--){var o=e[a];if("bookmark"===o.attr("data-mce-type")&&!n.cleanup){var i=b.from(o.firstChild).exists((function(e){return!mt(e.value)}));i?o.unwrap():o.remove()}}}));e.addNodeFilter("noscript",(function(e){var t=e.length;while(t--){var n=e[t].firstChild;n&&(n.value=Ut.decode(n.value))}}));e.addNodeFilter("script,style",(function(e,n){var trim=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};var a=e.length;while(a--){var o=e[a];var i=o.firstChild?o.firstChild.value:"";if("script"===n){var u=o.attr("type");u&&o.attr("type","mce-no/type"===u?null:u.replace(/^mce\-/,""));"xhtml"===t.element_format&&i.length>0&&(o.firstChild.value="// <![CDATA[\n"+trim(i)+"\n// ]]>")}else"xhtml"===t.element_format&&i.length>0&&(o.firstChild.value="\x3c!--\n"+trim(i)+"\n--\x3e")}}));e.addNodeFilter("#comment",(function(e){var a=e.length;while(a--){var o=e[a];if(t.preserve_cdata&&0===o.value.indexOf("[CDATA[")){o.name="#cdata";o.type=4;o.value=n.decode(o.value.replace(/^\[CDATA\[|\]\]$/g,""))}else if(0===o.value.indexOf("mce:protected ")){o.name="#text";o.type=3;o.raw=true;o.value=unescape(o.value).substr(14)}}}));e.addNodeFilter("xml:namespace,input",(function(e,t){var n=e.length;while(n--){var a=e[n];7===a.type?a.remove():1===a.type&&("input"!==t||a.attr("type")||a.attr("type","text"))}}));e.addAttributeFilter("data-mce-type",(function(t){each$k(t,(function(t){"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(e.schema.getNonEmptyElements())?t.remove():t.unwrap())}))}));e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",(function(e,t){var n=e.length;while(n--)e[n].attr(t,null)}))};var trimTrailingBr=function(e){var isBr=function(e){return e&&"br"===e.name};var t=e.lastChild;if(isBr(t)){var n=t.prev;if(isBr(n)){t.remove();n.remove()}}};var preProcess=function(e,t,n){var a;var o=e.dom;var i=t.cloneNode(true);var u=document.implementation;if(u.createHTMLDocument){var c=u.createHTMLDocument("");fe.each("BODY"===i.nodeName?i.childNodes:[i],(function(e){c.body.appendChild(c.importNode(e,true))}));i="BODY"!==i.nodeName?c.body.firstChild:c.body;a=o.doc;o.doc=c}firePreProcess(e,__assign(__assign({},n),{node:i}));a&&(o.doc=a);return i};var shouldFireEvent=function(e,t){return e&&e.hasEventListeners("PreProcess")&&!t.no_events};var process=function(e,t,n){return shouldFireEvent(e,n)?preProcess(e,t,n):t};var addTempAttr=function(e,t,n){if(-1===fe.inArray(t,n)){e.addAttributeFilter(n,(function(e,t){var n=e.length;while(n--)e[n].attr(t,null)}));t.push(n)}};var postProcess=function(e,t,n){if(!t.no_events&&e){var a=firePostProcess(e,__assign(__assign({},t),{content:n}));return a.content}return n};var getHtmlFromNode=function(e,t,n){var a=gt(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||st(se.fromDom(t))?a:fe.trim(a)};var parseHtml=function(e,t,n){var a=n.selection?__assign({forced_root_block:false},n):n;var o=e.parse(t,a);trimTrailingBr(o);return o};var serializeNode=function(e,t,n){var a=HtmlSerializer(e,t);return a.serialize(n)};var toHtml=function(e,t,n,a,o){var i=serializeNode(t,n,a);return postProcess(e,o,i)};var DomSerializerImpl=function(e,t){var n=["data-mce-selected"];var a=t&&t.dom?t.dom:DOMUtils.DOM;var o=t&&t.schema?t.schema:Schema(e);e.entity_encoding=e.entity_encoding||"named";e.remove_trailing_brs=!("remove_trailing_brs"in e)||e.remove_trailing_brs;var i=DomParser(e,o);register(i,e,a);var serialize=function(n,u){void 0===u&&(u={});var c=__assign({format:"html"},u);var f=process(t,n,c);var s=getHtmlFromNode(a,f,c);var l=parseHtml(i,s,c);return"tree"===c.format?l:toHtml(t,e,o,l,c)};return{schema:o,addNodeFilter:i.addNodeFilter,addAttributeFilter:i.addAttributeFilter,serialize:serialize,addRules:o.addValidElements,setRules:o.setValidElements,addTempAttr:curry(addTempAttr,i,n),getTempAttrs:constant(n),getNodeFilters:i.getNodeFilters,getAttributeFilters:i.getAttributeFilters}};var DomSerializer=function(e,t){var n=DomSerializerImpl(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters}};var ti="html";var getContent=function(e,t){void 0===t&&(t={});var n=t.format?t.format:ti;return getContent$2(e,t,n)};var setContent=function(e,t,n){void 0===n&&(n={});return setContent$2(e,t,n)};var ri=DOMUtils.DOM;var restoreOriginalStyles=function(e){ri.setStyle(e.id,"display",e.orgDisplay)};var safeDestroy=function(e){return b.from(e).each((function(e){return e.destroy()}))};var clearDomReferences=function(e){e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null;e.bodyElement=e.contentDocument=e.contentWindow=null;e.iframeElement=e.targetElm=null;e.selection&&(e.selection=e.selection.win=e.selection.dom=e.selection.dom.doc=null)};var restoreForm=function(e){var t=e.formElement;if(t){if(t._mceOldSubmit){t.submit=t._mceOldSubmit;t._mceOldSubmit=null}ri.unbind(t,"submit reset",e.formEventDelegate)}};var remove=function(e){if(!e.removed){var t=e._selectionOverrides,n=e.editorUpload;var a=e.getBody();var o=e.getElement();a&&e.save({is_removing:true});e.removed=true;e.unbindAllNativeEvents();e.hasHiddenInput&&o&&ri.remove(o.nextSibling);fireRemove(e);e.editorManager.remove(e);!e.inline&&a&&restoreOriginalStyles(e);fireDetach(e);ri.remove(e.getContainer());safeDestroy(t);safeDestroy(n);e.destroy()}};var destroy=function(e,t){var n=e.selection,a=e.dom;if(!e.destroyed)if(t||e.removed){if(!t){e.editorManager.off("beforeunload",e._beforeUnload);e.theme&&e.theme.destroy&&e.theme.destroy();safeDestroy(n);safeDestroy(a)}restoreForm(e);clearDomReferences(e);e.destroyed=true}else e.remove()};var deep=function(e,t){var n=c(e)&&c(t);return n?ni(e,t):t};var baseMerge=function(e){return function(){var t=[];for(var n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");var a={};for(var o=0;o<t.length;o++){var i=t[o];for(var u in i)has$2(i,u)&&(a[u]=e(a[u],i[u]))}return a}};var ni=baseMerge(deep);var ai="autoresize_on_init,content_editable_state,convert_fonts_to_spans,inline_styles,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(",");var oi="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(",");var ii="imagetools,toc".split(",");var getDeprecatedSettings=function(e){var t=filter$4(ai,(function(t){return has$2(e,t)}));var n=e.forced_root_block;false!==n&&""!==n||t.push("forced_root_block (false only)");return sort(t)};var getDeprecatedPlugins=function(e){var t=fe.makeMap(e.plugins," ");var hasPlugin=function(e){return has$2(t,e)};var n=__spreadArray(__spreadArray([],filter$4(oi,hasPlugin),true),bind(ii,(function(e){return hasPlugin(e)?[e+" (moving to premium)"]:[]})),true);return sort(n)};var logDeprecationsWarning=function(e,t){var n=getDeprecatedSettings(e);var a=getDeprecatedPlugins(t);var o=a.length>0;var i=n.length>0;var u="mobile"===t.theme;if(o||i||u){var c="\n- ";var f=u?"\n\nThemes:"+c+"mobile":"";var s=o?"\n\nPlugins:"+c+a.join(c):"";var l=i?"\n\nSettings:"+c+n.join(c):"";console.warn("The following deprecated features are currently enabled, these will be removed in TinyMCE 6.0. See https://www.tiny.cloud/docs/release-notes/6.0-upcoming-changes/ for more information."+f+s+l)}};var sectionResult=function(e,t){return{sections:constant(e),settings:constant(t)}};var ui=detect().deviceType;var ci=ui.isTouch();var fi=ui.isPhone();var si=ui.isTablet();var li=["lists","autolink","autosave"];var vi={table_grid:false,object_resizing:false,resize:false};var normalizePlugins=function(e){var t=f(e)?e.join(" "):e;var n=map$3(u(t)?t.split(" "):[],_);return filter$4(n,(function(e){return e.length>0}))};var filterLegacyMobilePlugins=function(e){return filter$4(e,curry(contains$3,li))};var extractSections=function(e,t){var n=bifilter(t,(function(t,n){return contains$3(e,n)}));return sectionResult(n.t,n.f)};var getSection=function(e,t,n){void 0===n&&(n={});var a=e.sections();var o=get$9(a,t).getOr({});return fe.extend({},n,o)};var hasSection=function(e,t){return has$2(e.sections(),t)};var isSectionTheme=function(e,t,n){var a=e.sections();return hasSection(e,t)&&a[t].theme===n};var getSectionConfig=function(e,t){return hasSection(e,t)?e.sections()[t]:{}};var getToolbarMode=function(e,t){return get$9(e,"toolbar_mode").orThunk((function(){return get$9(e,"toolbar_drawer").map((function(e){return false===e?"wrap":e}))})).getOr(t)};var getDefaultSettings=function(e,t,n,a,o){var i={id:t,theme:"silver",toolbar_mode:getToolbarMode(e,"floating"),plugins:"",document_base_url:n,add_form_submit_trigger:true,submit_patch:true,add_unload_trigger:true,convert_urls:true,relative_urls:true,remove_script_host:true,object_resizing:true,doctype:"<!DOCTYPE html>",visual:true,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:true,inline_styles:true,convert_fonts_to_spans:true,indent:true,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:o.convertURL,url_converter_scope:o};return __assign(__assign({},i),a?vi:{})};var getDefaultMobileSettings=function(e,t){var n={resize:false,toolbar_mode:getToolbarMode(e,"scrolling"),toolbar_sticky:false};var a={menubar:false};return __assign(__assign(__assign({},vi),n),t?a:{})};var getExternalPlugins=function(e,t){var n=t.external_plugins?t.external_plugins:{};return e&&e.external_plugins?fe.extend({},e.external_plugins,n):n};var combinePlugins=function(e,t){return[].concat(normalizePlugins(e)).concat(normalizePlugins(t))};var getPlatformPlugins=function(e,t,n,a){return e&&isSectionTheme(t,"mobile","mobile")?filterLegacyMobilePlugins(a):e&&hasSection(t,"mobile")?a:n};var processPlugins=function(e,t,n,a){var o=normalizePlugins(n.forced_plugins);var i=normalizePlugins(a.plugins);var u=getSectionConfig(t,"mobile");var c=u.plugins?normalizePlugins(u.plugins):i;var f=getPlatformPlugins(e,t,i,c);var s=combinePlugins(o,f);if(ie.browser.isIE()&&contains$3(s,"rtc"))throw new Error("RTC plugin is not supported on IE 11.");return fe.extend(a,{plugins:s.join(" ")})};var isOnMobile=function(e,t){return e&&hasSection(t,"mobile")};var combineSettings=function(e,t,n,a,o){var i=e?{mobile:getDefaultMobileSettings(o.mobile||{},t)}:{};var u=extractSections(["mobile"],ni(i,o));var c=fe.extend(n,a,u.settings(),isOnMobile(e,u)?getSection(u,"mobile"):{},{validate:true,external_plugins:getExternalPlugins(a,u.settings())});return processPlugins(e,u,a,c)};var getEditorSettings=function(e,t,n,a,o){var i=getDefaultSettings(o,t,n,ci,e);var u=combineSettings(fi||si,fi,i,a,o);false!==u.deprecation_warnings&&logDeprecationsWarning(o,u);return u};var getFiltered=function(e,t,n){return b.from(t.settings[n]).filter(e)};var getParamObject=function(e){var t={};"string"===typeof e?each$k(e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(","),(function(e){var n=e.split("=");n.length>1?t[fe.trim(n[0])]=fe.trim(n[1]):t[fe.trim(n[0])]=fe.trim(n[0])})):t=e;return t};var isArrayOf=function(e){return function(t){return f(t)&&forall(t,e)}};var getParam=function(e,t,n,a){var o=t in e.settings?e.settings[t]:n;return"hash"===a?getParamObject(o):"string"===a?getFiltered(u,e,t).getOr(n):"number"===a?getFiltered(m,e,t).getOr(n):"boolean"===a?getFiltered(l,e,t).getOr(n):"object"===a?getFiltered(c,e,t).getOr(n):"array"===a?getFiltered(f,e,t).getOr(n):"string[]"===a?getFiltered(isArrayOf(u),e,t).getOr(n):"function"===a?getFiltered(d,e,t).getOr(n):o};var CreateIconManager=function(){var e={};var add=function(t,n){e[t]=n};var get=function(t){return e[t]?e[t]:{icons:{}}};var has=function(t){return has$2(e,t)};return{add:add,get:get,has:has}};var di=CreateIconManager();var getProp=function(e,t){var n=t.dom;return n[e]};var getComputedSizeProp=function(e,t){return parseInt(get$5(t,e),10)};var mi=curry(getProp,"clientWidth");var gi=curry(getProp,"clientHeight");var pi=curry(getComputedSizeProp,"margin-top");var hi=curry(getComputedSizeProp,"margin-left");var getBoundingClientRect=function(e){return e.dom.getBoundingClientRect()};var isInsideElementContentArea=function(e,t,n){var a=mi(e);var o=gi(e);return t>=0&&n>=0&&t<=a&&n<=o};var transpose=function(e,t,n,a){var o=getBoundingClientRect(t);var i=e?o.left+t.dom.clientLeft+hi(t):0;var u=e?o.top+t.dom.clientTop+pi(t):0;var c=n-i;var f=a-u;return{x:c,y:f}};var isXYInContentArea=function(e,t,n){var a=se.fromDom(e.getBody());var o=e.inline?a:documentElement(a);var i=transpose(e.inline,o,t,n);return isInsideElementContentArea(o,i.x,i.y)};var fromDomSafe=function(e){return b.from(e).map(se.fromDom)};var isEditorAttachedToDom=function(e){var t=e.inline?e.getBody():e.getContentAreaContainer();return fromDomSafe(t).map(inBody).getOr(false)};var NotificationManagerImpl=function(){var unimplemented=function(){throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:unimplemented,close:unimplemented,reposition:unimplemented,getArgs:unimplemented}};var NotificationManager=function(e){var t=[];var getImplementation=function(){var t=e.theme;return t&&t.getNotificationManagerImpl?t.getNotificationManagerImpl():NotificationManagerImpl()};var getTopNotification=function(){return b.from(t[0])};var isEqual=function(e,t){return e.type===t.type&&e.text===t.text&&!e.progressBar&&!e.timeout&&!t.progressBar&&!t.timeout};var reposition=function(){t.length>0&&getImplementation().reposition(t)};var addNotification=function(e){t.push(e)};var closeNotification=function(e){findIndex$2(t,(function(t){return t===e})).each((function(e){t.splice(e,1)}))};var open=function(n,a){void 0===a&&(a=true);if(!e.removed&&isEditorAttachedToDom(e)){a&&e.fire("BeforeOpenNotification",{notification:n});return find$3(t,(function(e){return isEqual(getImplementation().getArgs(e),n)})).getOrThunk((function(){e.editorManager.setActive(e);var t=getImplementation().open(n,(function(){closeNotification(t);reposition();getTopNotification().fold((function(){return e.focus()}),(function(e){return focus$1(se.fromDom(e.getEl()))}))}));addNotification(t);reposition();e.fire("OpenNotification",{notification:__assign({},t)});return t}))}};var close=function(){getTopNotification().each((function(e){getImplementation().close(e);closeNotification(e);reposition()}))};var n=constant(t);var registerEvents=function(e){e.on("SkinLoaded",(function(){var t=getServiceMessage(e);t&&open({text:t,type:"warning",timeout:0},false);reposition()}));e.on("show ResizeEditor ResizeWindow NodeChange",(function(){We.requestAnimationFrame(reposition)}));e.on("remove",(function(){each$k(t.slice(),(function(e){getImplementation().close(e)}))}))};registerEvents(e);return{open:open,close:close,getNotifications:n}};var bi=AddOnManager.PluginManager;var yi=AddOnManager.ThemeManager;function WindowManagerImpl(){var unimplemented=function(){throw new Error("Theme did not provide a WindowManager implementation.")};return{open:unimplemented,openUrl:unimplemented,alert:unimplemented,confirm:unimplemented,close:unimplemented,getParams:unimplemented,setParams:unimplemented}}var WindowManager=function(e){var t=[];var getImplementation=function(){var t=e.theme;return t&&t.getWindowManagerImpl?t.getWindowManagerImpl():WindowManagerImpl()};var funcBind=function(e,t){return function(){var n=[];for(var a=0;a<arguments.length;a++)n[a]=arguments[a];return t?t.apply(e,n):void 0}};var fireOpenEvent=function(t){e.fire("OpenWindow",{dialog:t})};var fireCloseEvent=function(t){e.fire("CloseWindow",{dialog:t})};var addDialog=function(e){t.push(e);fireOpenEvent(e)};var closeDialog=function(n){fireCloseEvent(n);t=filter$4(t,(function(e){return e!==n}));0===t.length&&e.focus()};var getTopDialog=function(){return b.from(t[t.length-1])};var storeSelectionAndOpenDialog=function(t){e.editorManager.setActive(e);store(e);var n=t();addDialog(n);return n};var open=function(e,t){return storeSelectionAndOpenDialog((function(){return getImplementation().open(e,t,closeDialog)}))};var openUrl=function(e){return storeSelectionAndOpenDialog((function(){return getImplementation().openUrl(e,closeDialog)}))};var alert=function(e,t,n){var a=getImplementation();a.alert(e,funcBind(n||a,t))};var confirm=function(e,t,n){var a=getImplementation();a.confirm(e,funcBind(n||a,t))};var close=function(){getTopDialog().each((function(e){getImplementation().close(e);closeDialog(e)}))};e.on("remove",(function(){each$k(t,(function(e){getImplementation().close(e)}))}));return{open:open,openUrl:openUrl,alert:alert,confirm:confirm,close:close}};var displayNotification=function(e,t){e.notificationManager.open({type:"error",text:t})};var displayError=function(e,t){e._skinLoaded?displayNotification(e,t):e.on("SkinLoaded",(function(){displayNotification(e,t)}))};var uploadError=function(e,t){displayError(e,_n.translate(["Failed to upload image: {0}",t]))};var logError=function(e,t,n){fireError(e,t,{message:n});console.error(n)};var createLoadError=function(e,t,n){return n?"Failed to load "+e+": "+n+" from url "+t:"Failed to load "+e+" url: "+t};var pluginLoadError=function(e,t,n){logError(e,"PluginLoadError",createLoadError("plugin",t,n))};var iconsLoadError=function(e,t,n){logError(e,"IconsLoadError",createLoadError("icons",t,n))};var languageLoadError=function(e,t,n){logError(e,"LanguageLoadError",createLoadError("language",t,n))};var pluginInitError=function(e,t,n){var a=_n.translate(["Failed to initialize plugin: {0}",t]);fireError(e,"PluginLoadError",{message:a});initError(a,n);displayError(e,a)};var initError=function(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];var a=window.console;a&&(a.error?a.error.apply(a,__spreadArray([e],t,false)):a.log.apply(a,__spreadArray([e],t,false)))};var isContentCssSkinName=function(e){return/^[a-z0-9\-]+$/i.test(e)};var getContentCssUrls=function(e){return transformToUrls(e,getContentCss(e))};var getFontCssUrls=function(e){return transformToUrls(e,getFontCss(e))};var transformToUrls=function(e,t){var n=e.editorManager.baseURL+"/skins/content";var a=e.editorManager.suffix;var o="content"+a+".css";var i=true===e.inline;return map$3(t,(function(t){return isContentCssSkinName(t)&&!i?n+"/"+t+"/"+o:e.documentBaseURI.toAbsolute(t)}))};var appendContentCssFromSettings=function(e){e.contentCSS=e.contentCSS.concat(getContentCssUrls(e),getFontCssUrls(e))};var UploadStatus=function(){var e=1,t=2;var n={};var createStatus=function(e,t){return{status:e,resultUri:t}};var hasBlobUri=function(e){return e in n};var getResultUri=function(e){var t=n[e];return t?t.resultUri:null};var isPending=function(t){return!!hasBlobUri(t)&&n[t].status===e};var isUploaded=function(e){return!!hasBlobUri(e)&&n[e].status===t};var markPending=function(t){n[t]=createStatus(e,null)};var markUploaded=function(e,a){n[e]=createStatus(t,a)};var removeFailed=function(e){delete n[e]};var destroy=function(){n={}};return{hasBlobUri:hasBlobUri,getResultUri:getResultUri,isPending:isPending,isUploaded:isUploaded,markPending:markPending,markUploaded:markUploaded,removeFailed:removeFailed,destroy:destroy}};var Ci=0;var seed=function(){var rnd=function(){return Math.round(4294967295*Math.random()).toString(36)};var e=(new Date).getTime();return"s"+e.toString(36)+rnd()+rnd()+rnd()};var uuid=function(e){return e+Ci+++seed()};var BlobCache=function(){var e=[];var mimeToExt=function(e){var t={"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"};return t[e.toLowerCase()]||"dat"};var create=function(e,t,n,a,o){if(u(e)){var i=e;return toBlobInfo({id:i,name:a,filename:o,blob:t,base64:n})}if(c(e))return toBlobInfo(e);throw new Error("Unknown input type")};var toBlobInfo=function(e){if(!e.blob||!e.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");var t=e.id||uuid("blobid");var n=e.name||t;var a=e.blob;return{id:constant(t),name:constant(n),filename:constant(e.filename||n+"."+mimeToExt(a.type)),blob:constant(a),base64:constant(e.base64),blobUri:constant(e.blobUri||URL.createObjectURL(a)),uri:constant(e.uri)}};var add=function(t){get(t.id())||e.push(t)};var findFirst=function(t){return find$3(e,t).getOrUndefined()};var get=function(e){return findFirst((function(t){return t.id()===e}))};var getByUri=function(e){return findFirst((function(t){return t.blobUri()===e}))};var getByData=function(e,t){return findFirst((function(n){return n.base64()===e&&n.blob().type===t}))};var removeByUri=function(t){e=filter$4(e,(function(e){if(e.blobUri()===t){URL.revokeObjectURL(e.blobUri());return false}return true}))};var destroy=function(){each$k(e,(function(e){URL.revokeObjectURL(e.blobUri())}));e=[]};return{create:create,add:add,get:get,getByUri:getByUri,getByData:getByData,findFirst:findFirst,removeByUri:removeByUri,destroy:destroy}};var Uploader=function(e,t){var n={};var pathJoin=function(e,t){return e?e.replace(/\/$/,"")+"/"+t.replace(/^\//,""):t};var defaultHandler=function(e,n,a,o){var i=new XMLHttpRequest;i.open("POST",t.url);i.withCredentials=t.credentials;i.upload.onprogress=function(e){o(e.loaded/e.total*100)};i.onerror=function(){a("Image upload failed due to a XHR Transport error. Code: "+i.status)};i.onload=function(){if(i.status<200||i.status>=300)a("HTTP Error: "+i.status);else{var e=JSON.parse(i.responseText);e&&"string"===typeof e.location?n(pathJoin(t.basePath,e.location)):a("Invalid JSON: "+i.responseText)}};var u=new FormData;u.append("file",e.blob(),e.filename());i.send(u)};var noUpload=function(){return new qe((function(e){e([])}))};var handlerSuccess=function(e,t){return{url:t,blobInfo:e,status:true}};var handlerFailure=function(e,t,n){return{url:"",blobInfo:e,status:false,error:{message:t,options:n}}};var resolvePending=function(e,t){fe.each(n[e],(function(e){e(t)}));delete n[e]};var uploadBlobInfo=function(t,n,a){e.markPending(t.blobUri());return new qe((function(o){var i,u;try{var closeNotification_1=function(){if(i){i.close();u=noop}};var success=function(n){closeNotification_1();e.markUploaded(t.blobUri(),n);resolvePending(t.blobUri(),handlerSuccess(t,n));o(handlerSuccess(t,n))};var failure=function(n,a){var i=a||{};closeNotification_1();e.removeFailed(t.blobUri());resolvePending(t.blobUri(),handlerFailure(t,n,i));o(handlerFailure(t,n,i))};u=function(e){e<0||e>100||b.from(i).orThunk((function(){return b.from(a).map(apply)})).each((function(t){i=t;t.progressBar.value(e)}))};n(t,success,failure,u)}catch(e){o(handlerFailure(t,e.message,{}))}}))};var isDefaultHandler=function(e){return e===defaultHandler};var pendingUploadBlobInfo=function(e){var t=e.blobUri();return new qe((function(e){n[t]=n[t]||[];n[t].push(e)}))};var uploadBlobs=function(n,a){n=fe.grep(n,(function(t){return!e.isUploaded(t.blobUri())}));return qe.all(fe.map(n,(function(n){return e.isPending(n.blobUri())?pendingUploadBlobInfo(n):uploadBlobInfo(n,t.handler,a)})))};var upload=function(e,n){return!t.url&&isDefaultHandler(t.handler)?noUpload():uploadBlobs(e,n)};false===d(t.handler)&&(t.handler=defaultHandler);return{upload:upload}};var openNotification=function(e){return function(){return e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:true})}};var createUploader=function(e,t){return Uploader(t,{url:getImageUploadUrl(e),basePath:getImageUploadBasePath(e),credentials:getImagesUploadCredentials(e),handler:getImagesUploadHandler(e)})};var ImageUploader=function(e){var t=UploadStatus();var n=createUploader(e,t);return{upload:function(t,a){void 0===a&&(a=true);return n.upload(t,a?openNotification(e):void 0)}}};var UploadChangeHandler=function(e){var t=Cell(null);e.on("change AddUndo",(function(e){t.set(__assign({},e.level))}));var fireIfChanged=function(){var n=e.undoManager.data;last$2(n).filter((function(e){return!isEq$1(t.get(),e)})).each((function(t){e.setDirty(true);e.fire("change",{level:t,lastLevel:get$a(n,n.length-2).getOrNull()})}))};return{fireIfChanged:fireIfChanged}};var EditorUpload=function(e){var t=BlobCache();var n,a;var o=UploadStatus();var i=[];var u=UploadChangeHandler(e);var aliveGuard=function(t){return function(n){return e.selection?t(n):[]}};var cacheInvalidator=function(e){return e+(-1===e.indexOf("?")?"?":"&")+(new Date).getTime()};var replaceString=function(e,t,n){var a=0;do{a=e.indexOf(t,a);if(-1!==a){e=e.substring(0,a)+n+e.substr(a+t.length);a+=n.length-t.length+1}}while(-1!==a);return e};var replaceImageUrl=function(e,t,n){var a='src="'+n+'"'+(n===ie.transparentSrc?' data-mce-placeholder="1"':"");e=replaceString(e,'src="'+t+'"',a);e=replaceString(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"');return e};var replaceUrlInUndoStack=function(t,n){each$k(e.undoManager.data,(function(e){"fragmented"===e.type?e.fragments=map$3(e.fragments,(function(e){return replaceImageUrl(e,t,n)})):e.content=replaceImageUrl(e.content,t,n)}))};var replaceImageUriInView=function(t,n){var a=e.convertURL(n,"src");replaceUrlInUndoStack(t.src,n);e.$(t).attr({src:shouldReuseFileName(e)?cacheInvalidator(n):n,"data-mce-src":a})};var uploadImages=function(a){n||(n=createUploader(e,o));return scanForImages().then(aliveGuard((function(o){var i=map$3(o,(function(e){return e.blobInfo}));return n.upload(i,openNotification(e)).then(aliveGuard((function(n){var i=[];var c=map$3(n,(function(n,a){var u=o[a].blobInfo;var c=o[a].image;if(n.status&&shouldReplaceBlobUris(e)){t.removeByUri(c.src);isRtc(e)||replaceImageUriInView(c,n.url)}else if(n.error){if(n.error.options.remove){replaceUrlInUndoStack(c.getAttribute("src"),ie.transparentSrc);i.push(c)}uploadError(e,n.error.message)}return{element:c,status:n.status,uploadUri:n.url,blobInfo:u}}));c.length>0&&u.fireIfChanged();i.length>0&&(isRtc(e)?console.error("Removing images on failed uploads is currently unsupported for RTC"):e.undoManager.transact((function(){each$k(i,(function(n){e.dom.remove(n);t.removeByUri(n.src)}))})));a&&a(c);return c})))})))};var uploadImagesAuto=function(t){if(isAutomaticUploadsEnabled(e))return uploadImages(t)};var isValidDataUriImage=function(t){if(false===forall(i,(function(e){return e(t)})))return false;if(0===t.getAttribute("src").indexOf("data:")){var n=getImagesDataImgFilter(e);return n(t)}return true};var addFilter=function(e){i.push(e)};var scanForImages=function(){a||(a=ImageScanner(o,t));return a.findAll(e.getBody(),isValidDataUriImage).then(aliveGuard((function(t){t=filter$4(t,(function(t){if("string"===typeof t){displayError(e,t);return false}return true}));isRtc(e)||each$k(t,(function(e){replaceUrlInUndoStack(e.image.src,e.blobInfo.blobUri());e.image.src=e.blobInfo.blobUri();e.image.removeAttribute("data-mce-src")}));return t})))};var destroy=function(){t.destroy();o.destroy();a=n=null};var replaceBlobUris=function(n){return n.replace(/src="(blob:[^"]+)"/g,(function(n,a){var i=o.getResultUri(a);if(i)return'src="'+i+'"';var u=t.getByUri(a);u||(u=foldl(e.editorManager.get(),(function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(a)}),null));if(u){var c=u.blob();return'src="data:'+c.type+";base64,"+u.base64()+'"'}return n}))};e.on("SetContent",(function(){isAutomaticUploadsEnabled(e)?uploadImagesAuto():scanForImages()}));e.on("RawSaveContent",(function(e){e.content=replaceBlobUris(e.content)}));e.on("GetContent",(function(e){e.source_view||"raw"===e.format||"tree"===e.format||(e.content=replaceBlobUris(e.content))}));e.on("PostRender",(function(){e.parser.addNodeFilter("img",(function(e){each$k(e,(function(e){var n=e.attr("src");if(!t.getByUri(n)){var a=o.getResultUri(n);a&&e.attr("src",a)}}))}))}));return{blobCache:t,addFilter:addFilter,uploadImages:uploadImages,uploadImagesAuto:uploadImagesAuto,scanForImages:scanForImages,destroy:destroy}};var get=function(e){var t={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:false,classes:"align-left",ceFalseOverride:true,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:false,preview:false,defaultBlock:"div"},{selector:"img,table,audio,video",collapsed:false,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:false,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:false,classes:"align-center",ceFalseOverride:true,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:false,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:false},{selector:"table",collapsed:false,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:false,classes:"align-right",ceFalseOverride:true,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:false,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table,audio,video",collapsed:false,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:false,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"strike",remove:"all",preserve_attributes:["class","style"]},{inline:"s",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:true,remove_similar:true,clear_child_styles:true},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:true,remove_similar:true,clear_child_styles:true},fontname:{inline:"span",toggle:false,styles:{fontFamily:"%value"},clear_child_styles:true},fontsize:{inline:"span",toggle:false,styles:{fontSize:"%value"},clear_child_styles:true},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",defaultBlock:"p",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:true,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:true,deep:true,onmatch:function(e,t,n){return Ee(e)&&e.hasAttribute("href")},onformat:function(t,n,a){fe.each(a,(function(n,a){e.setAttrib(t,a,n)}))}},lang:{inline:"span",clear_child_styles:true,remove_similar:true,attributes:{lang:"%value","data-mce-lang":function(e){var t;return null!==(t=null===e||void 0===e?void 0:e.customValue)&&void 0!==t?t:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}]};fe.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),(function(e){t[e]={block:e,remove:"all"}}));return t};var FormatRegistry=function(e){var t={};var get$1=function(e){return isNonNullable(e)?t[e]:t};var has=function(e){return has$2(t,e)};var register=function(e,n){if(e)if(u(e)){f(n)||(n=[n]);each$k(n,(function(e){v(e.deep)&&(e.deep=!isSelectorFormat(e));v(e.split)&&(e.split=!isSelectorFormat(e)||isInlineFormat(e));v(e.remove)&&isSelectorFormat(e)&&!isInlineFormat(e)&&(e.remove="none");if(isSelectorFormat(e)&&isInlineFormat(e)){e.mixed=true;e.block_expand=true}u(e.classes)&&(e.classes=e.classes.split(/\s+/))}));t[e]=n}else each$j(e,(function(e,t){register(t,e)}))};var unregister=function(e){e&&t[e]&&delete t[e];return t};register(get(e.dom));register(getFormats(e));return{get:get$1,has:has,register:register,unregister:unregister}};var wi=fe.each;var xi=DOMUtils.DOM;var parsedSelectorToHtml=function(e,t){var n,a,o;var i=t&&t.schema||Schema({});var decorate=function(e,t){t.classes.length&&xi.addClass(e,t.classes.join(" "));xi.setAttribs(e,t.attrs)};var createElement=function(e){a="string"===typeof e?{name:e,classes:[],attrs:{}}:e;var t=xi.create(a.name);decorate(t,a);return t};var getRequiredParent=function(e,t){var n="string"!==typeof e?e.nodeName.toLowerCase():e;var a=i.getElementRule(n);var o=a&&a.parentsRequired;return!(!o||!o.length)&&(t&&-1!==fe.inArray(o,t)?t:o[0])};var wrapInHtml=function(e,t,n){var a,o;var i=t.length>0&&t[0];var u=i&&i.name;var c=getRequiredParent(e,u);if(c)if(u===c){o=t[0];t=t.slice(1)}else o=c;else if(i){o=t[0];t=t.slice(1)}else if(!n)return e;if(o){a=createElement(o);a.appendChild(e)}if(n){if(!a){a=xi.create("div");a.appendChild(e)}fe.each(n,(function(t){var n=createElement(t);a.insertBefore(n,e)}))}return wrapInHtml(a,t,o&&o.siblings)};if(e&&e.length){a=e[0];n=createElement(a);o=xi.create("div");o.appendChild(wrapInHtml(n,e.slice(1),a.siblings));return o}return""};var parseSelectorItem=function(e){var t;var n={classes:[],attrs:{}};e=n.selector=fe.trim(e);"*"!==e&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(function(e,t,a,o,i){switch(t){case"#":n.attrs.id=a;break;case".":n.classes.push(a);break;case":":-1!==fe.inArray("checked disabled enabled read-only required".split(" "),a)&&(n.attrs[a]=a);break}if("["===o){var u=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);u&&(n.attrs[u[1]]=u[2])}return""})));n.name=t||"div";return n};var parseSelector=function(e){if(!e||"string"!==typeof e)return[];e=e.split(/\s*,\s*/)[0];e=e.replace(/\s*(~\+|~|\+|>)\s*/g,"$1");return fe.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),(function(e){var t=fe.map(e.split(/(?:~\+|~|\+)/),parseSelectorItem);var n=t.pop();t.length&&(n.siblings=t);return n})).reverse()};var getCssText=function(e,t){var n,a;var o,i="";var u=getPreviewStyles(e);if(""===u)return"";var removeVars=function(e){return e.replace(/%(\w+)/g,"")};if("string"===typeof t){t=e.formatter.get(t);if(!t)return;t=t[0]}if("preview"in t){var c=get$9(t,"preview");if(is$1(c,false))return"";u=c.getOr(u)}n=t.block||t.inline||"span";var f=parseSelector(t.selector);if(f.length){f[0].name||(f[0].name=n);n=t.selector;a=parsedSelectorToHtml(f,e)}else a=parsedSelectorToHtml([n],e);var s=xi.select(n,a)[0]||a.firstChild;wi(t.styles,(function(e,t){var n=removeVars(e);n&&xi.setStyle(s,t,n)}));wi(t.attributes,(function(e,t){var n=removeVars(e);n&&xi.setAttrib(s,t,n)}));wi(t.classes,(function(e){var t=removeVars(e);xi.hasClass(s,t)||xi.addClass(s,t)}));e.fire("PreviewFormats");xi.setStyles(a,{position:"absolute",left:-65535});e.getBody().appendChild(a);o=xi.getStyle(e.getBody(),"fontSize",true);o=/px$/.test(o)?parseInt(o,10):0;wi(u.split(" "),(function(t){var n=xi.getStyle(s,t,true);if("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)){n=xi.getStyle(e.getBody(),t,true);if("#ffffff"===xi.toHex(n).toLowerCase())return}if("color"!==t||"#000000"!==xi.toHex(n).toLowerCase()){if("font-size"===t&&/em|%$/.test(n)){if(0===o)return;var a=parseFloat(n)/(/%$/.test(n)?100:1);n=a*o+"px"}"border"===t&&n&&(i+="padding:0 2px;");i+=t+":"+n+";"}}));e.fire("AfterPreviewFormats");xi.remove(a);return i};var setup$h=function(e){e.addShortcut("meta+b","","Bold");e.addShortcut("meta+i","","Italic");e.addShortcut("meta+u","","Underline");for(var t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",false,"h"+t]);e.addShortcut("access+7","",["FormatBlock",false,"p"]);e.addShortcut("access+8","",["FormatBlock",false,"div"]);e.addShortcut("access+9","",["FormatBlock",false,"address"])};var Formatter=function(e){var t=FormatRegistry(e);var n=Cell(null);setup$h(e);setup$k(e);return{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:function(t,n,a){applyFormat(e,t,n,a)},remove:function(t,n,a,o){removeFormat(e,t,n,a,o)},toggle:function(t,n,a){toggleFormat(e,t,n,a)},match:function(t,n,a,o){return matchFormat(e,t,n,a,o)},closest:function(t){return closestFormat(e,t)},matchAll:function(t,n){return matchAllFormats(e,t,n)},matchNode:function(t,n,a,o){return matchNodeFormat(e,t,n,a,o)},canApply:function(t){return canApplyFormat(e,t)},formatChanged:function(t,a,o,i){return formatChanged(e,n,t,a,o,i)},getCssText:curry(getCssText,e)}};var shouldIgnoreCommand=function(e){switch(e.toLowerCase()){case"undo":case"redo":case"mcerepaint":case"mcefocus":return true;default:return false}};var registerEvents=function(e,t,n){var a=Cell(false);var addNonTypingUndoLevel=function(e){setTyping(t,false,n);t.add({},e)};e.on("init",(function(){t.add()}));e.on("BeforeExecCommand",(function(e){var a=e.command;if(!shouldIgnoreCommand(a)){endTyping(t,n);t.beforeChange()}}));e.on("ExecCommand",(function(e){var t=e.command;shouldIgnoreCommand(t)||addNonTypingUndoLevel(e)}));e.on("ObjectResizeStart cut",(function(){t.beforeChange()}));e.on("SaveContent ObjectResized blur",addNonTypingUndoLevel);e.on("dragend",addNonTypingUndoLevel);e.on("keyup",(function(n){var o=n.keyCode;if(!n.isDefaultPrevented()){if(o>=33&&o<=36||o>=37&&o<=40||45===o||n.ctrlKey){addNonTypingUndoLevel();e.nodeChanged()}46!==o&&8!==o||e.nodeChanged();if(a.get()&&t.typing&&false===isEq$1(createFromEditor(e),t.data[0])){if(false===e.isDirty()){e.setDirty(true);e.fire("change",{level:t.data[0],lastLevel:null})}e.fire("TypingUndo");a.set(false);e.nodeChanged()}}}));e.on("keydown",(function(e){var o=e.keyCode;if(!e.isDefaultPrevented())if(o>=33&&o<=36||o>=37&&o<=40||45===o)t.typing&&addNonTypingUndoLevel(e);else{var i=e.ctrlKey&&!e.altKey||e.metaKey;if((o<16||o>20)&&224!==o&&91!==o&&!t.typing&&!i){t.beforeChange();setTyping(t,true,n);t.add({},e);a.set(true)}}}));e.on("mousedown",(function(e){t.typing&&addNonTypingUndoLevel(e)}));var isInsertReplacementText=function(e){return"insertReplacementText"===e.inputType};var isInsertTextDataNull=function(e){return"insertText"===e.inputType&&null===e.data};var isInsertFromPasteOrDrop=function(e){return"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType};e.on("input",(function(e){e.inputType&&(isInsertReplacementText(e)||isInsertTextDataNull(e)||isInsertFromPasteOrDrop(e))&&addNonTypingUndoLevel(e)}));e.on("AddUndo Undo Redo ClearUndos",(function(t){t.isDefaultPrevented()||e.nodeChanged()}))};var addKeyboardShortcuts=function(e){e.addShortcut("meta+z","","Undo");e.addShortcut("meta+y,meta+shift+z","","Redo")};var UndoManager=function(e){var t=value();var n=Cell(0);var a=Cell(0);var o={data:[],typing:false,beforeChange:function(){beforeChange(e,n,t)},add:function(i,u){return addUndoLevel(e,o,a,n,t,i,u)},undo:function(){return undo(e,o,n,a)},redo:function(){return redo(e,a,o.data)},clear:function(){clear(e,o,a)},reset:function(){reset(e,o)},hasUndo:function(){return hasUndo(e,o,a)},hasRedo:function(){return hasRedo(e,o,a)},transact:function(t){return transact(e,o,n,t)},ignore:function(t){ignore(e,n,t)},extra:function(t,n){extra(e,o,a,t,n)}};isRtc(e)||registerEvents(e,o,n);addKeyboardShortcuts(e);return o};var Si=[9,27,Oa.HOME,Oa.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,Oa.DOWN,Oa.UP,Oa.LEFT,Oa.RIGHT].concat(ie.browser.isFirefox()?[224]:[]);var Ei="data-mce-placeholder";var isKeyboardEvent=function(e){return"keydown"===e.type||"keyup"===e.type};var isDeleteEvent=function(e){var t=e.keyCode;return t===Oa.BACKSPACE||t===Oa.DELETE};var isNonTypingKeyboardEvent=function(e){if(isKeyboardEvent(e)){var t=e.keyCode;return!isDeleteEvent(e)&&(Oa.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||contains$3(Si,t))}return false};var isTypingKeyboardEvent=function(e){return isKeyboardEvent(e)&&!(isDeleteEvent(e)||"keyup"===e.type&&229===e.keyCode)};var isVisuallyEmpty=function(e,t,n){if(isEmpty$2(se.fromDom(t),false)){var a=""===n;var o=t.firstElementChild;return!o||!e.getStyle(t.firstElementChild,"padding-left")&&!e.getStyle(t.firstElementChild,"padding-right")&&(a?!e.isBlock(o):n===o.nodeName.toLowerCase())}return false};var setup$g=function(e){var t=e.dom;var n=getForcedRootBlock(e);var a=getPlaceholder(e);var updatePlaceholder=function(o,i){if(!isNonTypingKeyboardEvent(o)){var u=e.getBody();var c=!isTypingKeyboardEvent(o)&&isVisuallyEmpty(t,u,n);var f=""!==t.getAttrib(u,Ei);if(f!==c||i){t.setAttrib(u,Ei,c?a:null);t.setAttrib(u,"aria-placeholder",c?a:null);firePlaceholderToggle(e,c);e.on(c?"keydown":"keyup",updatePlaceholder);e.off(c?"keyup":"keydown",updatePlaceholder)}}};a&&e.on("init",(function(t){updatePlaceholder(t,true);e.on("change SetContent ExecCommand",updatePlaceholder);e.on("paste",(function(t){return We.setEditorTimeout(e,(function(){return updatePlaceholder(t)}))}))}))};var ki=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/;var hasStrongRtl=function(e){return ki.test(e)};var isInlineTarget=function(e,t){return is$2(se.fromDom(t),getInlineBoundarySelector(e))};var isRtl=function(e){return"rtl"===DOMUtils.DOM.getStyle(e,"direction",true)||hasStrongRtl(e.textContent)};var findInlineParents=function(e,t,n){return filter$4(DOMUtils.DOM.getParents(n.container(),"*",t),e)};var findRootInline=function(e,t,n){var a=findInlineParents(e,t,n);return b.from(a[a.length-1])};var hasSameParentBlock=function(e,t,n){var a=getParentBlock$2(t,e);var o=getParentBlock$2(n,e);return a&&a===o};var isAtZwsp=function(e){return isBeforeInline(e)||isAfterInline(e)};var normalizePosition=function(e,t){if(!t)return t;var n=t.container(),a=t.offset();return e?isCaretContainerInline(n)?Ne(n.nextSibling)?CaretPosition(n.nextSibling,0):CaretPosition.after(n):isBeforeInline(t)?CaretPosition(n,a+1):t:isCaretContainerInline(n)?Ne(n.previousSibling)?CaretPosition(n.previousSibling,n.previousSibling.data.length):CaretPosition.before(n):isAfterInline(t)?CaretPosition(n,a-1):t};var Ni=curry(normalizePosition,true);var _i=curry(normalizePosition,false);var isBeforeRoot=function(e){return function(t){return eq(e,se.fromDom(t.dom.parentNode))}};var isTextBlockOrListItem=function(e){return ot(e)||ut(e)};var getParentBlock$1=function(e,t){return contains$1(e,t)?closest$3(t,isTextBlockOrListItem,isBeforeRoot(e)):b.none()};var placeCaretInEmptyBody=function(e){var t=e.getBody();var n=t.firstChild&&e.dom.isBlock(t.firstChild)?t.firstChild:t;e.selection.setCursorLocation(n,0)};var paddEmptyBody=function(e){if(e.dom.isEmpty(e.getBody())){e.setContent("");placeCaretInEmptyBody(e)}};var willDeleteLastPositionInElement=function(e,t,n){return lift2(Sa(n),Ea(n),(function(a,o){var i=normalizePosition(true,a);var u=normalizePosition(false,o);var c=normalizePosition(false,t);return e?wa(n,c).exists((function(e){return e.isEqual(u)&&t.isEqual(i)})):xa(n,c).exists((function(e){return e.isEqual(i)&&t.isEqual(u)}))})).getOr(true)};var blockPosition=function(e,t){return{block:e,position:t}};var blockBoundary=function(e,t){return{from:e,to:t}};var getBlockPosition=function(e,t){var n=se.fromDom(e);var a=se.fromDom(t.container());return getParentBlock$1(n,a).map((function(e){return blockPosition(e,t)}))};var isDifferentBlocks=function(e){return false===eq(e.from.block,e.to.block)};var hasSameParent=function(e){return parent(e.from.block).bind((function(t){return parent(e.to.block).filter((function(e){return eq(t,e)}))})).isSome()};var isEditable$1=function(e){return false===Be(e.from.block.dom)&&false===Be(e.to.block.dom)};var skipLastBr=function(e,t,n){return De(n.position.getNode())&&false===isEmpty$2(n.block)?positionIn(false,n.block.dom).bind((function(a){return a.isEqual(n.position)?fromPosition(t,e,a).bind((function(t){return getBlockPosition(e,t)})):b.some(n)})).getOr(n):n};var readFromRange=function(e,t,n){var a=getBlockPosition(e,CaretPosition.fromRangeStart(n));var o=a.bind((function(n){return fromPosition(t,e,n.position).bind((function(n){return getBlockPosition(e,n).map((function(n){return skipLastBr(e,t,n)}))}))}));return lift2(a,o,blockBoundary).filter((function(e){return isDifferentBlocks(e)&&hasSameParent(e)&&isEditable$1(e)}))};var read$1=function(e,t,n){return n.collapsed?readFromRange(e,t,n):b.none()};var getChildrenUntilBlockBoundary=function(e){var t=children(e);return findIndex$2(t,at).fold(constant(t),(function(e){return t.slice(0,e)}))};var extractChildren=function(e){var t=getChildrenUntilBlockBoundary(e);each$k(t,remove$7);return t};var removeEmptyRoot=function(e,t){var n=parentsAndSelf(t,e);return find$3(n.reverse(),(function(e){return isEmpty$2(e)})).each(remove$7)};var isEmptyBefore=function(e){return 0===filter$4(prevSiblings(e),(function(e){return!isEmpty$2(e)})).length};var nestedBlockMerge=function(e,t,n,a){if(isEmpty$2(n)){fillWithPaddingBr(n);return Sa(n.dom)}isEmptyBefore(a)&&isEmpty$2(t)&&before$4(a,se.fromTag("br"));var o=xa(n.dom,CaretPosition.before(a.dom));each$k(extractChildren(t),(function(e){before$4(a,e)}));removeEmptyRoot(e,t);return o};var sidelongBlockMerge=function(e,t,n){if(isEmpty$2(n)){remove$7(n);isEmpty$2(t)&&fillWithPaddingBr(t);return Sa(t.dom)}var a=Ea(n.dom);each$k(extractChildren(t),(function(e){append$1(n,e)}));removeEmptyRoot(e,t);return a};var findInsertionPoint=function(e,t){var n=parentsAndSelf(t,e);return b.from(n[n.length-1])};var getInsertionPoint=function(e,t){return contains$1(t,e)?findInsertionPoint(t,e):b.none()};var trimBr=function(e,t){positionIn(e,t.dom).map((function(e){return e.getNode()})).map(se.fromDom).filter(isBr$4).each(remove$7)};var mergeBlockInto=function(e,t,n){trimBr(true,t);trimBr(false,n);return getInsertionPoint(t,n).fold(curry(sidelongBlockMerge,e,t,n),curry(nestedBlockMerge,e,t,n))};var mergeBlocks=function(e,t,n,a){return t?mergeBlockInto(e,a,n):mergeBlockInto(e,n,a)};var backspaceDelete$8=function(e,t){var n=se.fromDom(e.getBody());var a=read$1(n.dom,t,e.selection.getRng()).bind((function(e){return mergeBlocks(n,t,e.from.block,e.to.block)}));a.each((function(t){e.selection.setRng(t.toRange())}));return a.isSome()};var deleteRangeMergeBlocks=function(e,t){var n=t.getRng();return lift2(getParentBlock$1(e,se.fromDom(n.startContainer)),getParentBlock$1(e,se.fromDom(n.endContainer)),(function(a,o){if(false===eq(a,o)){n.deleteContents();mergeBlocks(e,true,a,o).each((function(e){t.setRng(e.toRange())}));return true}return false})).getOr(false)};var isRawNodeInTable=function(e,t){var n=se.fromDom(t);var a=curry(eq,e);return ancestor$3(n,ft,a).isSome()};var isSelectionInTable=function(e,t){return isRawNodeInTable(e,t.startContainer)||isRawNodeInTable(e,t.endContainer)};var isEverythingSelected=function(e,t){var n=xa(e.dom,CaretPosition.fromRangeStart(t)).isNone();var a=wa(e.dom,CaretPosition.fromRangeEnd(t)).isNone();return!isSelectionInTable(e,t)&&n&&a};var emptyEditor=function(e){e.setContent("");e.selection.setCursorLocation();return true};var deleteRange$1=function(e){var t=se.fromDom(e.getBody());var n=e.selection.getRng();return isEverythingSelected(t,n)?emptyEditor(e):deleteRangeMergeBlocks(t,e.selection)};var backspaceDelete$7=function(e,t){return!e.selection.isCollapsed()&&deleteRange$1(e)};var Ai=Oe;var Ri=Be;var showCaret=function(e,t,n,a,o){return b.from(t._selectionOverrides.showCaret(e,n,a,o))};var getNodeRange=function(e){var t=e.ownerDocument.createRange();t.selectNode(e);return t};var selectNode=function(e,t){var n=e.fire("BeforeObjectSelected",{target:t});return n.isDefaultPrevented()?b.none():b.some(getNodeRange(t))};var renderCaretAtRange=function(e,t,n){var a=normalizeRange(1,e.getBody(),t);var o=CaretPosition.fromRangeStart(a);var i=o.getNode();if(isInlineFakeCaretTarget(i))return showCaret(1,e,i,!o.isAtEnd(),false);var u=o.getNode(true);if(isInlineFakeCaretTarget(u))return showCaret(1,e,u,false,false);var c=e.dom.getParent(o.getNode(),(function(e){return Ri(e)||Ai(e)}));return isInlineFakeCaretTarget(c)?showCaret(1,e,c,false,n):b.none()};var renderRangeCaret=function(e,t,n){return t.collapsed?renderCaretAtRange(e,t,n).getOr(t):t};var isBeforeBoundary=function(e){return xo(e)||bo(e)};var isAfterBoundary=function(e){return So(e)||yo(e)};var trimEmptyTextNode=function(e,t){Ne(t)&&0===t.data.length&&e.remove(t)};var deleteContentAndShowCaret=function(e,t,n,a,o,i){showCaret(a,e,i.getNode(!o),o,true).each((function(n){if(t.collapsed){var a=t.cloneRange();o?a.setEnd(n.startContainer,n.startOffset):a.setStart(n.endContainer,n.endOffset);a.deleteContents()}else t.deleteContents();e.selection.setRng(n)}));trimEmptyTextNode(e.dom,n);return true};var deleteBoundaryText=function(e,t){var n=e.selection.getRng();if(!Ne(n.commonAncestorContainer))return false;var a=t?da.Forwards:da.Backwards;var o=CaretWalker(e.getBody());var i=curry(getVisualCaretPosition,t?o.next:o.prev);var u=t?isBeforeBoundary:isAfterBoundary;var c=getNormalizedRangeEndPoint(a,e.getBody(),n);var f=normalizePosition(t,i(c));if(!f||!isMoveInsideSameBlock(c,f))return false;if(u(f))return deleteContentAndShowCaret(e,n,c.getNode(),a,t,f);var s=i(f);return!!(s&&u(s)&&isMoveInsideSameBlock(f,s))&&deleteContentAndShowCaret(e,n,c.getNode(),a,t,s)};var backspaceDelete$6=function(e,t){return deleteBoundaryText(e,t)};var isCompoundElement=function(e){return ft(se.fromDom(e))||ut(se.fromDom(e))};var Di=Ve.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]);var isAtContentEditableBlockCaret=function(e,t){var n=t.getNode(false===e);var a=e?"after":"before";return Ee(n)&&n.getAttribute("data-mce-caret")===a};var isDeleteFromCefDifferentBlocks=function(e,t,n,a){var inSameBlock=function(t){return isInline$1(se.fromDom(t))&&!isInSameBlock(n,a,e)};return getRelativeCefElm(!t,n).fold((function(){return getRelativeCefElm(t,a).fold(g,inSameBlock)}),inSameBlock)};var deleteEmptyBlockOrMoveToCef=function(e,t,n,a){var o=a.getNode(false===t);return getParentBlock$1(se.fromDom(e),se.fromDom(n.getNode())).map((function(e){return isEmpty$2(e)?Di.remove(e.dom):Di.moveToElement(o)})).orThunk((function(){return b.some(Di.moveToElement(o))}))};var findCefPosition=function(e,t,n){return fromPosition(t,e,n).bind((function(a){return isCompoundElement(a.getNode())||isDeleteFromCefDifferentBlocks(e,t,n,a)?b.none():t&&Be(a.getNode())||false===t&&Be(a.getNode(true))?deleteEmptyBlockOrMoveToCef(e,t,n,a):t&&So(n)||false===t&&xo(n)?b.some(Di.moveToPosition(a)):b.none()}))};var getContentEditableBlockAction=function(e,t){return e&&Be(t.nextSibling)?b.some(Di.moveToElement(t.nextSibling)):false===e&&Be(t.previousSibling)?b.some(Di.moveToElement(t.previousSibling)):b.none()};var skipMoveToActionFromInlineCefToContent=function(e,t,n){return n.fold((function(e){return b.some(Di.remove(e))}),(function(e){return b.some(Di.moveToElement(e))}),(function(n){return isInSameBlock(t,n,e)?b.none():b.some(Di.moveToPosition(n))}))};var getContentEditableAction=function(e,t,n){return isAtContentEditableBlockCaret(t,n)?getContentEditableBlockAction(t,n.getNode(false===t)).fold((function(){return findCefPosition(e,t,n)}),b.some):findCefPosition(e,t,n).bind((function(t){return skipMoveToActionFromInlineCefToContent(e,n,t)}))};var read=function(e,t,n){var a=normalizeRange(t?1:-1,e,n);var o=CaretPosition.fromRangeStart(a);var i=se.fromDom(e);return false===t&&So(o)?b.some(Di.remove(o.getNode(true))):t&&xo(o)?b.some(Di.remove(o.getNode())):false===t&&xo(o)&&isAfterBr(i,o)?Ao(i,o).map((function(e){return Di.remove(e.getNode())})):t&&So(o)&&isBeforeBr$1(i,o)?Ro(i,o).map((function(e){return Di.remove(e.getNode())})):getContentEditableAction(e,t,o)};var deleteElement$1=function(e,t){return function(n){e._selectionOverrides.hideFakeCaret();deleteElement$2(e,t,se.fromDom(n));return true}};var moveToElement=function(e,t){return function(n){var a=t?CaretPosition.before(n):CaretPosition.after(n);e.selection.setRng(a.toRange());return true}};var moveToPosition=function(e){return function(t){e.selection.setRng(t.toRange());return true}};var getAncestorCe=function(e,t){return b.from(getContentEditableRoot$1(e.getBody(),t))};var backspaceDeleteCaret=function(e,t){var n=e.selection.getNode();return getAncestorCe(e,n).filter(Be).fold((function(){return read(e.getBody(),t,e.selection.getRng()).exists((function(n){return n.fold(deleteElement$1(e,t),moveToElement(e,t),moveToPosition(e))}))}),p)};var deleteOffscreenSelection=function(e){each$k(descendants(e,".mce-offscreen-selection"),remove$7)};var backspaceDeleteRange=function(e,t){var n=e.selection.getNode();if(Be(n)&&!Pe(n)){var a=getAncestorCe(e,n.parentNode).filter(Be);return a.fold((function(){deleteOffscreenSelection(se.fromDom(e.getBody()));deleteElement$2(e,t,se.fromDom(e.selection.getNode()));paddEmptyBody(e);return true}),p)}return false};var paddEmptyElement=function(e){var t=e.dom,n=e.selection;var a=getContentEditableRoot$1(e.getBody(),n.getNode());if(Oe(a)&&t.isBlock(a)&&t.isEmpty(a)){var o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(a,"");a.appendChild(o);n.setRng(CaretPosition.before(o).toRange())}return true};var backspaceDelete$5=function(e,t){return e.selection.isCollapsed()?backspaceDeleteCaret(e,t):backspaceDeleteRange(e,t)};var deleteCaret$2=function(e,t){var n=CaretPosition.fromRangeStart(e.selection.getRng());return fromPosition(t,e.getBody(),n).filter((function(e){return t?po(e):ho(e)})).bind((function(e){return b.from(getChildNodeAtRelativeOffset(t?0:-1,e))})).exists((function(t){e.selection.select(t);return true}))};var backspaceDelete$4=function(e,t){return!!e.selection.isCollapsed()&&deleteCaret$2(e,t)};var Ti=Ne;var startsWithCaretContainer=function(e){return Ti(e)&&e.data[0]===dt};var endsWithCaretContainer=function(e){return Ti(e)&&e.data[e.data.length-1]===dt};var createZwsp=function(e){return e.ownerDocument.createTextNode(dt)};var insertBefore=function(e){if(Ti(e.previousSibling)){if(endsWithCaretContainer(e.previousSibling))return e.previousSibling;e.previousSibling.appendData(dt);return e.previousSibling}if(Ti(e)){if(startsWithCaretContainer(e))return e;e.insertData(0,dt);return e}var t=createZwsp(e);e.parentNode.insertBefore(t,e);return t};var insertAfter=function(e){if(Ti(e.nextSibling)){if(startsWithCaretContainer(e.nextSibling))return e.nextSibling;e.nextSibling.insertData(0,dt);return e.nextSibling}if(Ti(e)){if(endsWithCaretContainer(e))return e;e.appendData(dt);return e}var t=createZwsp(e);e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t);return t};var insertInline=function(e,t){return e?insertBefore(t):insertAfter(t)};var Oi=curry(insertInline,true);var Bi=curry(insertInline,false);var insertInlinePos=function(e,t){return Ne(e.container())?insertInline(t,e.container()):insertInline(t,e.getNode())};var isPosCaretContainer=function(e,t){var n=t.get();return n&&e.container()===n&&isCaretContainerInline(n)};var renderCaret=function(e,t){return t.fold((function(t){remove$2(e.get());var n=Oi(t);e.set(n);return b.some(CaretPosition(n,n.length-1))}),(function(t){return Sa(t).map((function(t){if(isPosCaretContainer(t,e))return CaretPosition(e.get(),1);remove$2(e.get());var n=insertInlinePos(t,true);e.set(n);return CaretPosition(n,1)}))}),(function(t){return Ea(t).map((function(t){if(isPosCaretContainer(t,e))return CaretPosition(e.get(),e.get().length-1);remove$2(e.get());var n=insertInlinePos(t,false);e.set(n);return CaretPosition(n,n.length-1)}))}),(function(t){remove$2(e.get());var n=Bi(t);e.set(n);return b.some(CaretPosition(n,1))}))};var evaluateUntil=function(e,t){for(var n=0;n<e.length;n++){var a=e[n].apply(null,t);if(a.isSome())return a}return b.none()};var Pi=Ve.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]);var rescope$1=function(e,t){var n=getParentBlock$2(t,e);return n||e};var before=function(e,t,n){var a=Ni(n);var o=rescope$1(t,a.container());return findRootInline(e,o,a).fold((function(){return wa(o,a).bind(curry(findRootInline,e,o)).map((function(e){return Pi.before(e)}))}),b.none)};var isNotInsideFormatCaretContainer=function(e,t){return null===getParentCaretContainer(e,t)};var findInsideRootInline=function(e,t,n){return findRootInline(e,t,n).filter(curry(isNotInsideFormatCaretContainer,t))};var start$1=function(e,t,n){var a=_i(n);return findInsideRootInline(e,t,a).bind((function(e){var t=xa(e,a);return t.isNone()?b.some(Pi.start(e)):b.none()}))};var end=function(e,t,n){var a=Ni(n);return findInsideRootInline(e,t,a).bind((function(e){var t=wa(e,a);return t.isNone()?b.some(Pi.end(e)):b.none()}))};var after=function(e,t,n){var a=_i(n);var o=rescope$1(t,a.container());return findRootInline(e,o,a).fold((function(){return xa(o,a).bind(curry(findRootInline,e,o)).map((function(e){return Pi.after(e)}))}),b.none)};var isValidLocation=function(e){return false===isRtl(getElement(e))};var readLocation=function(e,t,n){var a=evaluateUntil([before,start$1,end,after],[e,t,n]);return a.filter(isValidLocation)};var getElement=function(e){return e.fold(identity,identity,identity,identity)};var getName=function(e){return e.fold(constant("before"),constant("start"),constant("end"),constant("after"))};var outside=function(e){return e.fold(Pi.before,Pi.before,Pi.after,Pi.after)};var inside=function(e){return e.fold(Pi.start,Pi.start,Pi.end,Pi.end)};var isEq=function(e,t){return getName(e)===getName(t)&&getElement(e)===getElement(t)};var betweenInlines=function(e,t,n,a,o,i){return lift2(findRootInline(t,n,a),findRootInline(t,n,o),(function(t,a){return t!==a&&hasSameParentBlock(n,t,a)?Pi.after(e?t:a):i})).getOr(i)};var skipNoMovement=function(e,t){return e.fold(p,(function(e){return!isEq(e,t)}))};var findLocationTraverse=function(e,t,n,a,o){var i=normalizePosition(e,o);var u=fromPosition(e,n,i).map(curry(normalizePosition,e));var c=u.fold((function(){return a.map(outside)}),(function(o){return readLocation(t,n,o).map(curry(betweenInlines,e,t,n,i,o)).filter(curry(skipNoMovement,a))}));return c.filter(isValidLocation)};var findLocationSimple=function(e,t){return e?t.fold(compose(b.some,Pi.start),b.none,compose(b.some,Pi.after),b.none):t.fold(b.none,compose(b.some,Pi.before),b.none,compose(b.some,Pi.end))};var findLocation$1=function(e,t,n,a){var o=normalizePosition(e,a);var i=readLocation(t,n,o);return readLocation(t,n,o).bind(curry(findLocationSimple,e)).orThunk((function(){return findLocationTraverse(e,t,n,i,a)}))};curry(findLocation$1,false);curry(findLocation$1,true);var hasSelectionModifyApi=function(e){return d(e.selection.getSel().modify)};var moveRel=function(e,t,n){var a=e?1:-1;t.setRng(CaretPosition(n.container(),n.offset()+a).toRange());t.getSel().modify("move",e?"forward":"backward","word");return true};var moveByWord=function(e,t){var n=t.selection.getRng();var a=e?CaretPosition.fromRangeEnd(n):CaretPosition.fromRangeStart(n);return!!hasSelectionModifyApi(t)&&(e&&isBeforeInline(a)?moveRel(true,t.selection,a):!(e||!isAfterInline(a))&&moveRel(false,t.selection,a))};var Li;(function(e){e[e.Br=0]="Br";e[e.Block=1]="Block";e[e.Wrap=2]="Wrap";e[e.Eol=3]="Eol"})(Li||(Li={}));var flip=function(e,t){return e===da.Backwards?reverse(t):t};var walk=function(e,t,n){return e===da.Forwards?t.next(n):t.prev(n)};var getBreakType=function(e,t,n,a){return De(a.getNode(t===da.Forwards))?Li.Br:false===isInSameBlock(n,a)?Li.Block:Li.Wrap};var getPositionsUntil=function(e,t,n,a){var o=CaretWalker(n);var i=a;var u=[];while(i){var c=walk(t,o,i);if(!c)break;if(De(c.getNode(false)))return t===da.Forwards?{positions:flip(t,u).concat([c]),breakType:Li.Br,breakAt:b.some(c)}:{positions:flip(t,u),breakType:Li.Br,breakAt:b.some(c)};if(c.isVisible()){if(e(i,c)){var f=getBreakType(n,t,i,c);return{positions:flip(t,u),breakType:f,breakAt:b.some(c)}}u.push(c);i=c}else i=c}return{positions:flip(t,u),breakType:Li.Eol,breakAt:b.none()}};var getAdjacentLinePositions=function(e,t,n,a){return t(n,a).breakAt.map((function(a){var o=t(n,a).positions;return e===da.Backwards?o.concat(a):[a].concat(o)})).getOr([])};var findClosestHorizontalPositionFromPoint=function(e,t){return foldl(e,(function(e,n){return e.fold((function(){return b.some(n)}),(function(a){return lift2(head(a.getClientRects()),head(n.getClientRects()),(function(e,o){var i=Math.abs(t-e.left);var u=Math.abs(t-o.left);return u<=i?n:a})).or(e)}))}),b.none())};var findClosestHorizontalPosition=function(e,t){return head(t.getClientRects()).bind((function(t){return findClosestHorizontalPositionFromPoint(e,t.left)}))};var Ii=curry(getPositionsUntil,CaretPosition.isAbove,-1);var Mi=curry(getPositionsUntil,CaretPosition.isBelow,1);var Fi=curry(getAdjacentLinePositions,-1,Ii);var Ui=curry(getAdjacentLinePositions,1,Mi);var isAtFirstLine=function(e,t){return Ii(e,t).breakAt.isNone()};var isAtLastLine=function(e,t){return Mi(e,t).breakAt.isNone()};var getFirstLinePositions=function(e){return Sa(e).map((function(t){return[t].concat(Mi(e,t).positions)})).getOr([])};var getLastLinePositions=function(e){return Ea(e).map((function(t){return Ii(e,t).positions.concat(t)})).getOr([])};var getNodeClientRects=function(e){var toArrayWithNode=function(t){return map$3(t,(function(t){var n=clone(t);n.node=e;return n}))};if(Ee(e))return toArrayWithNode(e.getClientRects());if(Ne(e)){var t=e.ownerDocument.createRange();t.setStart(e,0);t.setEnd(e,e.data.length);return toArrayWithNode(t.getClientRects())}};var getClientRects=function(e){return bind(e,getNodeClientRects)};var zi;(function(e){e[e.Up=-1]="Up";e[e.Down=1]="Down"})(zi||(zi={}));var findUntil=function(e,t,n,a){while(a=findNode$1(a,e,isEditableCaretCandidate$1,t))if(n(a))return};var walkUntil$1=function(e,t,n,a,o,i){var u=0;var c=[];var add=function(a){var i=getClientRects([a]);-1===e&&(i=i.reverse());for(var s=0;s<i.length;s++){var l=i[s];if(!n(l,f)){c.length>0&&t(l,last$1(c))&&u++;l.line=u;if(o(l))return true;c.push(l)}}};var f=last$1(i.getClientRects());if(!f)return c;var s=i.getNode();add(s);findUntil(e,a,add,s);return c};var aboveLineNumber=function(e,t){return t.line>e};var isLineNumber=function(e,t){return t.line===e};var ji=curry(walkUntil$1,zi.Up,isAbove$1,isBelow$1);var Hi=curry(walkUntil$1,zi.Down,isBelow$1,isAbove$1);var positionsUntil=function(e,t,n,a){var o=CaretWalker(t);var i;var u;var c;var f;var s=[];var l=0;var getClientRect=function(t){return 1===e,last$1(t.getClientRects())};if(1===e){i=o.next;u=isBelow$1;c=isAbove$1;f=CaretPosition.after(a)}else{i=o.prev;u=isAbove$1;c=isBelow$1;f=CaretPosition.before(a)}var v=getClientRect(f);do{if(f.isVisible()){var d=getClientRect(f);if(!c(d,v)){s.length>0&&u(d,last$1(s))&&l++;var m=clone(d);m.position=f;m.line=l;if(n(m))return s;s.push(m)}}}while(f=i(f));return s};var isAboveLine=function(e){return function(t){return aboveLineNumber(e,t)}};var isLine=function(e){return function(t){return isLineNumber(e,t)}};var Vi=Be;var qi=findNode$1;var distanceToRectLeft=function(e,t){return Math.abs(e.left-t)};var distanceToRectRight=function(e,t){return Math.abs(e.right-t)};var isInsideX=function(e,t){return e>=t.left&&e<=t.right};var isInsideY=function(e,t){return e>=t.top&&e<=t.bottom};var isNodeClientRect=function(e){return hasNonNullableKey(e,"node")};var findClosestClientRect=function(e,t,n){void 0===n&&(n=p);return reduce(e,(function(e,a){if(isInsideX(t,a))return n(a)?a:e;if(isInsideX(t,e))return n(e)?e:a;var o=Math.min(distanceToRectLeft(e,t),distanceToRectRight(e,t));var i=Math.min(distanceToRectLeft(a,t),distanceToRectRight(a,t));return i===o&&isNodeClientRect(a)&&Vi(a.node)||i<o?a:e}))};var walkUntil=function(e,t,n,a,o){var i=qi(a,e,isEditableCaretCandidate$1,t,!o);do{if(!i||n(i))return}while(i=qi(i,e,isEditableCaretCandidate$1,t))};var findLineNodeRects=function(e,t,n){void 0===n&&(n=true);var a=[];var collect=function(e,n){var o=filter$4(getClientRects([n]),(function(n){return!e(n,t)}));a=a.concat(o);return 0===o.length};a.push(t);walkUntil(zi.Up,e,curry(collect,isAbove$1),t.node,n);walkUntil(zi.Down,e,curry(collect,isBelow$1),t.node,n);return a};var getFakeCaretTargets=function(e){return filter$4(x(e.getElementsByTagName("*")),isFakeCaretTarget)};var caretInfo=function(e,t){return{node:e.node,before:distanceToRectLeft(e,t)<distanceToRectRight(e,t)}};var closestFakeCaret=function(e,t,n){var a=getClientRects(getFakeCaretTargets(e));var o=filter$4(a,curry(isInsideY,n));var checkInside=function(e){return!isTable$3(e.node)&&!Le(e.node)};var i=findClosestClientRect(o,t,checkInside);if(i){var u=checkInside(i);i=findClosestClientRect(findLineNodeRects(e,i,u),t,checkInside);if(i&&isFakeCaretTarget(i.node))return caretInfo(i,t)}return null};var moveToRange=function(e,t){e.selection.setRng(t);scrollRangeIntoView(e,e.selection.getRng())};var renderRangeCaretOpt=function(e,t,n){return b.some(renderRangeCaret(e,t,n))};var moveHorizontally=function(e,t,n,a,o,i){var u=t===da.Forwards;var c=CaretWalker(e.getBody());var f=curry(getVisualCaretPosition,u?c.next:c.prev);var s=u?a:o;if(!n.collapsed){var l=getSelectedNode(n);if(i(l))return showCaret(t,e,l,t===da.Backwards,false)}var v=getNormalizedRangeEndPoint(t,e.getBody(),n);if(s(v))return selectNode(e,v.getNode(!u));var d=normalizePosition(u,f(v));var m=isRangeInCaretContainerBlock(n);if(!d)return m?b.some(n):b.none();if(s(d))return showCaret(t,e,d.getNode(!u),u,false);var g=f(d);return g&&s(g)&&isMoveInsideSameBlock(d,g)?showCaret(t,e,g.getNode(!u),u,false):m?renderRangeCaretOpt(e,d.toRange(),false):b.none()};var moveVertically=function(e,t,n,a,o,i){var u=getNormalizedRangeEndPoint(t,e.getBody(),n);var c=last$1(u.getClientRects());var f=t===zi.Down;if(!c)return b.none();var s=f?Hi:ji;var l=s(e.getBody(),isAboveLine(1),u);var v=filter$4(l,isLine(1));var d=c.left;var m=findClosestClientRect(v,d);if(m&&i(m.node)){var g=Math.abs(d-m.left);var p=Math.abs(d-m.right);return showCaret(t,e,m.node,g<p,false)}var h;h=a(u)?u.getNode():o(u)?u.getNode(true):getSelectedNode(n);if(h){var y=positionsUntil(t,e.getBody(),isAboveLine(1),h);var C=findClosestClientRect(filter$4(y,isLine(1)),d);if(C)return renderRangeCaretOpt(e,C.position.toRange(),false);C=last$1(filter$4(y,isLine(0)));if(C)return renderRangeCaretOpt(e,C.position.toRange(),false)}return 0===v.length?getLineEndPoint(e,f).filter(f?o:a).map((function(t){return renderRangeCaret(e,t.toRange(),false)})):b.none()};var getLineEndPoint=function(e,t){var n=e.selection.getRng();var a=e.getBody();if(t){var o=CaretPosition.fromRangeEnd(n);var i=Mi(a,o);return last$2(i.positions)}o=CaretPosition.fromRangeStart(n);i=Ii(a,o);return head(i.positions)};var moveToLineEndPoint$3=function(e,t,n){return getLineEndPoint(e,t).filter(n).exists((function(t){e.selection.setRng(t.toRange());return true}))};var setCaretPosition=function(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset());n.setEnd(t.container(),t.offset());e.selection.setRng(n)};var setSelected=function(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")};var renderCaretLocation=function(e,t,n){return renderCaret(t,n).map((function(t){setCaretPosition(e,t);return n}))};var findLocation=function(e,t,n){var a=e.getBody();var o=CaretPosition.fromRangeStart(e.selection.getRng());var i=curry(isInlineTarget,e);var u=findLocation$1(n,i,a,o);return u.bind((function(n){return renderCaretLocation(e,t,n)}))};var toggleInlines=function(e,t,n){var a=map$3(descendants(se.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),(function(e){return e.dom}));var o=filter$4(a,e);var i=filter$4(n,e);each$k(difference(o,i),curry(setSelected,false));each$k(difference(i,o),curry(setSelected,true))};var safeRemoveCaretContainer=function(e,t){if(e.selection.isCollapsed()&&true!==e.composing&&t.get()){var n=CaretPosition.fromRangeStart(e.selection.getRng());if(CaretPosition.isTextPosition(n)&&false===isAtZwsp(n)){setCaretPosition(e,removeAndReposition(t.get(),n));t.set(null)}}};var renderInsideInlineCaret=function(e,t,n,a){if(t.selection.isCollapsed()){var o=filter$4(a,e);each$k(o,(function(a){var o=CaretPosition.fromRangeStart(t.selection.getRng());readLocation(e,t.getBody(),o).bind((function(e){return renderCaretLocation(t,n,e)}))}))}};var move$2=function(e,t,n){return!!isInlineBoundariesEnabled(e)&&findLocation(e,t,n).isSome()};var moveWord=function(e,t,n){return!!isInlineBoundariesEnabled(t)&&moveByWord(e,t)};var setupSelectedState=function(e){var t=Cell(null);var n=curry(isInlineTarget,e);e.on("NodeChange",(function(a){if(isInlineBoundariesEnabled(e)&&!(ie.browser.isIE()&&a.initial)){toggleInlines(n,e.dom,a.parents);safeRemoveCaretContainer(e,t);renderInsideInlineCaret(n,e,t,a.parents)}}));return t};var $i=curry(moveWord,true);var Wi=curry(moveWord,false);var moveToLineEndPoint$2=function(e,t,n){if(isInlineBoundariesEnabled(e)){var a=getLineEndPoint(e,t).getOrThunk((function(){var n=e.selection.getRng();return t?CaretPosition.fromRangeEnd(n):CaretPosition.fromRangeStart(n)}));return readLocation(curry(isInlineTarget,e),e.getBody(),a).exists((function(t){var a=outside(t);return renderCaret(n,a).exists((function(t){setCaretPosition(e,t);return true}))}))}return false};var rangeFromPositions=function(e,t){var n=document.createRange();n.setStart(e.container(),e.offset());n.setEnd(t.container(),t.offset());return n};var hasOnlyTwoOrLessPositionsLeft=function(e){return lift2(Sa(e),Ea(e),(function(t,n){var a=normalizePosition(true,t);var o=normalizePosition(false,n);return wa(e,a).forall((function(e){return e.isEqual(o)}))})).getOr(true)};var setCaretLocation=function(e,t){return function(n){return renderCaret(t,n).exists((function(t){setCaretPosition(e,t);return true}))}};var deleteFromTo=function(e,t,n,a){var o=e.getBody();var i=curry(isInlineTarget,e);e.undoManager.ignore((function(){e.selection.setRng(rangeFromPositions(n,a));e.execCommand("Delete");readLocation(i,o,CaretPosition.fromRangeStart(e.selection.getRng())).map(inside).map(setCaretLocation(e,t))}));e.nodeChanged()};var rescope=function(e,t){var n=getParentBlock$2(t,e);return n||e};var backspaceDeleteCollapsed=function(e,t,n,a){var o=rescope(e.getBody(),a.container());var i=curry(isInlineTarget,e);var u=readLocation(i,o,a);return u.bind((function(e){return n?e.fold(constant(b.some(inside(e))),b.none,constant(b.some(outside(e))),b.none):e.fold(b.none,constant(b.some(outside(e))),b.none,constant(b.some(inside(e))))})).map(setCaretLocation(e,t)).getOrThunk((function(){var c=navigate(n,o,a);var f=c.bind((function(e){return readLocation(i,o,e)}));return lift2(u,f,(function(){return findRootInline(i,o,a).exists((function(t){if(hasOnlyTwoOrLessPositionsLeft(t)){deleteElement$2(e,n,se.fromDom(t));return true}return false}))})).orThunk((function(){return f.bind((function(o){return c.map((function(o){n?deleteFromTo(e,t,a,o):deleteFromTo(e,t,o,a);return true}))}))})).getOr(false)}))};var backspaceDelete$3=function(e,t,n){if(e.selection.isCollapsed()&&isInlineBoundariesEnabled(e)){var a=CaretPosition.fromRangeStart(e.selection.getRng());return backspaceDeleteCollapsed(e,t,n,a)}return false};var getParentInlines=function(e,t){var n=parentsAndSelf(t,e);return findIndex$2(n,at).fold(constant(n),(function(e){return n.slice(0,e)}))};var hasOnlyOneChild=function(e){return 1===childNodesCount(e)};var deleteLastPosition=function(e,t,n,a){var o=curry(isFormatElement,t);var i=map$3(filter$4(a,o),(function(e){return e.dom}));if(0===i.length)deleteElement$2(t,e,n);else{var u=replaceWithCaretFormat(n.dom,i);t.selection.setRng(u.toRange())}};var deleteCaret$1=function(e,t){var n=se.fromDom(e.getBody());var a=se.fromDom(e.selection.getStart());var o=filter$4(getParentInlines(n,a),hasOnlyOneChild);return last$2(o).exists((function(n){var a=CaretPosition.fromRangeStart(e.selection.getRng());if(willDeleteLastPositionInElement(t,a,n.dom)&&!isEmptyCaretFormatElement(n)){deleteLastPosition(t,e,n,o);return true}return false}))};var backspaceDelete$2=function(e,t){return!!e.selection.isCollapsed()&&deleteCaret$1(e,t)};var deleteElement=function(e,t,n){e._selectionOverrides.hideFakeCaret();deleteElement$2(e,t,se.fromDom(n));return true};var deleteCaret=function(e,t){var n=t?bo:yo;var a=t?da.Forwards:da.Backwards;var o=getNormalizedRangeEndPoint(a,e.getBody(),e.selection.getRng());return n(o)?deleteElement(e,t,o.getNode(!t)):b.from(normalizePosition(t,o)).filter((function(e){return n(e)&&isMoveInsideSameBlock(o,e)})).exists((function(n){return deleteElement(e,t,n.getNode(!t))}))};var deleteRange=function(e,t){var n=e.selection.getNode();return!!Le(n)&&deleteElement(e,t,n)};var backspaceDelete$1=function(e,t){return e.selection.isCollapsed()?deleteCaret(e,t):deleteRange(e,t)};var isEditable=function(e){return closest$3(e,(function(e){return Oe(e.dom)||Be(e.dom)})).exists((function(e){return Oe(e.dom)}))};var parseIndentValue=function(e){var t=parseInt(e,10);return isNaN(t)?0:t};var getIndentStyleName=function(e,t){var n=e||isTable$2(t)?"margin":"padding";var a="rtl"===get$5(t,"direction")?"-right":"-left";return n+a};var indentElement=function(e,t,n,a,o,i){var u=getIndentStyleName(n,se.fromDom(i));if("outdent"===t){var c=Math.max(0,parseIndentValue(i.style[u])-a);e.setStyle(i,u,c?c+o:"")}else{c=parseIndentValue(i.style[u])+a+o;e.setStyle(i,u,c)}};var validateBlocks=function(e,t){return forall(t,(function(t){var n=getIndentStyleName(shouldIndentUseMargin(e),t);var a=getRaw(t,n).map(parseIndentValue).getOr(0);var o=e.dom.getContentEditable(t.dom);return"false"!==o&&a>0}))};var canOutdent=function(e){var t=getBlocksToIndent(e);return!e.mode.isReadOnly()&&(t.length>1||validateBlocks(e,t))};var isListComponent=function(e){return it(e)||ut(e)};var parentIsListComponent=function(e){return parent(e).exists(isListComponent)};var getBlocksToIndent=function(e){return filter$4(fromDom$1(e.selection.getSelectedBlocks()),(function(e){return!isListComponent(e)&&!parentIsListComponent(e)&&isEditable(e)}))};var handle=function(e,t){var n=e.dom,a=e.selection,o=e.formatter;var i=getIndentation(e);var u=/[a-z%]+$/i.exec(i)[0];var c=parseInt(i,10);var f=shouldIndentUseMargin(e);var s=getForcedRootBlock(e);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||""!==s||n.getParent(a.getNode(),n.isBlock)||o.apply("div");each$k(getBlocksToIndent(e),(function(e){indentElement(n,t,f,c,u,e.dom)}))};var backspaceDelete=function(e,t){if(e.selection.isCollapsed()&&canOutdent(e)){var n=e.dom;var a=e.selection.getRng();var o=CaretPosition.fromRangeStart(a);var i=n.getParent(a.startContainer,n.isBlock);if(null!==i&&Eo(se.fromDom(i),o)){handle(e,"outdent");return true}}return false};var nativeCommand=function(e,t){e.getDoc().execCommand(t,false,null)};var deleteCommand=function(e,t){if(!backspaceDelete(e)&&!backspaceDelete$5(e,false)&&!backspaceDelete$6(e,false)&&!backspaceDelete$3(e,t,false)&&!backspaceDelete$8(e,false)&&!backspaceDelete$9(e)&&!backspaceDelete$4(e,false)&&!backspaceDelete$1(e,false)&&!backspaceDelete$7(e)&&!backspaceDelete$2(e,false)){nativeCommand(e,"Delete");paddEmptyBody(e)}};var forwardDeleteCommand=function(e,t){backspaceDelete$5(e,true)||backspaceDelete$6(e,true)||backspaceDelete$3(e,t,true)||backspaceDelete$8(e,true)||backspaceDelete$9(e)||backspaceDelete$4(e,true)||backspaceDelete$1(e,true)||backspaceDelete$7(e)||backspaceDelete$2(e,true)||nativeCommand(e,"ForwardDelete")};var setup$f=function(e,t){e.addCommand("delete",(function(){deleteCommand(e,t)}));e.addCommand("forwardDelete",(function(){forwardDeleteCommand(e,t)}))};var Ki=5;var Xi=400;var getTouch=function(e){return void 0===e.touches||1!==e.touches.length?b.none():b.some(e.touches[0])};var isFarEnough=function(e,t){var n=Math.abs(e.clientX-t.x);var a=Math.abs(e.clientY-t.y);return n>Ki||a>Ki};var setup$e=function(e){var t=value();var n=Cell(false);var a=last((function(t){e.fire("longpress",__assign(__assign({},t),{type:"longpress"}));n.set(true)}),Xi);e.on("touchstart",(function(e){getTouch(e).each((function(o){a.cancel();var i={x:o.clientX,y:o.clientY,target:e.target};a.throttle(e);n.set(false);t.set(i)}))}),true);e.on("touchmove",(function(o){a.cancel();getTouch(o).each((function(a){t.on((function(o){if(isFarEnough(a,o)){t.clear();n.set(false);e.fire("longpresscancel")}}))}))}),true);e.on("touchend touchcancel",(function(o){a.cancel();"touchcancel"!==o.type&&t.get().filter((function(e){return e.target.isEqualNode(o.target)})).each((function(){n.get()?o.preventDefault():e.fire("tap",__assign(__assign({},o),{type:"tap"}))}))}),true)};var isBlockElement=function(e,t){return has$2(e,t.nodeName)};var isValidTarget=function(e,t){return!!Ne(t)||!!Ee(t)&&(!isBlockElement(e,t)&&!isBookmarkNode$1(t))};var hasBlockParent=function(e,t,n){return exists(parents(se.fromDom(n),se.fromDom(t)),(function(t){return isBlockElement(e,t.dom)}))};var shouldRemoveTextNode=function(e,t){if(Ne(t)){if(0===t.nodeValue.length)return true;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||isBlockElement(e,t.nextSibling)))return true}return false};var addRootBlocks=function(e){var t=e.dom,n=e.selection;var a=e.schema,o=a.getBlockElements();var i=n.getStart();var u=e.getBody();var c,f,s;var l=getForcedRootBlock(e);if(i&&Ee(i)&&l){var v=u.nodeName.toLowerCase();if(a.isValidChild(v,l.toLowerCase())&&!hasBlockParent(o,u,i)){var d=n.getRng();var m=d.startContainer;var g=d.startOffset;var p=d.endContainer;var h=d.endOffset;var b=hasFocus(e);i=u.firstChild;while(i)if(isValidTarget(o,i)){if(shouldRemoveTextNode(o,i)){f=i;i=i.nextSibling;t.remove(f);continue}if(!c){c=t.create(l,getForcedRootBlockAttrs(e));i.parentNode.insertBefore(c,i);s=true}f=i;i=i.nextSibling;c.appendChild(f)}else{c=null;i=i.nextSibling}if(s&&b){d.setStart(m,g);d.setEnd(p,h);n.setRng(d);e.nodeChanged()}}}};var setup$d=function(e){getForcedRootBlock(e)&&e.on("NodeChange",curry(addRootBlocks,e))};var findBlockCaretContainer=function(e){return descendant(se.fromDom(e.getBody()),"*[data-mce-caret]").map((function(e){return e.dom})).getOrNull()};var removeIeControlRect=function(e){e.selection.setRng(e.selection.getRng())};var showBlockCaretContainer=function(e,t){if(t.hasAttribute("data-mce-caret")){showCaretContainerBlock(t);removeIeControlRect(e);e.selection.scrollIntoView(t)}};var handleBlockContainer=function(e,t){var n=findBlockCaretContainer(e);if(n)if("compositionstart"!==t.type){if(hasContent(n)){showBlockCaretContainer(e,n);e.undoManager.add()}}else{t.preventDefault();t.stopPropagation();showBlockCaretContainer(e,n)}};var setup$c=function(e){e.on("keyup compositionstart",curry(handleBlockContainer,e))};var Yi=Be;var moveToCeFalseHorizontally=function(e,t,n){return moveHorizontally(t,e,n,xo,So,Yi)};var moveToCeFalseVertically=function(e,t,n){var isBefore=function(e){return xo(e)||Co(e)};var isAfter=function(e){return So(e)||wo(e)};return moveVertically(t,e,n,isBefore,isAfter,Yi)};var createTextBlock=function(e){var t=e.dom.create(getForcedRootBlock(e));(!ie.ie||ie.ie>=11)&&(t.innerHTML='<br data-mce-bogus="1">');return t};var exitPreBlock=function(e,t,n){var a=CaretWalker(e.getBody());var o=curry(getVisualCaretPosition,1===t?a.next:a.prev);if(n.collapsed&&hasForcedRootBlock(e)){var i=e.dom.getParent(n.startContainer,"PRE");if(!i)return;var u=o(CaretPosition.fromRangeStart(n));if(!u){var c=createTextBlock(e);1===t?e.$(i).after(c):e.$(i).before(c);e.selection.select(c,true);e.selection.collapse()}}};var getHorizontalRange=function(e,t){var n=t?da.Forwards:da.Backwards;var a=e.selection.getRng();return moveToCeFalseHorizontally(n,e,a).orThunk((function(){exitPreBlock(e,n,a);return b.none()}))};var getVerticalRange=function(e,t){var n=t?1:-1;var a=e.selection.getRng();return moveToCeFalseVertically(n,e,a).orThunk((function(){exitPreBlock(e,n,a);return b.none()}))};var moveH$2=function(e,t){return getHorizontalRange(e,t).exists((function(t){moveToRange(e,t);return true}))};var moveV$3=function(e,t){return getVerticalRange(e,t).exists((function(t){moveToRange(e,t);return true}))};var moveToLineEndPoint$1=function(e,t){var n=t?So:xo;return moveToLineEndPoint$3(e,t,n)};var isTarget=function(e){return contains$3(["figcaption"],name(e))};var rangeBefore=function(e){var t=document.createRange();t.setStartBefore(e.dom);t.setEndBefore(e.dom);return t};var insertElement=function(e,t,n){n?append$1(e,t):prepend(e,t)};var insertBr=function(e,t){var n=se.fromTag("br");insertElement(e,n,t);return rangeBefore(n)};var insertBlock=function(e,t,n,a){var o=se.fromTag(n);var i=se.fromTag("br");setAll$1(o,a);append$1(o,i);insertElement(e,o,t);return rangeBefore(i)};var insertEmptyLine=function(e,t,n,a){return""===t?insertBr(e,a):insertBlock(e,a,t,n)};var getClosestTargetBlock=function(e,t){var n=curry(eq,t);return closest$3(se.fromDom(e.container()),at,n).filter(isTarget)};var isAtFirstOrLastLine=function(e,t,n){return t?isAtLastLine(e.dom,n):isAtFirstLine(e.dom,n)};var moveCaretToNewEmptyLine=function(e,t){var n=se.fromDom(e.getBody());var a=CaretPosition.fromRangeStart(e.selection.getRng());var o=getForcedRootBlock(e);var i=getForcedRootBlockAttrs(e);return getClosestTargetBlock(a,n).exists((function(){if(isAtFirstOrLastLine(n,t,a)){var u=insertEmptyLine(n,o,i,t);e.selection.setRng(u);return true}return false}))};var moveV$2=function(e,t){return!!e.selection.isCollapsed()&&moveCaretToNewEmptyLine(e,t)};var defaultPatterns=function(e){return map$3(e,(function(e){return __assign({shiftKey:false,altKey:false,ctrlKey:false,metaKey:false,keyCode:0,action:noop},e)}))};var matchesEvent=function(e,t){return t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey};var match$1=function(e,t){return bind(defaultPatterns(e),(function(e){return matchesEvent(e,t)?[e]:[]}))};var action=function(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(null,t)}};var execute=function(e,t){return find$3(match$1(e,t),(function(e){return e.action()}))};var moveH$1=function(e,t){var n=t?da.Forwards:da.Backwards;var a=e.selection.getRng();return moveHorizontally(e,n,a,bo,yo,Le).exists((function(t){moveToRange(e,t);return true}))};var moveV$1=function(e,t){var n=t?1:-1;var a=e.selection.getRng();return moveVertically(e,n,a,bo,yo,Le).exists((function(t){moveToRange(e,t);return true}))};var moveToLineEndPoint=function(e,t){var n=t?yo:bo;return moveToLineEndPoint$3(e,t,n)};var deflate=function(e,t){return{left:e.left-t,top:e.top-t,right:e.right+2*t,bottom:e.bottom+2*t,width:e.width+t,height:e.height+t}};var getCorners=function(e,t){return bind(t,(function(t){var n=deflate(clone(t.getBoundingClientRect()),-1);return[{x:n.left,y:e(n),cell:t},{x:n.right,y:e(n),cell:t}]}))};var findClosestCorner=function(e,t,n){return foldl(e,(function(e,a){return e.fold((function(){return b.some(a)}),(function(e){var o=Math.sqrt(Math.abs(e.x-t)+Math.abs(e.y-n));var i=Math.sqrt(Math.abs(a.x-t)+Math.abs(a.y-n));return b.some(i<o?a:e)}))}),b.none())};var getClosestCell=function(e,t,n,a,o){var i=descendants(se.fromDom(n),"td,th,caption").map((function(e){return e.dom}));var u=filter$4(getCorners(e,i),(function(e){return t(e,o)}));return findClosestCorner(u,a,o).map((function(e){return e.cell}))};var getBottomValue=function(e){return e.bottom};var getTopValue=function(e){return e.top};var isAbove=function(e,t){return e.y<t};var isBelow=function(e,t){return e.y>t};var Gi=curry(getClosestCell,getBottomValue,isAbove);var Ji=curry(getClosestCell,getTopValue,isBelow);var findClosestPositionInAboveCell=function(e,t){return head(t.getClientRects()).bind((function(t){return Gi(e,t.left,t.top)})).bind((function(e){return findClosestHorizontalPosition(getLastLinePositions(e),t)}))};var findClosestPositionInBelowCell=function(e,t){return last$2(t.getClientRects()).bind((function(t){return Ji(e,t.left,t.top)})).bind((function(e){return findClosestHorizontalPosition(getFirstLinePositions(e),t)}))};var hasNextBreak=function(e,t,n){return n.breakAt.exists((function(n){return e(t,n).breakAt.isSome()}))};var startsWithWrapBreak=function(e){return e.breakType===Li.Wrap&&0===e.positions.length};var startsWithBrBreak=function(e){return e.breakType===Li.Br&&1===e.positions.length};var isAtTableCellLine=function(e,t,n){var a=e(t,n);return startsWithWrapBreak(a)||!De(n.getNode())&&startsWithBrBreak(a)?!hasNextBreak(e,t,a):a.breakAt.isNone()};var Qi=curry(isAtTableCellLine,Ii);var Zi=curry(isAtTableCellLine,Mi);var isCaretAtStartOrEndOfTable=function(e,t,n){var a=CaretPosition.fromRangeStart(t);return positionIn(!e,n).exists((function(e){return e.isEqual(a)}))};var navigateHorizontally=function(e,t,n,a){var o=e.selection.getRng();var i=t?1:-1;if(isFakeCaretTableBrowser()&&isCaretAtStartOrEndOfTable(t,o,n)){showCaret(i,e,n,!t,false).each((function(t){moveToRange(e,t)}));return true}return false};var getClosestAbovePosition=function(e,t,n){return findClosestPositionInAboveCell(t,n).orThunk((function(){return head(n.getClientRects()).bind((function(n){return findClosestHorizontalPositionFromPoint(Fi(e,CaretPosition.before(t)),n.left)}))})).getOr(CaretPosition.before(t))};var getClosestBelowPosition=function(e,t,n){return findClosestPositionInBelowCell(t,n).orThunk((function(){return head(n.getClientRects()).bind((function(n){return findClosestHorizontalPositionFromPoint(Ui(e,CaretPosition.after(t)),n.left)}))})).getOr(CaretPosition.after(t))};var getTable=function(e,t){var n=t.getNode(e);return Ee(n)&&"TABLE"===n.nodeName?b.some(n):b.none()};var renderBlock=function(e,t,n,a){var o=getForcedRootBlock(t);o?t.undoManager.transact((function(){var a=se.fromTag(o);setAll$1(a,getForcedRootBlockAttrs(t));append$1(a,se.fromTag("br"));e?after$3(se.fromDom(n),a):before$4(se.fromDom(n),a);var i=t.dom.createRng();i.setStart(a.dom,0);i.setEnd(a.dom,0);moveToRange(t,i)})):moveToRange(t,a.toRange())};var moveCaret=function(e,t,n){var a=getTable(!!t,n);var o=false===t;a.fold((function(){return moveToRange(e,n.toRange())}),(function(a){return positionIn(o,e.getBody()).filter((function(e){return e.isEqual(n)})).fold((function(){return moveToRange(e,n.toRange())}),(function(o){return renderBlock(t,e,a,n)}))}))};var navigateVertically=function(e,t,n,a){var o=e.selection.getRng();var i=CaretPosition.fromRangeStart(o);var u=e.getBody();if(!t&&Qi(a,i)){var c=getClosestAbovePosition(u,n,i);moveCaret(e,t,c);return true}if(t&&Zi(a,i)){c=getClosestBelowPosition(u,n,i);moveCaret(e,t,c);return true}return false};var move$1=function(e,t,n){return b.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((function(a){return b.from(e.dom.getParent(a,"table")).map((function(o){return n(e,t,o,a)}))})).getOr(false)};var moveH=function(e,t){return move$1(e,t,navigateHorizontally)};var moveV=function(e,t){return move$1(e,t,navigateVertically)};var executeKeydownOverride$3=function(e,t,n){var a=detect().os;execute([{keyCode:Oa.RIGHT,action:action(moveH$2,e,true)},{keyCode:Oa.LEFT,action:action(moveH$2,e,false)},{keyCode:Oa.UP,action:action(moveV$3,e,false)},{keyCode:Oa.DOWN,action:action(moveV$3,e,true)},{keyCode:Oa.RIGHT,action:action(moveH,e,true)},{keyCode:Oa.LEFT,action:action(moveH,e,false)},{keyCode:Oa.UP,action:action(moveV,e,false)},{keyCode:Oa.DOWN,action:action(moveV,e,true)},{keyCode:Oa.RIGHT,action:action(moveH$1,e,true)},{keyCode:Oa.LEFT,action:action(moveH$1,e,false)},{keyCode:Oa.UP,action:action(moveV$1,e,false)},{keyCode:Oa.DOWN,action:action(moveV$1,e,true)},{keyCode:Oa.RIGHT,action:action(move$2,e,t,true)},{keyCode:Oa.LEFT,action:action(move$2,e,t,false)},{keyCode:Oa.RIGHT,ctrlKey:!a.isOSX(),altKey:a.isOSX(),action:action($i,e,t)},{keyCode:Oa.LEFT,ctrlKey:!a.isOSX(),altKey:a.isOSX(),action:action(Wi,e,t)},{keyCode:Oa.UP,action:action(moveV$2,e,false)},{keyCode:Oa.DOWN,action:action(moveV$2,e,true)}],n).each((function(e){n.preventDefault()}))};var setup$b=function(e,t){e.on("keydown",(function(n){false===n.isDefaultPrevented()&&executeKeydownOverride$3(e,t,n)}))};var executeKeydownOverride$2=function(e,t,n){execute([{keyCode:Oa.BACKSPACE,action:action(backspaceDelete,e,false)},{keyCode:Oa.BACKSPACE,action:action(backspaceDelete$5,e,false)},{keyCode:Oa.DELETE,action:action(backspaceDelete$5,e,true)},{keyCode:Oa.BACKSPACE,action:action(backspaceDelete$6,e,false)},{keyCode:Oa.DELETE,action:action(backspaceDelete$6,e,true)},{keyCode:Oa.BACKSPACE,action:action(backspaceDelete$3,e,t,false)},{keyCode:Oa.DELETE,action:action(backspaceDelete$3,e,t,true)},{keyCode:Oa.BACKSPACE,action:action(backspaceDelete$9,e,false)},{keyCode:Oa.DELETE,action:action(backspaceDelete$9,e,true)},{keyCode:Oa.BACKSPACE,action:action(backspaceDelete$4,e,false)},{keyCode:Oa.DELETE,action:action(backspaceDelete$4,e,true)},{keyCode:Oa.BACKSPACE,action:action(backspaceDelete$1,e,false)},{keyCode:Oa.DELETE,action:action(backspaceDelete$1,e,true)},{keyCode:Oa.BACKSPACE,action:action(backspaceDelete$7,e,false)},{keyCode:Oa.DELETE,action:action(backspaceDelete$7,e,true)},{keyCode:Oa.BACKSPACE,action:action(backspaceDelete$8,e,false)},{keyCode:Oa.DELETE,action:action(backspaceDelete$8,e,true)},{keyCode:Oa.BACKSPACE,action:action(backspaceDelete$2,e,false)},{keyCode:Oa.DELETE,action:action(backspaceDelete$2,e,true)}],n).each((function(e){n.preventDefault()}))};var executeKeyupOverride=function(e,t){execute([{keyCode:Oa.BACKSPACE,action:action(paddEmptyElement,e)},{keyCode:Oa.DELETE,action:action(paddEmptyElement,e)}],t)};var setup$a=function(e,t){e.on("keydown",(function(n){false===n.isDefaultPrevented()&&executeKeydownOverride$2(e,t,n)}));e.on("keyup",(function(t){false===t.isDefaultPrevented()&&executeKeyupOverride(e,t)}))};var firstNonWhiteSpaceNodeSibling=function(e){while(e){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}};var moveToCaretPosition=function(e,t){var n,a=t;var o=e.dom;var i=e.schema.getMoveCaretBeforeOnEnterElements();if(t){if(/^(LI|DT|DD)$/.test(t.nodeName)){var u=firstNonWhiteSpaceNodeSibling(t.firstChild);u&&/^(UL|OL|DL)$/.test(u.nodeName)&&t.insertBefore(o.doc.createTextNode(vt),t.firstChild)}var c=o.createRng();t.normalize();if(t.hasChildNodes()){var f=new Xe(t,t);while(n=f.current()){if(Ne(n)){c.setStart(n,0);c.setEnd(n,0);break}if(i[n.nodeName.toLowerCase()]){c.setStartBefore(n);c.setEndBefore(n);break}a=n;n=f.next()}if(!n){c.setStart(a,0);c.setEnd(a,0)}}else if(De(t))if(t.nextSibling&&o.isBlock(t.nextSibling)){c.setStartBefore(t);c.setEndBefore(t)}else{c.setStartAfter(t);c.setEndAfter(t)}else{c.setStart(t,0);c.setEnd(t,0)}e.selection.setRng(c);scrollRangeIntoView(e,c)}};var getEditableRoot$1=function(e,t){var n=e.getRoot();var a,o;a=t;while(a!==n&&"false"!==e.getContentEditable(a)){"true"===e.getContentEditable(a)&&(o=a);a=a.parentNode}return a!==n?o:n};var getParentBlock=function(e){return b.from(e.dom.getParent(e.selection.getStart(true),e.dom.isBlock))};var getParentBlockName=function(e){return getParentBlock(e).fold(constant(""),(function(e){return e.nodeName.toUpperCase()}))};var isListItemParentBlock=function(e){return getParentBlock(e).filter((function(e){return ut(se.fromDom(e))})).isSome()};var hasFirstChild=function(e,t){return e.firstChild&&e.firstChild.nodeName===t};var isFirstChild=function(e){var t;return(null===(t=e.parentNode)||void 0===t?void 0:t.firstChild)===e};var hasParent=function(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t};var isListBlock=function(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)};var isNestedList=function(e){return isListBlock(e)&&isListBlock(e.parentNode)};var getContainerBlock=function(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e};var isFirstOrLastLi=function(e,t,n){var a=e[n?"firstChild":"lastChild"];while(a){if(Ee(a))break;a=a[n?"nextSibling":"previousSibling"]}return a===t};var insert$3=function(e,t,n,a,o){var i=e.dom;var u=e.selection.getRng();if(n!==e.getBody()){isNestedList(n)&&(o="LI");var c=o?t(o):i.create("BR");if(isFirstOrLastLi(n,a,true)&&isFirstOrLastLi(n,a,false))if(hasParent(n,"LI")){var f=getContainerBlock(n);i.insertAfter(c,f);isFirstChild(n)?i.remove(f):i.remove(n)}else i.replace(c,n);else if(isFirstOrLastLi(n,a,true)){if(hasParent(n,"LI")){i.insertAfter(c,getContainerBlock(n));c.appendChild(i.doc.createTextNode(" "));c.appendChild(n)}else n.parentNode.insertBefore(c,n);i.remove(a)}else if(isFirstOrLastLi(n,a,false)){i.insertAfter(c,getContainerBlock(n));i.remove(a)}else{n=getContainerBlock(n);var s=u.cloneRange();s.setStartAfter(a);s.setEndAfter(n);var l=s.extractContents();if("LI"===o&&hasFirstChild(l,"LI")){c=l.firstChild;i.insertAfter(l,n)}else{i.insertAfter(l,n);i.insertAfter(c,n)}i.remove(a)}moveToCaretPosition(e,c)}};var trimZwsp=function(e){each$k(descendants$1(se.fromDom(e),he),(function(e){var t=e.dom;t.nodeValue=gt(t.nodeValue)}))};var isEmptyAnchor=function(e,t){return t&&"A"===t.nodeName&&e.isEmpty(t)};var isTableCell=function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)};var emptyBlock=function(e){e.innerHTML='<br data-mce-bogus="1">'};var containerAndSiblingName=function(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t};var canSplitBlock=function(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)};var trimInlineElementsOnLeftSideOfBlock=function(e,t,n){var a=n;var o=[];var i;if(a){while(a=a.firstChild){if(e.isBlock(a))return;Ee(a)&&!t[a.nodeName.toLowerCase()]&&o.push(a)}i=o.length;while(i--){a=o[i];(!a.hasChildNodes()||a.firstChild===a.lastChild&&""===a.firstChild.nodeValue||isEmptyAnchor(e,a))&&e.remove(a)}}};var normalizeZwspOffset=function(e,t,n){return false===Ne(t)?n:e?1===n&&t.data.charAt(n-1)===dt?0:n:n===t.data.length-1&&t.data.charAt(n)===dt?t.data.length:n};var includeZwspInRange=function(e){var t=e.cloneRange();t.setStart(e.startContainer,normalizeZwspOffset(true,e.startContainer,e.startOffset));t.setEnd(e.endContainer,normalizeZwspOffset(false,e.endContainer,e.endOffset));return t};var trimLeadingLineBreaks=function(e){do{Ne(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,""));e=e.firstChild}while(e)};var getEditableRoot=function(e,t){var n=e.getRoot();var a,o;a=t;while(a!==n&&"false"!==e.getContentEditable(a)){"true"===e.getContentEditable(a)&&(o=a);a=a.parentNode}return a!==n?o:n};var applyAttributes=function(e,t,n){var a=e.dom;b.from(n.style).map(a.parseStyle).each((function(e){var n=getAllRaw(se.fromDom(t));var o=__assign(__assign({},n),e);a.setStyles(t,o)}));var o=b.from(n.class).map((function(e){return e.split(/\s+/)}));var i=b.from(t.className).map((function(e){return filter$4(e.split(/\s+/),(function(e){return""!==e}))}));lift2(o,i,(function(e,n){var o=filter$4(n,(function(t){return!contains$3(e,t)}));var i=__spreadArray(__spreadArray([],e,true),o,true);a.setAttrib(t,"class",i.join(" "))}));var u=["style","class"];var c=filter$3(n,(function(e,t){return!contains$3(u,t)}));a.setAttribs(t,c)};var setForcedBlockAttrs=function(e,t){var n=getForcedRootBlock(e);if(n&&n.toLowerCase()===t.tagName.toLowerCase()){var a=getForcedRootBlockAttrs(e);applyAttributes(e,t,a)}};var wrapSelfAndSiblingsInDefaultBlock=function(e,t,n,a,o){var i,u,c,f,s,l;var v=t||"P";var d=e.dom,m=getEditableRoot(d,a);u=d.getParent(a,d.isBlock);if(!u||!canSplitBlock(d,u)){u=u||m;l=u===e.getBody()||isTableCell(u)?u.nodeName.toLowerCase():u.parentNode.nodeName.toLowerCase();if(!u.hasChildNodes()){i=d.create(v);setForcedBlockAttrs(e,i);u.appendChild(i);n.setStart(i,0);n.setEnd(i,0);return i}f=a;while(f.parentNode!==u)f=f.parentNode;while(f&&!d.isBlock(f)){c=f;f=f.previousSibling}if(c&&e.schema.isValidChild(l,v.toLowerCase())){i=d.create(v);setForcedBlockAttrs(e,i);c.parentNode.insertBefore(i,c);f=c;while(f&&!d.isBlock(f)){s=f.nextSibling;i.appendChild(f);f=s}n.setStart(a,o);n.setEnd(a,o)}}return a};var addBrToBlockIfNeeded=function(e,t){t.normalize();var n=t.lastChild;n&&!/^(left|right)$/gi.test(e.getStyle(n,"float",true))||e.add(t,"br")};var insert$2=function(e,t){var n,a,o,i;var u,c,f,s,l,v;var d=e.dom;var m=e.schema,g=m.getNonEmptyElements();var p=e.selection.getRng();var createNewBlock=function(t){var n,o,u,c=a;var f=m.getTextInlineElements();n=t||"TABLE"===s||"HR"===s?d.create(t||l):i.cloneNode(false);u=n;if(false===shouldKeepStyles(e)){d.setAttrib(n,"style",null);d.setAttrib(n,"class",null)}else do{if(f[c.nodeName]){if(isCaretNode(c)||isBookmarkNode$1(c))continue;o=c.cloneNode(false);d.setAttrib(o,"id","");if(n.hasChildNodes()){o.appendChild(n.firstChild);n.appendChild(o)}else{u=o;n.appendChild(o)}}}while((c=c.parentNode)&&c!==y);setForcedBlockAttrs(e,n);emptyBlock(u);return n};var isCaretAtStartOrEndOfBlock=function(e){var t,n;var u=normalizeZwspOffset(e,a,o);if(Ne(a)&&(e?u>0:u<a.nodeValue.length))return false;if(a.parentNode===i&&v&&!e)return true;if(e&&Ee(a)&&a===i.firstChild)return true;if(containerAndSiblingName(a,"TABLE")||containerAndSiblingName(a,"HR"))return v&&!e||!v&&e;var c=new Xe(a,i);Ne(a)&&(e&&0===u?c.prev():e||u!==a.nodeValue.length||c.next());while(t=c.current()){if(Ee(t)){if(!t.getAttribute("data-mce-bogus")){n=t.nodeName.toLowerCase();if(g[n]&&"br"!==n)return false}}else if(Ne(t)&&!isWhitespaceText(t.nodeValue))return false;e?c.prev():c.next()}return true};var insertNewBlockAfter=function(){u=/^(H[1-6]|PRE|FIGURE)$/.test(s)&&"HGROUP"!==C?createNewBlock(l):createNewBlock();shouldEndContainerOnEmptyBlock(e)&&canSplitBlock(d,f)&&d.isEmpty(i)?u=d.split(f,i):d.insertAfter(u,i);moveToCaretPosition(e,u)};normalize$2(d,p).each((function(e){p.setStart(e.startContainer,e.startOffset);p.setEnd(e.endContainer,e.endOffset)}));a=p.startContainer;o=p.startOffset;l=getForcedRootBlock(e);var h=!!(t&&t.shiftKey);var b=!!(t&&t.ctrlKey);if(Ee(a)&&a.hasChildNodes()){v=o>a.childNodes.length-1;a=a.childNodes[Math.min(o,a.childNodes.length-1)]||a;o=v&&Ne(a)?a.nodeValue.length:0}var y=getEditableRoot(d,a);if(y){(l&&!h||!l&&h)&&(a=wrapSelfAndSiblingsInDefaultBlock(e,l,p,a,o));i=d.getParent(a,d.isBlock);f=i?d.getParent(i.parentNode,d.isBlock):null;s=i?i.nodeName.toUpperCase():"";var C=f?f.nodeName.toUpperCase():"";if("LI"===C&&!b){i=f;f=f.parentNode;s=C}if(/^(LI|DT|DD)$/.test(s)&&d.isEmpty(i))insert$3(e,createNewBlock,f,i,l);else if(!l||i!==e.getBody()){l=l||"P";if(isCaretContainerBlock$1(i)){u=showCaretContainerBlock(i);d.isEmpty(i)&&emptyBlock(i);setForcedBlockAttrs(e,u);moveToCaretPosition(e,u)}else if(isCaretAtStartOrEndOfBlock())insertNewBlockAfter();else if(isCaretAtStartOrEndOfBlock(true)){u=i.parentNode.insertBefore(createNewBlock(),i);moveToCaretPosition(e,containerAndSiblingName(i,"HR")?u:i)}else{n=includeZwspInRange(p).cloneRange();n.setEndAfter(i);c=n.extractContents();trimZwsp(c);trimLeadingLineBreaks(c);u=c.firstChild;d.insertAfter(c,i);trimInlineElementsOnLeftSideOfBlock(d,g,u);addBrToBlockIfNeeded(d,i);d.isEmpty(i)&&emptyBlock(i);u.normalize();if(d.isEmpty(u)){d.remove(u);insertNewBlockAfter()}else{setForcedBlockAttrs(e,u);moveToCaretPosition(e,u)}}d.setAttrib(u,"id","");e.fire("NewBlock",{newBlock:u})}}};var hasRightSideContent=function(e,t,n){var a=new Xe(t,n);var o;var i=e.getNonEmptyElements();while(o=a.next())if(i[o.nodeName.toLowerCase()]||o.length>0)return true};var moveSelectionToBr=function(e,t,n){var a=e.dom.createRng();if(n){a.setStartBefore(t);a.setEndBefore(t)}else{a.setStartAfter(t);a.setEndAfter(t)}e.selection.setRng(a);scrollRangeIntoView(e,a)};var insertBrAtCaret=function(e,t){var n=e.selection;var a=e.dom;var o=n.getRng();var i;var u;normalize$2(a,o).each((function(e){o.setStart(e.startContainer,e.startOffset);o.setEnd(e.endContainer,e.endOffset)}));var c=o.startOffset;var f=o.startContainer;if(1===f.nodeType&&f.hasChildNodes()){var s=c>f.childNodes.length-1;f=f.childNodes[Math.min(c,f.childNodes.length-1)]||f;c=s&&3===f.nodeType?f.nodeValue.length:0}var l=a.getParent(f,a.isBlock);var v=l?a.getParent(l.parentNode,a.isBlock):null;var d=v?v.nodeName.toUpperCase():"";var m=!!(t&&t.ctrlKey);"LI"!==d||m||(l=v);if(f&&3===f.nodeType&&c>=f.nodeValue.length&&!hasRightSideContent(e.schema,f,l)){i=a.create("br");o.insertNode(i);o.setStartAfter(i);o.setEndAfter(i);u=true}i=a.create("br");rangeInsertNode(a,o,i);moveSelectionToBr(e,i,u);e.undoManager.add()};var insertBrBefore=function(e,t){var n=se.fromTag("br");before$4(se.fromDom(t),n);e.undoManager.add()};var insertBrAfter=function(e,t){hasBrAfter(e.getBody(),t)||after$3(se.fromDom(t),se.fromTag("br"));var n=se.fromTag("br");after$3(se.fromDom(t),n);moveSelectionToBr(e,n.dom,false);e.undoManager.add()};var isBeforeBr=function(e){return De(e.getNode())};var hasBrAfter=function(e,t){return!!isBeforeBr(CaretPosition.after(t))||wa(e,CaretPosition.after(t)).map((function(e){return De(e.getNode())})).getOr(false)};var isAnchorLink=function(e){return e&&"A"===e.nodeName&&"href"in e};var isInsideAnchor=function(e){return e.fold(g,isAnchorLink,isAnchorLink,g)};var readInlineAnchorLocation=function(e){var t=curry(isInlineTarget,e);var n=CaretPosition.fromRangeStart(e.selection.getRng());return readLocation(t,e.getBody(),n).filter(isInsideAnchor)};var insertBrOutsideAnchor=function(e,t){t.fold(noop,curry(insertBrBefore,e),curry(insertBrAfter,e),noop)};var insert$1=function(e,t){var n=readInlineAnchorLocation(e);n.isSome()?n.each(curry(insertBrOutsideAnchor,e)):insertBrAtCaret(e,t)};var matchesSelector=function(e,t){return getParentBlock(e).filter((function(e){return t.length>0&&is$2(se.fromDom(e),t)})).isSome()};var shouldInsertBr=function(e){return matchesSelector(e,getBrNewLineSelector(e))};var shouldBlockNewLine$1=function(e){return matchesSelector(e,getNoNewLineSelector(e))};var eu=Ve.generate([{br:[]},{block:[]},{none:[]}]);var shouldBlockNewLine=function(e,t){return shouldBlockNewLine$1(e)};var isBrMode=function(e){return function(t,n){var a=""===getForcedRootBlock(t);return a===e}};var inListBlock=function(e){return function(t,n){return isListItemParentBlock(t)===e}};var inBlock=function(e,t){return function(n,a){var o=getParentBlockName(n)===e.toUpperCase();return o===t}};var inPreBlock=function(e){return inBlock("pre",e)};var inSummaryBlock=function(){return inBlock("summary",true)};var shouldPutBrInPre=function(e){return function(t,n){return shouldPutBrInPre$1(t)===e}};var inBrContext=function(e,t){return shouldInsertBr(e)};var hasShiftKey=function(e,t){return t};var canInsertIntoEditableRoot=function(e){var t=getForcedRootBlock(e);var n=getEditableRoot$1(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")};var match=function(e,t){return function(n,a){var o=foldl(e,(function(e,t){return e&&t(n,a)}),true);return o?b.some(t):b.none()}};var getAction=function(e,t){return evaluateUntil([match([shouldBlockNewLine],eu.none()),match([inSummaryBlock()],eu.br()),match([inPreBlock(true),shouldPutBrInPre(false),hasShiftKey],eu.br()),match([inPreBlock(true),shouldPutBrInPre(false)],eu.block()),match([inPreBlock(true),shouldPutBrInPre(true),hasShiftKey],eu.block()),match([inPreBlock(true),shouldPutBrInPre(true)],eu.br()),match([inListBlock(true),hasShiftKey],eu.br()),match([inListBlock(true)],eu.block()),match([isBrMode(true),hasShiftKey,canInsertIntoEditableRoot],eu.block()),match([isBrMode(true)],eu.br()),match([inBrContext],eu.br()),match([isBrMode(false),hasShiftKey],eu.br()),match([canInsertIntoEditableRoot],eu.block())],[e,!!(t&&t.shiftKey)]).getOr(eu.none())};var insert=function(e,t){getAction(e,t).fold((function(){insert$1(e,t)}),(function(){insert$2(e,t)}),noop)};var handleEnterKeyEvent=function(e,t){if(!t.isDefaultPrevented()){t.preventDefault();endTypingLevelIgnoreLocks(e.undoManager);e.undoManager.transact((function(){false===e.selection.isCollapsed()&&e.execCommand("Delete");insert(e,t)}))}};var setup$9=function(e){e.on("keydown",(function(t){t.keyCode===Oa.ENTER&&handleEnterKeyEvent(e,t)}))};var executeKeydownOverride$1=function(e,t,n){execute([{keyCode:Oa.END,action:action(moveToLineEndPoint$1,e,true)},{keyCode:Oa.HOME,action:action(moveToLineEndPoint$1,e,false)},{keyCode:Oa.END,action:action(moveToLineEndPoint,e,true)},{keyCode:Oa.HOME,action:action(moveToLineEndPoint,e,false)},{keyCode:Oa.END,action:action(moveToLineEndPoint$2,e,true,t)},{keyCode:Oa.HOME,action:action(moveToLineEndPoint$2,e,false,t)}],n).each((function(e){n.preventDefault()}))};var setup$8=function(e,t){e.on("keydown",(function(n){false===n.isDefaultPrevented()&&executeKeydownOverride$1(e,t,n)}))};var tu=detect().browser;var setupIeInput=function(e){var t=first((function(){e.composing||normalizeNbspsInEditor(e)}),0);if(tu.isIE()){e.on("keypress",(function(e){t.throttle()}));e.on("remove",(function(e){t.cancel()}))}};var setup$7=function(e){setupIeInput(e);e.on("input",(function(t){false===t.isComposing&&normalizeNbspsInEditor(e)}))};var ru=detect();var executeKeyupAction=function(e,t,n){execute([{keyCode:Oa.PAGE_UP,action:action(moveToLineEndPoint$2,e,false,t)},{keyCode:Oa.PAGE_DOWN,action:action(moveToLineEndPoint$2,e,true,t)}],n)};var stopImmediatePropagation=function(e){return e.stopImmediatePropagation()};var isPageUpDown=function(e){return e.keyCode===Oa.PAGE_UP||e.keyCode===Oa.PAGE_DOWN};var setNodeChangeBlocker=function(e,t,n){n&&!e.get()?t.on("NodeChange",stopImmediatePropagation,true):!n&&e.get()&&t.off("NodeChange",stopImmediatePropagation);e.set(n)};var setup$6=function(e,t){if(!ru.os.isOSX()){var n=Cell(false);e.on("keydown",(function(t){isPageUpDown(t)&&setNodeChangeBlocker(n,e,true)}));e.on("keyup",(function(a){false===a.isDefaultPrevented()&&executeKeyupAction(e,t,a);if(isPageUpDown(a)&&n.get()){setNodeChangeBlocker(n,e,false);e.nodeChanged()}}))}};var insertTextAtPosition=function(e,t){var n=t.container();var a=t.offset();if(Ne(n)){n.insertData(a,e);return b.some(CaretPosition(n,a+e.length))}return getElementFromPosition(t).map((function(n){var a=se.fromText(e);t.isAtEnd()?after$3(n,a):before$4(n,a);return CaretPosition(a.dom,e.length)}))};var au=curry(insertTextAtPosition,vt);var ou=curry(insertTextAtPosition," ");var locationToCaretPosition=function(e){return function(t){return t.fold((function(t){return xa(e.dom,CaretPosition.before(t))}),(function(e){return Sa(e)}),(function(e){return Ea(e)}),(function(t){return wa(e.dom,CaretPosition.after(t))}))}};var insertInlineBoundarySpaceOrNbsp=function(e,t){return function(n){return needsToHaveNbsp(e,n)?au(t):ou(t)}};var setSelection=function(e){return function(t){e.selection.setRng(t.toRange());e.nodeChanged();return true}};var insertSpaceOrNbspAtSelection=function(e){var t=CaretPosition.fromRangeStart(e.selection.getRng());var n=se.fromDom(e.getBody());if(e.selection.isCollapsed()){var a=curry(isInlineTarget,e);var o=CaretPosition.fromRangeStart(e.selection.getRng());return readLocation(a,e.getBody(),o).bind(locationToCaretPosition(n)).bind(insertInlineBoundarySpaceOrNbsp(n,t)).exists(setSelection(e))}return false};var executeKeydownOverride=function(e,t){execute([{keyCode:Oa.SPACEBAR,action:action(insertSpaceOrNbspAtSelection,e)}],t).each((function(e){t.preventDefault()}))};var setup$5=function(e){e.on("keydown",(function(t){false===t.isDefaultPrevented()&&executeKeydownOverride(e,t)}))};var registerKeyboardOverrides=function(e){var t=setupSelectedState(e);setup$c(e);setup$b(e,t);setup$a(e,t);setup$9(e);setup$5(e);setup$7(e);setup$8(e,t);setup$6(e,t);return t};var setup$4=function(e){return isRtc(e)?Cell(null):registerKeyboardOverrides(e)};var iu=function(){function NodeChange(e){(this||t).lastPath=[];(this||t).editor=e;var n;var a=this||t;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",(function(t){var a=e.selection.getRng();var o={startContainer:a.startContainer,startOffset:a.startOffset,endContainer:a.endContainer,endOffset:a.endOffset};"nodechange"!==t.type&&isEq$4(o,n)||e.fire("SelectionChange");n=o}));e.on("contextmenu",(function(){e.fire("SelectionChange")}));e.on("SelectionChange",(function(){var t=e.selection.getStart(true);!t||!ie.range&&e.selection.isCollapsed()||hasAnyRanges(e)&&!a.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:true})}));e.on("mouseup",(function(t){!t.isDefaultPrevented()&&hasAnyRanges(e)&&("IMG"===e.selection.getNode().nodeName?We.setEditorTimeout(e,(function(){e.nodeChanged()})):e.nodeChanged())}))}NodeChange.prototype.nodeChanged=function(e){var n=(this||t).editor.selection;var a,o,i;if((this||t).editor.initialized&&n&&!shouldDisableNodeChange((this||t).editor)&&!(this||t).editor.mode.isReadOnly()){i=(this||t).editor.getBody();a=n.getStart(true)||i;a.ownerDocument===(this||t).editor.getDoc()&&(this||t).editor.dom.isChildOf(a,i)||(a=i);o=[];(this||t).editor.dom.getParent(a,(function(e){if(e===i)return true;o.push(e)}));e=e||{};e.element=a;e.parents=o;(this||t).editor.fire("NodeChange",e)}};NodeChange.prototype.isSameElementPath=function(e){var n;var a=(this||t).editor.$(e).parentsUntil((this||t).editor.getBody()).add(e);if(a.length===(this||t).lastPath.length){for(n=a.length;n>=0;n--)if(a[n]!==(this||t).lastPath[n])break;if(-1===n){(this||t).lastPath=a;return true}}(this||t).lastPath=a;return false};return NodeChange}();var preventSummaryToggle=function(e){e.on("click",(function(t){e.dom.getParent(t.target,"details")&&t.preventDefault()}))};var filterDetails=function(e){e.parser.addNodeFilter("details",(function(e){each$k(e,(function(e){e.attr("data-mce-open",e.attr("open"));e.attr("open","open")}))}));e.serializer.addNodeFilter("details",(function(e){each$k(e,(function(e){var t=e.attr("data-mce-open");e.attr("open",u(t)?t:null);e.attr("data-mce-open",null)}))}))};var setup$3=function(e){preventSummaryToggle(e);filterDetails(e)};var isTextBlockNode=function(e){return Ee(e)&&ot(se.fromDom(e))};var normalizeSelection=function(e){var t=e.selection.getRng();var n=CaretPosition.fromRangeStart(t);var a=CaretPosition.fromRangeEnd(t);if(CaretPosition.isElementPosition(n)){var o=n.container();isTextBlockNode(o)&&Sa(o).each((function(e){return t.setStart(e.container(),e.offset())}))}if(CaretPosition.isElementPosition(a)){o=n.container();isTextBlockNode(o)&&Ea(o).each((function(e){return t.setEnd(e.container(),e.offset())}))}e.selection.setRng(normalize(t))};var setup$2=function(e){e.on("click",(function(t){t.detail>=3&&normalizeSelection(e)}))};var getAbsolutePosition=function(e){var t=e.getBoundingClientRect();var n=e.ownerDocument;var a=n.documentElement;var o=n.defaultView;return{top:t.top+o.pageYOffset-a.clientTop,left:t.left+o.pageXOffset-a.clientLeft}};var getBodyPosition=function(e){return e.inline?getAbsolutePosition(e.getBody()):{left:0,top:0}};var getScrollPosition=function(e){var t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}};var getBodyScroll=function(e){var t=e.getBody(),n=e.getDoc().documentElement;var a={left:t.scrollLeft,top:t.scrollTop};var o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?a:o};var getMousePosition=function(e,t){if(t.target.ownerDocument!==e.getDoc()){var n=getAbsolutePosition(e.getContentAreaContainer());var a=getBodyScroll(e);return{left:t.pageX-n.left+a.left,top:t.pageY-n.top+a.top}}return{left:t.pageX,top:t.pageY}};var calculatePosition=function(e,t,n){return{pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}};var calc=function(e,t){return calculatePosition(getBodyPosition(e),getScrollPosition(e),getMousePosition(e,t))};var uu=Be,cu=Oe;var isDraggable=function(e,t){return uu(t)&&t!==e};var isValidDropTarget=function(e,t,n){return t!==n&&!e.dom.isChildOf(t,n)&&!uu(t)};var cloneElement=function(e){var t=e.cloneNode(true);t.removeAttribute("data-mce-selected");return t};var createGhost=function(e,t,n,a){var o=e.dom;var i=t.cloneNode(true);o.setStyles(i,{width:n,height:a});o.setAttrib(i,"data-mce-selected",null);var u=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});o.setStyles(u,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:a});o.setStyles(i,{margin:0,boxSizing:"border-box"});u.appendChild(i);return u};var appendGhostToBody=function(e,t){e.parentNode!==t&&t.appendChild(e)};var moveGhost=function(e,t,n,a,o,i){var u=0,c=0;e.style.left=t.pageX+"px";e.style.top=t.pageY+"px";t.pageX+n>o&&(u=t.pageX+n-o);t.pageY+a>i&&(c=t.pageY+a-i);e.style.width=n-u+"px";e.style.height=a-c+"px"};var removeElement=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)};var isLeftMouseButtonPressed=function(e){return 0===e.button};var applyRelPos=function(e,t){return{pageX:t.pageX-e.relX,pageY:t.pageY+5}};var start=function(e,t){return function(n){if(isLeftMouseButtonPressed(n)){var a=find$3(t.dom.getParents(n.target),or(uu,cu)).getOr(null);if(isDraggable(t.getBody(),a)){var o=t.dom.getPos(a);var i=t.getBody();var u=t.getDoc().documentElement;e.set({element:a,dragging:false,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?i.scrollWidth:u.offsetWidth)-2,maxY:(t.inline?i.scrollHeight:u.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:a.offsetWidth,height:a.offsetHeight,ghost:createGhost(t,a,a.offsetWidth,a.offsetHeight)})}}}};var move=function(e,t){var n=We.throttle((function(e,n){t._selectionOverrides.hideFakeCaret();t.selection.placeCaretAt(e,n)}),0);t.on("remove",n.stop);return function(a){return e.on((function(e){var o=Math.max(Math.abs(a.screenX-e.screenX),Math.abs(a.screenY-e.screenY));if(!e.dragging&&o>10){var i=t.fire("dragstart",{target:e.element});if(i.isDefaultPrevented())return;e.dragging=true;t.focus()}if(e.dragging){var u=applyRelPos(e,calc(t,a));appendGhostToBody(e.ghost,t.getBody());moveGhost(e.ghost,u,e.width,e.height,e.maxX,e.maxY);n(a.clientX,a.clientY)}}))}};var getRawTarget=function(e){var t=e.getSel().getRangeAt(0);var n=t.startContainer;return 3===n.nodeType?n.parentNode:n};var drop=function(e,t){return function(n){e.on((function(e){if(e.dragging){if(isValidDropTarget(t,getRawTarget(t.selection),e.element)){var a=cloneElement(e.element);var o=t.fire("drop",{clientX:n.clientX,clientY:n.clientY});o.isDefaultPrevented()||t.undoManager.transact((function(){removeElement(e.element);t.insertContent(t.dom.getOuterHTML(a));t._selectionOverrides.hideFakeCaret()}))}t.fire("dragend")}}));removeDragState(e)}};var stop=function(e,t){return function(){e.on((function(e){e.dragging&&t.fire("dragend")}));removeDragState(e)}};var removeDragState=function(e){e.on((function(e){removeElement(e.ghost)}));e.clear()};var bindFakeDragEvents=function(e){var t=value();var n=DOMUtils.DOM;var a=document;var o=start(t,e);var i=move(t,e);var u=drop(t,e);var c=stop(t,e);e.on("mousedown",o);e.on("mousemove",i);e.on("mouseup",u);n.bind(a,"mousemove",i);n.bind(a,"mouseup",c);e.on("remove",(function(){n.unbind(a,"mousemove",i);n.unbind(a,"mouseup",c)}));e.on("keydown",(function(e){e.keyCode===Oa.ESC&&c()}))};var blockIeDrop=function(e){e.on("drop",(function(t){var n="undefined"!==typeof t.clientX?e.getDoc().elementFromPoint(t.clientX,t.clientY):null;(uu(n)||"false"===e.dom.getContentEditableParent(n))&&t.preventDefault()}))};var blockUnsupportedFileDrop=function(e){var preventFileDrop=function(t){if(!t.isDefaultPrevented()){var n=t.dataTransfer;if(n&&(contains$3(n.types,"Files")||n.files.length>0)){t.preventDefault();"drop"===t.type&&displayError(e,"Dropped file type is not supported")}}};var preventFileDropIfUIElement=function(t){isUIElement(e,t.target)&&preventFileDrop(t)};var setup=function(){var t=DOMUtils.DOM;var n=e.dom;var a=document;var o=e.inline?e.getBody():e.getDoc();var i=["drop","dragover"];each$k(i,(function(e){t.bind(a,e,preventFileDropIfUIElement);n.bind(o,e,preventFileDrop)}));e.on("remove",(function(){each$k(i,(function(e){t.unbind(a,e,preventFileDropIfUIElement);n.unbind(o,e,preventFileDrop)}))}))};e.on("init",(function(){We.setEditorTimeout(e,setup,0)}))};var init$2=function(e){bindFakeDragEvents(e);blockIeDrop(e);shouldBlockUnsupportedDrop(e)&&blockUnsupportedFileDrop(e)};var setup$1=function(e){var t=first((function(){if(!e.removed&&e.getBody().contains(document.activeElement)){var t=e.selection.getRng();if(t.collapsed){var n=renderRangeCaret(e,t,false);e.selection.setRng(n)}}}),0);e.on("focus",(function(){t.throttle()}));e.on("blur",(function(){t.cancel()}))};var setup=function(e){e.on("init",(function(){e.on("focusin",(function(t){var n=t.target;if(Le(n)){var a=getContentEditableRoot$1(e.getBody(),n);var o=Be(a)?a:n;e.selection.getNode()!==o&&selectNode(e,o).each((function(t){return e.selection.setRng(t)}))}}))}))};var fu=Oe;var su=Be;var getContentEditableRoot=function(e,t){return getContentEditableRoot$1(e.getBody(),t)};var SelectionOverrides=function(e){var t=e.selection,n=e.dom;var a=n.isBlock;var o=e.getBody();var i=FakeCaret(e,o,a,(function(){return hasFocus(e)}));var u="sel-"+n.uniqueId();var c="data-mce-selected";var f;var isFakeSelectionElement=function(e){return n.hasClass(e,"mce-offscreen-selection")};var isFakeSelectionTargetElement=function(e){return e!==o&&(su(e)||Le(e))&&n.isChildOf(e,o)};var isNearFakeSelectionElement=function(e){return xo(e)||So(e)||bo(e)||yo(e)};var getRealSelectionElement=function(){var e=n.get(u);return e?e.getElementsByTagName("*")[0]:e};var setRange=function(e){e&&t.setRng(e)};var s=t.getRng;var showCaret=function(n,a,o,u){void 0===u&&(u=true);var c=e.fire("ShowCaret",{target:a,direction:n,before:o});if(c.isDefaultPrevented())return null;u&&t.scrollIntoView(a,-1===n);return i.show(o,a)};var showBlockCaretContainer=function(e){if(e.hasAttribute("data-mce-caret")){showCaretContainerBlock(e);setRange(s());t.scrollIntoView(e)}};var registerEvents=function(){e.on("mouseup",(function(t){var n=s();n.collapsed&&isXYInContentArea(e,t.clientX,t.clientY)&&renderCaretAtRange(e,n,false).each(setRange)}));e.on("click",(function(a){var o=getContentEditableRoot(e,a.target);if(o){if(su(o)){a.preventDefault();e.focus()}fu(o)&&n.isChildOf(o,t.getNode())&&removeElementSelection()}}));e.on("blur NewBlock",removeElementSelection);e.on("ResizeWindow FullscreenStateChanged",i.reposition);var hasNormalCaretPosition=function(e){var t=e.firstChild;if(isNullable(t))return false;var n=CaretPosition.before(t);if(De(n.getNode())&&1===e.childNodes.length)return!isNearFakeSelectionElement(n);var a=CaretWalker(e);var o=a.next(n);return o&&!isNearFakeSelectionElement(o)};var isInSameBlock=function(e,t){var o=n.getParent(e,a);var i=n.getParent(t,a);return o===i};var hasBetterMouseTarget=function(t,o){var i=n.getParent(t,a);var u=n.getParent(o,a);return!isNullable(i)&&(!(t===u||!n.isChildOf(i,u)||false!==su(getContentEditableRoot(e,i)))||!n.isChildOf(u,i)&&!isInSameBlock(i,u)&&hasNormalCaretPosition(i))};e.on("tap",(function(t){var n=t.target;var a=getContentEditableRoot(e,n);if(su(a)){t.preventDefault();selectNode(e,a).each(setElementSelection)}else isFakeSelectionTargetElement(n)&&selectNode(e,n).each(setElementSelection)}),true);e.on("mousedown",(function(a){var i=a.target;if((i===o||"HTML"===i.nodeName||n.isChildOf(i,o))&&false!==isXYInContentArea(e,a.clientX,a.clientY)){var u=getContentEditableRoot(e,i);if(u)if(su(u)){a.preventDefault();selectNode(e,u).each(setElementSelection)}else{removeElementSelection();if(!(fu(u)&&a.shiftKey)&&!isXYWithinRange(a.clientX,a.clientY,t.getRng())){hideFakeCaret();t.placeCaretAt(a.clientX,a.clientY)}}else if(isFakeSelectionTargetElement(i))selectNode(e,i).each(setElementSelection);else if(false===isFakeCaretTarget(i)){removeElementSelection();hideFakeCaret();var c=closestFakeCaret(o,a.clientX,a.clientY);if(c&&!hasBetterMouseTarget(i,c.node)){a.preventDefault();var f=showCaret(1,c.node,c.before,false);setRange(f);e.getBody().focus()}}}}));e.on("keypress",(function(e){Oa.modifierPressed(e)||su(t.getNode())&&e.preventDefault()}));e.on("GetSelectionRange",(function(e){var t=e.range;if(f){if(!f.parentNode){f=null;return}t=t.cloneRange();t.selectNode(f);e.range=t}}));e.on("SetSelectionRange",(function(e){e.range=normalizeShortEndedElementSelection(e.range);var t=setElementSelection(e.range,e.forward);t&&(e.range=t)}));var isPasteBin=function(e){return"mcepastebin"===e.id};e.on("AfterSetSelectionRange",(function(e){var t=e.range;var n=t.startContainer.parentNode;isRangeInCaretContainer(t)||isPasteBin(n)||hideFakeCaret();isFakeSelectionElement(n)||removeElementSelection()}));e.on("copy",(function(e){var t=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!ie.ie){var n=getRealSelectionElement();if(n){e.preventDefault();t.clearData();t.setData("text/html",n.outerHTML);t.setData("text/plain",n.outerText||n.innerText)}}}));init$2(e);setup$1(e);setup(e)};var isWithinCaretContainer=function(e){return isCaretContainer$2(e)||startsWithCaretContainer$1(e)||endsWithCaretContainer$1(e)};var isRangeInCaretContainer=function(e){return isWithinCaretContainer(e.startContainer)||isWithinCaretContainer(e.endContainer)};var normalizeShortEndedElementSelection=function(t){var a=e.schema.getShortEndedElements();var o=n.createRng();var i=t.startContainer;var u=t.startOffset;var c=t.endContainer;var f=t.endOffset;has$2(a,i.nodeName.toLowerCase())?0===u?o.setStartBefore(i):o.setStartAfter(i):o.setStart(i,u);has$2(a,c.nodeName.toLowerCase())?0===f?o.setEndBefore(c):o.setEndAfter(c):o.setEnd(c,f);return o};var setupOffscreenSelection=function(a,o,i){var c=e.$;var f=descendant(se.fromDom(e.getBody()),"#"+u).fold((function(){return c([])}),(function(e){return c([e.dom])}));if(0===f.length){f=c('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",u);f.appendTo(e.getBody())}var s=n.createRng();if(o===i&&ie.ie){f.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(o);s.setStartAfter(f[0].firstChild.firstChild);s.setEndAfter(o)}else{f.empty().append(vt).append(o).append(vt);s.setStart(f[0].firstChild,1);s.setEnd(f[0].lastChild,0)}f.css({top:n.getPos(a,e.getBody()).y});f[0].focus();var l=t.getSel();l.removeAllRanges();l.addRange(s);return s};var selectElement=function(t){var a=t.cloneNode(true);var o=e.fire("ObjectSelected",{target:t,targetClone:a});if(o.isDefaultPrevented())return null;var i=setupOffscreenSelection(t,o.targetClone,a);var u=se.fromDom(t);each$k(descendants(se.fromDom(e.getBody()),"*[data-mce-selected]"),(function(e){eq(u,e)||remove$6(e,c)}));n.getAttrib(t,c)||t.setAttribute(c,"1");f=t;hideFakeCaret();return i};var setElementSelection=function(e,t){if(!e)return null;if(e.collapsed){if(!isRangeInCaretContainer(e)){var a=t?1:-1;var i=getNormalizedRangeEndPoint(a,o,e);var u=i.getNode(!t);if(isFakeCaretTarget(u))return showCaret(a,u,!!t&&!i.isAtEnd(),false);var c=i.getNode(t);if(isFakeCaretTarget(c))return showCaret(a,c,!t&&!i.isAtEnd(),false)}return null}var f=e.startContainer;var s=e.startOffset;var l=e.endOffset;if(3===f.nodeType&&0===s&&su(f.parentNode)){f=f.parentNode;s=n.nodeIndex(f);f=f.parentNode}if(1!==f.nodeType)return null;if(l===s+1&&f===e.endContainer){var v=f.childNodes[s];if(isFakeSelectionTargetElement(v))return selectElement(v)}return null};var removeElementSelection=function(){f&&f.removeAttribute(c);descendant(se.fromDom(e.getBody()),"#"+u).each(remove$7);f=null};var destroy=function(){i.destroy();f=null};var hideFakeCaret=function(){i.hide()};ie.ceFalse&&!isRtc(e)&&registerEvents();return{showCaret:showCaret,showBlockCaretContainer:showBlockCaretContainer,hideFakeCaret:hideFakeCaret,destroy:destroy}};var Quirks=function(e){var t=fe.each;var n=Oa.BACKSPACE,a=Oa.DELETE,o=e.dom,i=e.selection,u=e.parser;var c=ie.gecko,f=ie.ie,s=ie.webkit;var l="data:text/mce-internal,";var v=f?"Text":"URL";var setEditorCommandState=function(t,n){try{e.getDoc().execCommand(t,false,n)}catch(e){}};var isDefaultPrevented=function(e){return e.isDefaultPrevented()};var setMceInternalContent=function(t){var n,a;if(t.dataTransfer){e.selection.isCollapsed()&&"IMG"===t.target.tagName&&i.select(t.target);n=e.selection.getContent();if(n.length>0){a=l+escape(e.id)+","+escape(n);t.dataTransfer.setData(v,a)}}};var getMceInternalContent=function(e){var t;if(e.dataTransfer){t=e.dataTransfer.getData(v);if(t&&t.indexOf(l)>=0){t=t.substr(l.length).split(",");return{id:unescape(t[0]),html:unescape(t[1])}}}return null};var insertClipboardContents=function(t,n){e.queryCommandSupported("mceInsertClipboardContent")?e.execCommand("mceInsertClipboardContent",false,{content:t,internal:n}):e.execCommand("mceInsertContent",false,t)};var emptyEditorWhenDeleting=function(){var serializeRng=function(e){var t=o.create("body");var n=e.cloneContents();t.appendChild(n);return i.serializer.serialize(t,{format:"html"})};var allContentsSelected=function(t){var n=serializeRng(t);var a=o.createRng();a.selectNode(e.getBody());var i=serializeRng(a);return n===i};e.on("keydown",(function(t){var i=t.keyCode;var u,c;if(!isDefaultPrevented(t)&&(i===a||i===n)){u=e.selection.isCollapsed();c=e.getBody();if(u&&!o.isEmpty(c))return;if(!u&&!allContentsSelected(e.selection.getRng()))return;t.preventDefault();e.setContent("");c.firstChild&&o.isBlock(c.firstChild)?e.selection.setCursorLocation(c.firstChild,0):e.selection.setCursorLocation(c,0);e.nodeChanged()}}))};var selectAll=function(){e.shortcuts.add("meta+a",null,"SelectAll")};var documentElementEditingFocus=function(){e.inline||o.bind(e.getDoc(),"mousedown mouseup",(function(t){var n;if(t.target===e.getDoc().documentElement){n=i.getRng();e.getBody().focus();if("mousedown"===t.type){if(isCaretContainer$2(n.startContainer))return;i.placeCaretAt(t.clientX,t.clientY)}else i.setRng(n)}}))};var removeHrOnBackspace=function(){e.on("keydown",(function(t){if(!isDefaultPrevented(t)&&t.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(i.isCollapsed()&&0===i.getRng().startOffset){var a=i.getNode();var u=a.previousSibling;if("HR"===a.nodeName){o.remove(a);t.preventDefault();return}if(u&&u.nodeName&&"hr"===u.nodeName.toLowerCase()){o.remove(u);t.preventDefault()}}}}))};var focusBody=function(){Range.prototype.getClientRects||e.on("mousedown",(function(t){if(!isDefaultPrevented(t)&&"HTML"===t.target.nodeName){var n=e.getBody();n.blur();We.setEditorTimeout(e,(function(){n.focus()}))}}))};var selectControlElements=function(){e.on("click",(function(t){var n=t.target;if(/^(IMG|HR)$/.test(n.nodeName)&&"false"!==o.getContentEditableParent(n)){t.preventDefault();e.selection.select(n);e.nodeChanged()}if("A"===n.nodeName&&o.hasClass(n,"mce-item-anchor")){t.preventDefault();i.select(n)}}))};var removeStylesWhenDeletingAcrossBlockElements=function(){var getAttributeApplyFunction=function(){var n=o.getAttribs(i.getStart().cloneNode(false));return function(){var a=i.getStart();if(a!==e.getBody()){o.setAttrib(a,"style",null);t(n,(function(e){a.setAttributeNode(e.cloneNode(true))}))}}};var isSelectionAcrossElements=function(){return!i.isCollapsed()&&o.getParent(i.getStart(),o.isBlock)!==o.getParent(i.getEnd(),o.isBlock)};e.on("keypress",(function(t){var n;if(!isDefaultPrevented(t)&&(8===t.keyCode||46===t.keyCode)&&isSelectionAcrossElements()){n=getAttributeApplyFunction();e.getDoc().execCommand("delete",false,null);n();t.preventDefault();return false}}));o.bind(e.getDoc(),"cut",(function(t){var n;if(!isDefaultPrevented(t)&&isSelectionAcrossElements()){n=getAttributeApplyFunction();We.setEditorTimeout(e,(function(){n()}))}}))};var disableBackspaceIntoATable=function(){e.on("keydown",(function(e){if(!isDefaultPrevented(e)&&e.keyCode===n&&i.isCollapsed()&&0===i.getRng().startOffset){var t=i.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase()){e.preventDefault();return false}}}))};var removeBlockQuoteOnBackSpace=function(){e.on("keydown",(function(t){var n,a;if(!isDefaultPrevented(t)&&t.keyCode===Oa.BACKSPACE){n=i.getRng();var u=n.startContainer;var c=n.startOffset;var f=o.getRoot();a=u;if(n.collapsed&&0===c){while(a&&a.parentNode&&a.parentNode.firstChild===a&&a.parentNode!==f)a=a.parentNode;if("BLOCKQUOTE"===a.tagName){e.formatter.toggle("blockquote",null,a);n=o.createRng();n.setStart(u,0);n.setEnd(u,0);i.setRng(n)}}}}))};var setGeckoEditingOptions=function(){var setOpts=function(){setEditorCommandState("StyleWithCSS",false);setEditorCommandState("enableInlineTableEditing",false);getObjectResizing(e)||setEditorCommandState("enableObjectResizing",false)};isReadOnly$1(e)||e.on("BeforeExecCommand mousedown",setOpts)};var addBrAfterLastLinks=function(){var fixLinks=function(){t(o.select("a"),(function(e){var t=e.parentNode;var n=o.getRoot();if(t.lastChild===e){while(t&&!o.isBlock(t)){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}o.add(t,"br",{"data-mce-bogus":1})}}))};e.on("SetContent ExecCommand",(function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||fixLinks()}))};var setDefaultBlockType=function(){getForcedRootBlock(e)&&e.on("init",(function(){setEditorCommandState("DefaultParagraphSeparator",getForcedRootBlock(e))}))};var normalizeSelection=function(){e.on("keyup focusin mouseup",(function(e){Oa.modifierPressed(e)||i.normalize()}),true)};var showBrokenImageIcon=function(){e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")};var restoreFocusOnKeyDown=function(){e.inline||e.on("keydown",(function(){document.activeElement===document.body&&e.getWin().focus()}))};var bodyHeight=function(){if(!e.inline){e.contentStyles.push("body {min-height: 150px}");e.on("click",(function(t){var n;if("HTML"===t.target.nodeName){if(ie.ie>11){e.getBody().focus();return}n=e.selection.getRng();e.getBody().focus();e.selection.setRng(n);e.selection.normalize();e.nodeChanged()}}))}};var blockCmdArrowNavigation=function(){ie.mac&&e.on("keydown",(function(t){if(Oa.metaKeyPressed(t)&&!t.shiftKey&&(37===t.keyCode||39===t.keyCode)){t.preventDefault();var n=e.selection.getSel();n.modify("move",37===t.keyCode?"backward":"forward","lineboundary")}}))};var disableAutoUrlDetect=function(){setEditorCommandState("AutoUrlDetect",false)};var tapLinksAndImages=function(){e.on("click",(function(e){var t=e.target;do{if("A"===t.tagName){e.preventDefault();return}}while(t=t.parentNode)}));e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")};var blockFormSubmitInsideEditor=function(){e.on("init",(function(){e.dom.bind(e.getBody(),"submit",(function(e){e.preventDefault()}))}))};var removeAppleInterchangeBrs=function(){u.addNodeFilter("br",(function(e){var t=e.length;while(t--)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()}))};var ieInternalDragAndDrop=function(){e.on("dragstart",(function(e){setMceInternalContent(e)}));e.on("drop",(function(t){if(!isDefaultPrevented(t)){var n=getMceInternalContent(t);if(n&&n.id!==e.id){t.preventDefault();var a=fromPoint(t.x,t.y,e.getDoc());i.setRng(a);insertClipboardContents(n.html,true)}}}))};var d=noop;var isHidden=function(){if(!c||e.removed)return false;var t=e.selection.getSel();return!t||!t.rangeCount||0===t.rangeCount};var setupRtc=function(){if(s){documentElementEditingFocus();selectControlElements();blockFormSubmitInsideEditor();selectAll();if(ie.iOS){restoreFocusOnKeyDown();bodyHeight();tapLinksAndImages()}}if(c){focusBody();setGeckoEditingOptions();showBrokenImageIcon();blockCmdArrowNavigation()}};var setup=function(){removeBlockQuoteOnBackSpace();emptyEditorWhenDeleting();ie.windowsPhone||normalizeSelection();if(s){documentElementEditingFocus();selectControlElements();setDefaultBlockType();blockFormSubmitInsideEditor();disableBackspaceIntoATable();removeAppleInterchangeBrs();if(ie.iOS){restoreFocusOnKeyDown();bodyHeight();tapLinksAndImages()}else selectAll()}if(ie.ie>=11){bodyHeight();disableBackspaceIntoATable()}if(ie.ie){selectAll();disableAutoUrlDetect();ieInternalDragAndDrop()}if(c){removeHrOnBackspace();focusBody();removeStylesWhenDeletingAcrossBlockElements();setGeckoEditingOptions();addBrAfterLastLinks();showBrokenImageIcon();blockCmdArrowNavigation();disableBackspaceIntoATable()}};isRtc(e)?setupRtc():setup();return{refreshContentEditable:d,isHidden:isHidden}};var lu=DOMUtils.DOM;var appendStyle=function(e,t){var n=se.fromDom(e.getBody());var a=getStyleContainer(xe(n));var o=se.fromTag("style");set$1(o,"type","text/css");append$1(o,se.fromText(t));append$1(a,o);e.on("remove",(function(){remove$7(o)}))};var getRootName=function(e){return e.inline?e.getElement().nodeName.toLowerCase():void 0};var removeUndefined=function(e){return filter$3(e,(function(e){return false===v(e)}))};var mkParserSettings=function(e){var t=e.settings;var n=e.editorUpload.blobCache;return removeUndefined({allow_conditional_comments:t.allow_conditional_comments,allow_html_data_urls:t.allow_html_data_urls,allow_svg_data_urls:t.allow_svg_data_urls,allow_html_in_named_anchor:t.allow_html_in_named_anchor,allow_script_urls:t.allow_script_urls,allow_unsafe_link_target:t.allow_unsafe_link_target,convert_fonts_to_spans:t.convert_fonts_to_spans,fix_list_elements:t.fix_list_elements,font_size_legacy_values:t.font_size_legacy_values,forced_root_block:t.forced_root_block,forced_root_block_attrs:t.forced_root_block_attrs,padd_empty_with_br:t.padd_empty_with_br,preserve_cdata:t.preserve_cdata,remove_trailing_brs:t.remove_trailing_brs,inline_styles:t.inline_styles,root_name:getRootName(e),validate:true,blob_cache:n,document:e.getDoc(),images_dataimg_filter:t.images_dataimg_filter})};var mkSerializerSettings=function(e){var t=e.settings;return __assign(__assign({},mkParserSettings(e)),removeUndefined({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope,element_format:t.element_format,entities:t.entities,entity_encoding:t.entity_encoding,indent:t.indent,indent_after:t.indent_after,indent_before:t.indent_before,block_elements:t.block_elements,boolean_attributes:t.boolean_attributes,custom_elements:t.custom_elements,extended_valid_elements:t.extended_valid_elements,invalid_elements:t.invalid_elements,invalid_styles:t.invalid_styles,move_caret_before_on_enter_elements:t.move_caret_before_on_enter_elements,non_empty_elements:t.non_empty_elements,schema:t.schema,self_closing_elements:t.self_closing_elements,short_ended_elements:t.short_ended_elements,special:t.special,text_block_elements:t.text_block_elements,text_inline_elements:t.text_inline_elements,valid_children:t.valid_children,valid_classes:t.valid_classes,valid_elements:t.valid_elements,valid_styles:t.valid_styles,verify_html:t.verify_html,whitespace_elements:t.whitespace_elements}))};var createParser=function(e){var t=DomParser(mkParserSettings(e),e.schema);t.addAttributeFilter("src,href,style,tabindex",(function(t,n){var a,o,i=t.length;var u=e.dom;var c="data-mce-"+n;while(i--){a=t[i];o=a.attr(n);if(o&&!a.attr(c)){if(0===o.indexOf("data:")||0===o.indexOf("blob:"))continue;if("style"===n){o=u.serializeStyle(u.parseStyle(o),a.name);o.length||(o=null);a.attr(c,o);a.attr(n,o)}else if("tabindex"===n){a.attr(c,o);a.attr(n,null)}else a.attr(c,e.convertURL(o,n,a.name))}}}));t.addNodeFilter("script",(function(e){var t=e.length;while(t--){var n=e[t];var a=n.attr("type")||"no/type";0!==a.indexOf("mce-")&&n.attr("type","mce-"+a)}}));e.settings.preserve_cdata&&t.addNodeFilter("#cdata",(function(t){var n=t.length;while(n--){var a=t[n];a.type=8;a.name="#comment";a.value="[CDATA["+e.dom.encode(a.value)+"]]"}}));t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",(function(t){var n=t.length;var a=e.schema.getNonEmptyElements();while(n--){var o=t[n];o.isEmpty(a)&&0===o.getAll("br").length&&(o.append(new Za("br",1)).shortEnded=true)}}));return t};var autoFocus=function(e){e.settings.auto_focus&&We.setEditorTimeout(e,(function(){var t;t=true===e.settings.auto_focus?e:e.editorManager.get(e.settings.auto_focus);t.destroyed||t.focus()}),100)};var moveSelectionToFirstCaretPosition=function(e){var t=e.dom.getRoot();e.inline||hasAnyRanges(e)&&e.selection.getStart(true)!==t||Sa(t).each((function(t){var n=t.getNode();var a=isTable$3(n)?Sa(n).getOr(t):t;ie.browser.isIE()?storeNative(e,a.toRange()):e.selection.setRng(a.toRange())}))};var initEditor=function(e){e.bindPendingEventDelegates();e.initialized=true;fireInit(e);e.focus(true);moveSelectionToFirstCaretPosition(e);e.nodeChanged({initial:true});e.execCallback("init_instance_callback",e);autoFocus(e)};var getStyleSheetLoader$1=function(e){return e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader};var makeStylesheetLoadingPromises=function(e,t,n){var a=[new qe((function(n,a){return getStyleSheetLoader$1(e).loadAll(t,n,a)}))];return e.inline?a:a.concat([new qe((function(t,a){return e.ui.styleSheetLoader.loadAll(n,t,a)}))])};var loadContentCss=function(e){var t=getStyleSheetLoader$1(e);var n=getFontCss(e);var a=e.contentCSS;var removeCss=function(){t.unloadAll(a);e.inline||e.ui.styleSheetLoader.unloadAll(n)};var loaded=function(){e.removed?removeCss():e.on("remove",removeCss)};if(e.contentStyles.length>0){var o="";fe.each(e.contentStyles,(function(e){o+=e+"\r\n"}));e.dom.addStyle(o)}var i=qe.all(makeStylesheetLoadingPromises(e,a,n)).then(loaded).catch(loaded);e.settings.content_style&&appendStyle(e,e.settings.content_style);return i};var preInit=function(e){var t=e.settings,n=e.getDoc(),a=e.getBody();firePreInit(e);if(!t.browser_spellcheck&&!t.gecko_spellcheck){n.body.spellcheck=false;lu.setAttrib(a,"spellcheck","false")}e.quirks=Quirks(e);firePostRender(e);var o=getDirectionality(e);void 0!==o&&(a.dir=o);t.protect&&e.on("BeforeSetContent",(function(e){fe.each(t.protect,(function(t){e.content=e.content.replace(t,(function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"}))}))}));e.on("SetContent",(function(){e.addVisual(e.getBody())}));e.on("compositionstart compositionend",(function(t){e.composing="compositionstart"===t.type}))};var loadInitialContent=function(e){isRtc(e)||e.load({initial:true,format:"html"});e.startContent=e.getContent({format:"raw"})};var initEditorWithInitialContent=function(e){if(true!==e.removed){loadInitialContent(e);initEditor(e)}};var initContentBody=function(e,t){var n=e.settings;var a=e.getElement();var o=e.getDoc();n.inline||(e.getElement().style.visibility=e.orgVisibility);if(!t&&!e.inline){o.open();o.write(e.iframeHTML);o.close()}if(e.inline){lu.addClass(a,"mce-content-body");e.contentDocument=o=document;e.contentWindow=window;e.bodyElement=a;e.contentAreaContainer=a}var i=e.getBody();i.disabled=true;e.readonly=!!n.readonly;if(!e.readonly){e.inline&&"static"===lu.getStyle(i,"position",true)&&(i.style.position="relative");i.contentEditable=e.getParam("content_editable_state",true)}i.disabled=false;e.editorUpload=EditorUpload(e);e.schema=Schema(n);e.dom=DOMUtils(o,{keep_values:true,url_converter:e.convertURL,url_converter_scope:e,hex_colors:n.force_hex_style_colors,update_styles:true,root_element:e.inline?e.getBody():null,collect:function(){return e.inline},schema:e.schema,contentCssCors:shouldUseContentCssCors(e),referrerPolicy:getReferrerPolicy(e),onSetAttrib:function(t){e.fire("SetAttrib",t)}});e.parser=createParser(e);e.serializer=DomSerializer(mkSerializerSettings(e),e);e.selection=EditorSelection(e.dom,e.getWin(),e.serializer,e);e.annotator=Annotator(e);e.formatter=Formatter(e);e.undoManager=UndoManager(e);e._nodeChangeDispatcher=new iu(e);e._selectionOverrides=SelectionOverrides(e);setup$e(e);setup$3(e);isRtc(e)||setup$2(e);var u=setup$4(e);setup$f(e,u);setup$d(e);setup$g(e);var c=setup$i(e);preInit(e);c.fold((function(){loadContentCss(e).then((function(){return initEditorWithInitialContent(e)}))}),(function(t){e.setProgressState(true);loadContentCss(e).then((function(){t().then((function(t){e.setProgressState(false);initEditorWithInitialContent(e)}),(function(t){e.notificationManager.open({type:"error",text:String(t)});initEditorWithInitialContent(e)}))}))}))};var vu=DOMUtils.DOM;var relaxDomain=function(e,t){if(document.domain!==window.location.hostname&&ie.browser.isIE()){var n=uuid("mce");e[n]=function(){initContentBody(e)};var a='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+e.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";vu.setAttrib(t,"src",a);return true}return false};var createIframeElement=function(e,t,n,a){var o=se.fromTag("iframe");setAll$1(o,a);setAll$1(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t});add$1(o,"tox-edit-area__iframe");return o};var getIframeHtml=function(e){var t=getDocType(e)+"<html><head>";getDocumentBaseUrl(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />');t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var n=getBodyId(e);var a=getBodyClass(e);getContentSecurityPolicy(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+getContentSecurityPolicy(e)+'" />');t+='</head><body id="'+n+'" class="mce-content-body '+a+'" data-id="'+e.id+'"><br></body></html>';return t};var createIframe=function(e,t){var n=e.translate(getIframeTitle(e));var a=createIframeElement(e.id,n,t.height,getIframeAttrs(e)).dom;a.onload=function(){a.onload=null;e.fire("load")};var o=relaxDomain(e,a);e.contentAreaContainer=t.iframeContainer;e.iframeElement=a;e.iframeHTML=getIframeHtml(e);vu.add(t.iframeContainer,a);return o};var init$1=function(e,t){var n=createIframe(e,t);if(t.editorContainer){vu.get(t.editorContainer).style.display=e.orgDisplay;e.hidden=vu.isHidden(t.editorContainer)}e.getElement().style.display="none";vu.setAttrib(e.id,"aria-hidden","true");n||initContentBody(e)};var du=DOMUtils.DOM;var initPlugin=function(e,t,n){var a=bi.get(n);var o=bi.urls[n]||e.documentBaseUrl.replace(/\/$/,"");n=fe.trim(n);if(a&&-1===fe.inArray(t,n)){fe.each(bi.dependencies(n),(function(n){initPlugin(e,t,n)}));if(e.plugins[n])return;try{var i=new a(e,o,e.$);e.plugins[n]=i;if(i.init){i.init(e,o);t.push(n)}}catch(t){pluginInitError(e,n,t)}}};var trimLegacyPrefix=function(e){return e.replace(/^\-/,"")};var initPlugins=function(e){var t=[];fe.each(getPlugins(e).split(/[ ,]/),(function(n){initPlugin(e,t,trimLegacyPrefix(n))}))};var initIcons=function(e){var t=fe.trim(getIconPackName(e));var n=e.ui.registry.getAll().icons;var a=__assign(__assign({},di.get("default").icons),di.get(t).icons);each$j(a,(function(t,a){has$2(n,a)||e.ui.registry.addIcon(a,t)}))};var initTheme=function(e){var t=getTheme(e);if(u(t)){e.settings.theme=trimLegacyPrefix(t);var n=yi.get(t);e.theme=new n(e,yi.urls[t]);e.theme.init&&e.theme.init(e,yi.urls[t]||e.documentBaseUrl.replace(/\/$/,""),e.$)}else e.theme={}};var renderFromLoadedTheme=function(e){return e.theme.renderUI()};var renderFromThemeFunc=function(e){var t=e.getElement();var n=getTheme(e);var a=n(e,t);a.editorContainer.nodeType&&(a.editorContainer.id=a.editorContainer.id||e.id+"_parent");a.iframeContainer&&a.iframeContainer.nodeType&&(a.iframeContainer.id=a.iframeContainer.id||e.id+"_iframecontainer");a.height=a.iframeHeight?a.iframeHeight:t.offsetHeight;return a};var createThemeFalseResult=function(e){return{editorContainer:e,iframeContainer:e,api:{}}};var renderThemeFalseIframe=function(e){var t=du.create("div");du.insertAfter(t,e);return createThemeFalseResult(t)};var renderThemeFalse=function(e){var t=e.getElement();return e.inline?createThemeFalseResult(null):renderThemeFalseIframe(t)};var renderThemeUi=function(e){var t=e.getElement();e.orgDisplay=t.style.display;return u(getTheme(e))?renderFromLoadedTheme(e):d(getTheme(e))?renderFromThemeFunc(e):renderThemeFalse(e)};var augmentEditorUiApi=function(e,t){var n={show:b.from(t.show).getOr(noop),hide:b.from(t.hide).getOr(noop),disable:b.from(t.disable).getOr(noop),isDisabled:b.from(t.isDisabled).getOr(g),enable:function(){e.mode.isReadOnly()||b.from(t.enable).map(call)}};e.ui=__assign(__assign({},e.ui),n)};var init=function(e){e.fire("ScriptsLoaded");initIcons(e);initTheme(e);initPlugins(e);var t=renderThemeUi(e);augmentEditorUiApi(e,b.from(t.api).getOr({}));var n={editorContainer:t.editorContainer,iframeContainer:t.iframeContainer};e.editorContainer=n.editorContainer?n.editorContainer:null;appendContentCssFromSettings(e);return e.inline?initContentBody(e):init$1(e,n)};var mu=DOMUtils.DOM;var hasSkipLoadPrefix=function(e){return"-"===e.charAt(0)};var loadLanguage=function(e,t){var n=getLanguageCode(t);var a=getLanguageUrl(t);if(false===_n.hasCode(n)&&"en"!==n){var o=""!==a?a:t.editorManager.baseURL+"/langs/"+n+".js";e.add(o,noop,void 0,(function(){languageLoadError(t,o,n)}))}};var loadTheme=function(e,t,n,a){var o=getTheme(t);if(u(o)){if(!hasSkipLoadPrefix(o)&&!has$2(yi.urls,o)){var i=getThemeUrl(t);i?yi.load(o,t.documentBaseURI.toAbsolute(i)):yi.load(o,"themes/"+o+"/theme"+n+".js")}e.loadQueue((function(){yi.waitFor(o,a)}))}else a()};var getIconsUrlMetaFromUrl=function(e){return b.from(getIconsUrl(e)).filter((function(e){return e.length>0})).map((function(e){return{url:e,name:b.none()}}))};var getIconsUrlMetaFromName=function(e,t,n){return b.from(t).filter((function(e){return e.length>0&&!di.has(e)})).map((function(t){return{url:e.editorManager.baseURL+"/icons/"+t+"/icons"+n+".js",name:b.some(t)}}))};var loadIcons=function(e,t,n){var a=getIconsUrlMetaFromName(t,"default",n);var o=getIconsUrlMetaFromUrl(t).orThunk((function(){return getIconsUrlMetaFromName(t,getIconPackName(t),"")}));each$k(cat([a,o]),(function(n){e.add(n.url,noop,void 0,(function(){iconsLoadError(t,n.url,n.name.getOrUndefined())}))}))};var loadPlugins=function(e,t){fe.each(getExternalPlugins$1(e),(function(t,n){bi.load(n,t,noop,void 0,(function(){pluginLoadError(e,t,n)}));e.settings.plugins+=" "+n}));fe.each(getPlugins(e).split(/[ ,]/),(function(n){n=fe.trim(n);if(n&&!bi.urls[n])if(hasSkipLoadPrefix(n)){n=n.substr(1,n.length);var a=bi.dependencies(n);fe.each(a,(function(n){var a={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"};var o=bi.createUrl(a,n);bi.load(o.resource,o,noop,void 0,(function(){pluginLoadError(e,o.prefix+o.resource+o.suffix,o.resource)}))}))}else{var o={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"};bi.load(n,o,noop,void 0,(function(){pluginLoadError(e,o.prefix+o.resource+o.suffix,n)}))}}))};var loadScripts=function(e,t){var n=En.ScriptLoader;loadTheme(n,e,t,(function(){loadLanguage(n,e);loadIcons(n,e,t);loadPlugins(e,t);n.loadQueue((function(){e.removed||init(e)}),e,(function(){e.removed||init(e)}))}))};var getStyleSheetLoader=function(e,t){return Ke.forElement(e,{contentCssCors:hasContentCssCors(t),referrerPolicy:getReferrerPolicy(t)})};var render=function(e){var t=e.id;_n.setCode(getLanguageCode(e));var readyHandler=function(){mu.unbind(window,"ready",readyHandler);e.render()};if(Gt.Event.domLoaded){if(e.getElement()&&ie.contentEditable){var n=se.fromDom(e.getElement());var a=clone$3(n);e.on("remove",(function(){eachr(n.dom.attributes,(function(e){return remove$6(n,e.name)}));setAll$1(n,a)}));e.ui.styleSheetLoader=getStyleSheetLoader(n,e);if(isInline(e))e.inline=true;else{e.orgVisibility=e.getElement().style.visibility;e.getElement().style.visibility="hidden"}var o=e.getElement().form||mu.getParent(t,"form");if(o){e.formElement=o;if(hasHiddenInput(e)&&!ke(e.getElement())){mu.insertAfter(mu.create("input",{type:"hidden",name:t}),t);e.hasHiddenInput=true}e.formEventDelegate=function(t){e.fire(t.type,t)};mu.bind(o,"submit reset",e.formEventDelegate);e.on("reset",(function(){e.resetContent()}));if(shouldPatchSubmit(e)&&!o.submit.nodeType&&!o.submit.length&&!o._mceOldSubmit){o._mceOldSubmit=o.submit;o.submit=function(){e.editorManager.triggerSave();e.setDirty(false);return o._mceOldSubmit(o)}}}e.windowManager=WindowManager(e);e.notificationManager=NotificationManager(e);isEncodingXml(e)&&e.on("GetContent",(function(e){e.save&&(e.content=mu.encode(e.content))}));shouldAddFormSubmitTrigger(e)&&e.on("submit",(function(){e.initialized&&e.save()}));if(shouldAddUnloadTrigger(e)){e._beforeUnload=function(){!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:true,set_dirty:false})};e.editorManager.on("BeforeUnload",e._beforeUnload)}e.editorManager.add(e);loadScripts(e,e.suffix)}}else mu.bind(window,"ready",readyHandler)};var addVisual=function(e,t){return addVisual$1(e,t)};var gu={"font-size":"size","font-family":"face"};var getSpecifiedFontProp=function(e,t,n){var getProperty=function(t){return getRaw(t,e).orThunk((function(){return"font"===name(t)?get$9(gu,e).bind((function(e){return getOpt(t,e)})):b.none()}))};var isRoot=function(e){return eq(se.fromDom(t),e)};return closest$1(se.fromDom(n),(function(e){return getProperty(e)}),isRoot)};var normalizeFontFamily=function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")};var getComputedFontProp=function(e,t){return b.from(DOMUtils.DOM.getStyle(t,e,true))};var getFontProp=function(e){return function(t,n){return b.from(n).map(se.fromDom).filter(pe).bind((function(n){return getSpecifiedFontProp(e,t,n.dom).or(getComputedFontProp(e,n.dom))})).getOr("")}};var pu=getFontProp("font-size");var hu=compose(normalizeFontFamily,getFontProp("font-family"));var findFirstCaretElement=function(e){return Sa(e.getBody()).map((function(e){var t=e.container();return Ne(t)?t.parentNode:t}))};var getCaretElement=function(e){return b.from(e.selection.getRng()).bind((function(t){var n=e.getBody();var a=t.startContainer===n&&0===t.startOffset;return a?b.none():b.from(e.selection.getStart(true))}))};var bindRange=function(e,t){return getCaretElement(e).orThunk(curry(findFirstCaretElement,e)).map(se.fromDom).filter(pe).bind(t)};var mapRange=function(e,t){return bindRange(e,compose1(b.some,t))};var fromFontSizeNumber=function(e,t){if(/^[0-9.]+$/.test(t)){var n=parseInt(t,10);if(n>=1&&n<=7){var a=getFontStyleValues(e);var o=getFontSizeClasses(e);return o?o[n-1]||t:a[n-1]||t}return t}return t};var normalizeFontNames=function(e){var t=e.split(/\s*,\s*/);return map$3(t,(function(e){return-1===e.indexOf(" ")||startsWith(e,'"')||startsWith(e,"'")?e:"'"+e+"'"})).join(",")};var fontNameAction=function(e,t){var n=fromFontSizeNumber(e,t);e.formatter.toggle("fontname",{value:normalizeFontNames(n)});e.nodeChanged()};var fontNameQuery=function(e){return mapRange(e,(function(t){return hu(e.getBody(),t.dom)})).getOr("")};var fontSizeAction=function(e,t){e.formatter.toggle("fontsize",{value:fromFontSizeNumber(e,t)});e.nodeChanged()};var fontSizeQuery=function(e){return mapRange(e,(function(t){return pu(e.getBody(),t.dom)})).getOr("")};var lineHeightQuery=function(e){return mapRange(e,(function(t){var n=se.fromDom(e.getBody());var a=closest$1(t,(function(e){return getRaw(e,"line-height")}),curry(eq,n));var computedStyle=function(){var e=parseFloat(get$5(t,"line-height"));var n=parseFloat(get$5(t,"font-size"));return String(e/n)};return a.getOrThunk(computedStyle)})).getOr("")};var lineHeightAction=function(e,t){e.formatter.toggle("lineheight",{value:String(t)});e.nodeChanged()};var processValue=function(e){if("string"!==typeof e){var t=fe.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}};var insertAtCaret=function(e,t){var n=processValue(t);insertContent(e,n.content,n.details)};var bu=fe.each;var yu=fe.map,Cu=fe.inArray;var wu=function(){function EditorCommands(e){(this||t).commands={state:{},exec:{},value:{}};(this||t).editor=e;this.setupCommands(e)}EditorCommands.prototype.execCommand=function(e,n,a,o){var i,u=false;var c=this||t;if(!c.editor.removed){"mcefocus"!==e.toLowerCase()&&(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(e)||o&&o.skip_focus?restore(c.editor):c.editor.focus());o=c.editor.fire("BeforeExecCommand",{command:e,ui:n,value:a});if(o.isDefaultPrevented())return false;var f=e.toLowerCase();if(i=c.commands.exec[f]){i(f,n,a);c.editor.fire("ExecCommand",{command:e,ui:n,value:a});return true}bu((this||t).editor.plugins,(function(t){if(t.execCommand&&t.execCommand(e,n,a)){c.editor.fire("ExecCommand",{command:e,ui:n,value:a});u=true;return false}}));if(u)return u;if(c.editor.theme&&c.editor.theme.execCommand&&c.editor.theme.execCommand(e,n,a)){c.editor.fire("ExecCommand",{command:e,ui:n,value:a});return true}try{u=c.editor.getDoc().execCommand(e,n,a)}catch(e){}if(u){c.editor.fire("ExecCommand",{command:e,ui:n,value:a});return true}return false}};EditorCommands.prototype.queryCommandState=function(e){var n;if(!(this||t).editor.quirks.isHidden()&&!(this||t).editor.removed){e=e.toLowerCase();if(n=(this||t).commands.state[e])return n(e);try{return(this||t).editor.getDoc().queryCommandState(e)}catch(e){}return false}};EditorCommands.prototype.queryCommandValue=function(e){var n;if(!(this||t).editor.quirks.isHidden()&&!(this||t).editor.removed){e=e.toLowerCase();if(n=(this||t).commands.value[e])return n(e);try{return(this||t).editor.getDoc().queryCommandValue(e)}catch(e){}}};EditorCommands.prototype.addCommands=function(e,n){void 0===n&&(n="exec");var a=this||t;bu(e,(function(e,t){bu(t.toLowerCase().split(","),(function(t){a.commands[n][t]=e}))}))};EditorCommands.prototype.addCommand=function(e,n,a){var o=this||t;e=e.toLowerCase();(this||t).commands.exec[e]=function(e,t,i,u){return n.call(a||o.editor,t,i,u)}};EditorCommands.prototype.queryCommandSupported=function(e){e=e.toLowerCase();if((this||t).commands.exec[e])return true;try{return(this||t).editor.getDoc().queryCommandSupported(e)}catch(e){}return false};EditorCommands.prototype.addQueryStateHandler=function(e,n,a){var o=this||t;e=e.toLowerCase();(this||t).commands.state[e]=function(){return n.call(a||o.editor)}};EditorCommands.prototype.addQueryValueHandler=function(e,n,a){var o=this||t;e=e.toLowerCase();(this||t).commands.value[e]=function(){return n.call(a||o.editor)}};EditorCommands.prototype.hasCustomCommand=function(e){e=e.toLowerCase();return!!(this||t).commands.exec[e]};EditorCommands.prototype.execNativeCommand=function(e,n,a){void 0===n&&(n=false);void 0===a&&(a=null);return(this||t).editor.getDoc().execCommand(e,n,a)};EditorCommands.prototype.isFormatMatch=function(e){return(this||t).editor.formatter.match(e)};EditorCommands.prototype.toggleFormat=function(e,n){(this||t).editor.formatter.toggle(e,n);(this||t).editor.nodeChanged()};EditorCommands.prototype.storeSelection=function(e){(this||t).selectionBookmark=(this||t).editor.selection.getBookmark(e)};EditorCommands.prototype.restoreSelection=function(){(this||t).editor.selection.moveToBookmark((this||t).selectionBookmark)};EditorCommands.prototype.setupCommands=function(e){var n=this||t;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":noop,"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},mceFocus:function(t,n,a){focus(e,a)},"Cut,Copy,Paste":function(t){var a=e.getDoc();var o;try{n.execNativeCommand(t)}catch(e){o=true}"paste"!==t||a.queryCommandEnabled(t)||(o=true);if(o||!a.queryCommandSupported(t)){var i=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");ie.mac&&(i=i.replace(/Ctrl\+/g,"⌘+"));e.notificationManager.open({text:i,type:"error"})}},unlink:function(){if(e.selection.isCollapsed()){var t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,true)}else e.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(t){var a=t.substring(7);"full"===a&&(a="justify");bu("left,center,right,justify".split(","),(function(t){a!==t&&e.formatter.remove("align"+t)}));"none"!==a&&n.toggleFormat("align"+a)},"InsertUnorderedList,InsertOrderedList":function(t){var a;n.execNativeCommand(t);var o=e.dom.getParent(e.selection.getNode(),"ol,ul");if(o){a=o.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(a.nodeName)){n.storeSelection();e.dom.split(a,o);n.restoreSelection()}}},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){n.toggleFormat(e)},"ForeColor,HiliteColor":function(e,t,a){n.toggleFormat(e,{value:a})},FontName:function(t,n,a){fontNameAction(e,a)},FontSize:function(t,n,a){fontSizeAction(e,a)},LineHeight:function(t,n,a){lineHeightAction(e,a)},Lang:function(e,t,a){n.toggleFormat(e,{value:a.code,customValue:a.customCode})},RemoveFormat:function(t){e.formatter.remove(t)},mceBlockQuote:function(){n.toggleFormat("blockquote")},FormatBlock:function(e,t,a){return n.toggleFormat(a||"p")},mceCleanup:function(){var t=e.selection.getBookmark();e.setContent(e.getContent());e.selection.moveToBookmark(t)},mceRemoveNode:function(t,a,o){var i=o||e.selection.getNode();if(i!==e.getBody()){n.storeSelection();e.dom.remove(i,true);n.restoreSelection()}},mceSelectNodeDepth:function(t,n,a){var o=0;e.dom.getParent(e.selection.getNode(),(function(t){if(1===t.nodeType&&o++===a){e.selection.select(t);return false}}),e.getBody())},mceSelectNode:function(t,n,a){e.selection.select(a)},mceInsertContent:function(t,n,a){insertAtCaret(e,a)},mceInsertRawHTML:function(t,n,a){e.selection.setContent("tiny_mce_marker");var o=e.getContent();e.setContent(o.replace(/tiny_mce_marker/g,(function(){return a})))},mceInsertNewLine:function(t,n,a){insert(e,a)},mceToggleFormat:function(e,t,a){n.toggleFormat(a)},mceSetContent:function(t,n,a){e.setContent(a)},"Indent,Outdent":function(t){handle(e,t)},mceRepaint:noop,InsertHorizontalRule:function(){e.execCommand("mceInsertContent",false,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual;e.addVisual()},mceReplaceContent:function(t,n,a){e.execCommand("mceInsertContent",false,a.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceInsertLink:function(t,n,a){"string"===typeof a&&(a={href:a});var o=e.dom.getParent(e.selection.getNode(),"a");a.href=a.href.replace(/ /g,"%20");o&&a.href||e.formatter.remove("link");a.href&&e.formatter.apply("link",a,o)},selectAll:function(){var t=e.dom.getParent(e.selection.getStart(),Oe);if(t){var n=e.dom.createRng();n.selectNodeContents(t);e.selection.setRng(n)}},mceNewDocument:function(){e.setContent("")},InsertLineBreak:function(t,n,a){insert$1(e,a);return true}});var alignStates=function(t){return function(){var n=e.selection;var a=n.isCollapsed()?[e.dom.getParent(n.getNode(),e.dom.isBlock)]:n.getSelectedBlocks();var o=yu(a,(function(n){return!!e.formatter.matchNode(n,t)}));return-1!==Cu(o,true)}};n.addCommands({JustifyLeft:alignStates("alignleft"),JustifyCenter:alignStates("aligncenter"),JustifyRight:alignStates("alignright"),JustifyFull:alignStates("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return n.isFormatMatch(e)},mceBlockQuote:function(){return n.isFormatMatch("blockquote")},Outdent:function(){return canOutdent(e)},"InsertUnorderedList,InsertOrderedList":function(t){var n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===t&&"UL"===n.tagName||"insertorderedlist"===t&&"OL"===n.tagName)}},"state");n.addCommands({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}});n.addQueryValueHandler("FontName",(function(){return fontNameQuery(e)}),this||t);n.addQueryValueHandler("FontSize",(function(){return fontSizeQuery(e)}),this||t);n.addQueryValueHandler("LineHeight",(function(){return lineHeightQuery(e)}),this||t)};return EditorCommands}();var xu="data-mce-contenteditable";var toggleClass=function(e,t,n){has(e,t)&&false===n?remove$3(e,t):n&&add$1(e,t)};var setEditorCommandState=function(e,t,n){try{e.getDoc().execCommand(t,false,String(n))}catch(e){}};var setContentEditable=function(e,t){e.dom.contentEditable=t?"true":"false"};var switchOffContentEditableTrue=function(e){each$k(descendants(e,'*[contenteditable="true"]'),(function(e){set$1(e,xu,"true");setContentEditable(e,false)}))};var switchOnContentEditableTrue=function(e){each$k(descendants(e,"*["+xu+'="true"]'),(function(e){remove$6(e,xu);setContentEditable(e,true)}))};var removeFakeSelection=function(e){b.from(e.selection.getNode()).each((function(e){e.removeAttribute("data-mce-selected")}))};var restoreFakeSelection=function(e){e.selection.setRng(e.selection.getRng())};var toggleReadOnly=function(e,t){var n=se.fromDom(e.getBody());toggleClass(n,"mce-content-readonly",t);if(t){e.selection.controlSelection.hideResizeRect();e._selectionOverrides.hideFakeCaret();removeFakeSelection(e);e.readonly=true;setContentEditable(n,false);switchOffContentEditableTrue(n)}else{e.readonly=false;setContentEditable(n,true);switchOnContentEditableTrue(n);setEditorCommandState(e,"StyleWithCSS",false);setEditorCommandState(e,"enableInlineTableEditing",false);setEditorCommandState(e,"enableObjectResizing",false);hasEditorOrUiFocus(e)&&e.focus();restoreFakeSelection(e);e.nodeChanged()}};var isReadOnly=function(e){return e.readonly};var registerFilters=function(e){e.parser.addAttributeFilter("contenteditable",(function(t){isReadOnly(e)&&each$k(t,(function(e){e.attr(xu,e.attr("contenteditable"));e.attr("contenteditable","false")}))}));e.serializer.addAttributeFilter(xu,(function(t){isReadOnly(e)&&each$k(t,(function(e){e.attr("contenteditable",e.attr(xu))}))}));e.serializer.addTempAttr(xu)};var registerReadOnlyContentFilters=function(e){e.serializer?registerFilters(e):e.on("PreInit",(function(){registerFilters(e)}))};var isClickEvent=function(e){return"click"===e.type};var getAnchorHrefOpt=function(e,t){var isRoot=function(t){return eq(t,se.fromDom(e.getBody()))};return closest$2(t,"a",isRoot).bind((function(e){return getOpt(e,"href")}))};var processReadonlyEvents=function(e,t){if(isClickEvent(t)&&!Oa.metaKeyPressed(t)){var n=se.fromDom(t.target);getAnchorHrefOpt(e,n).each((function(n){t.preventDefault();if(/^#/.test(n)){var a=e.dom.select(n+',[name="'+removeLeading(n,"#")+'"]');a.length&&e.selection.scrollIntoView(a[0],true)}else window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")}))}};var registerReadOnlySelectionBlockers=function(e){e.on("ShowCaret",(function(t){isReadOnly(e)&&t.preventDefault()}));e.on("ObjectSelected",(function(t){isReadOnly(e)&&t.preventDefault()}))};var Su=fe.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");var Eu=function(){function EventDispatcher(e){(this||t).bindings={};(this||t).settings=e||{};(this||t).scope=(this||t).settings.scope||this||t;(this||t).toggleEvent=(this||t).settings.toggleEvent||g}EventDispatcher.isNative=function(e){return!!Su[e.toLowerCase()]};EventDispatcher.prototype.fire=function(e,n){var a=e.toLowerCase();var o=normalize$3(a,n||{},(this||t).scope);(this||t).settings.beforeFire&&(this||t).settings.beforeFire(o);var i=(this||t).bindings[a];if(i)for(var u=0,c=i.length;u<c;u++){var f=i[u];if(!f.removed){f.once&&this.off(a,f.func);if(o.isImmediatePropagationStopped())return o;if(false===f.func.call((this||t).scope,o)){o.preventDefault();return o}}}return o};EventDispatcher.prototype.on=function(e,n,a,o){false===n&&(n=g);if(n){var i={func:n,removed:false};o&&fe.extend(i,o);var u=e.toLowerCase().split(" ");var c=u.length;while(c--){var f=u[c];var s=(this||t).bindings[f];if(!s){s=[];this.toggleEvent(f,true)}s=a?__spreadArray([i],s,true):__spreadArray(__spreadArray([],s,true),[i],false);(this||t).bindings[f]=s}}return this||t};EventDispatcher.prototype.off=function(e,n){var a=this||t;if(e){var o=e.toLowerCase().split(" ");var i=o.length;while(i--){var u=o[i];var c=(this||t).bindings[u];if(!u){each$j((this||t).bindings,(function(e,t){a.toggleEvent(t,false);delete a.bindings[t]}));return this||t}if(c){if(n){var f=partition(c,(function(e){return e.func===n}));c=f.fail;(this||t).bindings[u]=c;each$k(f.pass,(function(e){e.removed=true}))}else c.length=0;if(!c.length){this.toggleEvent(e,false);delete(this||t).bindings[u]}}}}else{each$j((this||t).bindings,(function(e,t){a.toggleEvent(t,false)}));(this||t).bindings={}}return this||t};EventDispatcher.prototype.once=function(e,t,n){return this.on(e,t,n,{once:true})};EventDispatcher.prototype.has=function(e){e=e.toLowerCase();return!(!(this||t).bindings[e]||0===(this||t).bindings[e].length)};return EventDispatcher}();var getEventDispatcher=function(e){e._eventDispatcher||(e._eventDispatcher=new Eu({scope:e,toggleEvent:function(t,n){Eu.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}}));return e._eventDispatcher};var ku={fire:function(e,n,a){var o=this||t;if(o.removed&&"remove"!==e&&"detach"!==e)return n;var i=getEventDispatcher(o).fire(e,n);if(false!==a&&o.parent){var u=o.parent();while(u&&!i.isPropagationStopped()){u.fire(e,i,false);u=u.parent()}}return i},on:function(e,n,a){return getEventDispatcher(this||t).on(e,n,a)},off:function(e,n){return getEventDispatcher(this||t).off(e,n)},once:function(e,n){return getEventDispatcher(this||t).once(e,n)},hasEventListeners:function(e){return getEventDispatcher(this||t).has(e)}};var Nu=DOMUtils.DOM;var _u;var getEventTarget=function(e,t){if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t))return e.getDoc().documentElement;var n=getEventRoot(e);if(n){e.eventRoot||(e.eventRoot=Nu.select(n)[0]);return e.eventRoot}return e.getBody()};var isListening=function(e){return!e.hidden&&!isReadOnly(e)};var fireEvent=function(e,t,n){isListening(e)?e.fire(t,n):isReadOnly(e)&&processReadonlyEvents(e,n)};var bindEventDelegate=function(e,t){var n;e.delegates||(e.delegates={});if(!e.delegates[t]&&!e.removed){var a=getEventTarget(e,t);if(getEventRoot(e)){if(!_u){_u={};e.editorManager.on("removeEditor",(function(){if(!e.editorManager.activeEditor&&_u){each$j(_u,(function(t,n){e.dom.unbind(getEventTarget(e,n))}));_u=null}}))}if(_u[t])return;n=function(n){var a=n.target;var o=e.editorManager.get();var i=o.length;while(i--){var u=o[i].getBody();(u===a||Nu.isChildOf(a,u))&&fireEvent(o[i],t,n)}};_u[t]=n;Nu.bind(a,t,n)}else{n=function(n){fireEvent(e,t,n)};Nu.bind(a,t,n);e.delegates[t]=n}}};var Au=__assign(__assign({},ku),{bindPendingEventDelegates:function(){var e=this||t;fe.each(e._pendingNativeEvents,(function(t){bindEventDelegate(e,t)}))},toggleNativeEvent:function(e,n){var a=this||t;if("focus"!==e&&"blur"!==e&&!a.removed)if(n)a.initialized?bindEventDelegate(a,e):a._pendingNativeEvents?a._pendingNativeEvents.push(e):a._pendingNativeEvents=[e];else if(a.initialized){a.dom.unbind(getEventTarget(a,e),e,a.delegates[e]);delete a.delegates[e]}},unbindAllNativeEvents:function(){var e=this||t;var n=e.getBody();var a=e.dom;if(e.delegates){each$j(e.delegates,(function(t,n){e.dom.unbind(getEventTarget(e,n),n,t)}));delete e.delegates}if(!e.inline&&n&&a){n.onload=null;a.unbind(e.getWin());a.unbind(e.getDoc())}if(a){a.unbind(n);a.unbind(e.getContainer())}}});var Ru=["design","readonly"];var switchToMode=function(e,t,n,a){var o=n[t.get()];var i=n[a];try{i.activate()}catch(e){console.error("problem while activating editor mode "+a+":",e);return}o.deactivate();o.editorReadOnly!==i.editorReadOnly&&toggleReadOnly(e,i.editorReadOnly);t.set(a);fireSwitchMode(e,a)};var setMode=function(e,t,n,a){if(a!==n.get()){if(!has$2(t,a))throw new Error("Editor mode '"+a+"' is invalid");e.initialized?switchToMode(e,n,t,a):e.on("init",(function(){return switchToMode(e,n,t,a)}))}};var registerMode=function(e,t,n){var a;if(contains$3(Ru,t))throw new Error("Cannot override default mode "+t);return __assign(__assign({},e),(a={},a[t]=__assign(__assign({},n),{deactivate:function(){try{n.deactivate()}catch(e){console.error("problem while deactivating editor mode "+t+":",e)}}}),a))};var create$4=function(e){var t=Cell("design");var n=Cell({design:{activate:noop,deactivate:noop,editorReadOnly:false},readonly:{activate:noop,deactivate:noop,editorReadOnly:true}});registerReadOnlyContentFilters(e);registerReadOnlySelectionBlockers(e);return{isReadOnly:function(){return isReadOnly(e)},set:function(a){return setMode(e,n.get(),t,a)},get:function(){return t.get()},register:function(e,t){n.set(registerMode(n.get(),e,t))}}};var Du=fe.each,Tu=fe.explode;var Ou={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123};var Bu=fe.makeMap("alt,ctrl,shift,meta,access");var parseShortcut=function(e){var t;var n={};Du(Tu(e.toLowerCase(),"+"),(function(e){if(e in Bu)n[e]=true;else if(/^[0-9]{2,}$/.test(e))n.keyCode=parseInt(e,10);else{n.charCode=e.charCodeAt(0);n.keyCode=Ou[e]||e.toUpperCase().charCodeAt(0)}}));var a=[n.keyCode];for(t in Bu)n[t]?a.push(t):n[t]=false;n.id=a.join(",");if(n.access){n.alt=true;ie.mac?n.ctrl=true:n.shift=true}if(n.meta)if(ie.mac)n.meta=true;else{n.ctrl=true;n.meta=false}return n};var Pu=function(){function Shortcuts(e){(this||t).shortcuts={};(this||t).pendingPatterns=[];(this||t).editor=e;var n=this||t;e.on("keyup keypress keydown",(function(e){if((n.hasModifier(e)||n.isFunctionKey(e))&&!e.isDefaultPrevented()){Du(n.shortcuts,(function(t){if(n.matchShortcut(e,t)){n.pendingPatterns=t.subpatterns.slice(0);"keydown"===e.type&&n.executeShortcutAction(t);return true}}));if(n.matchShortcut(e,n.pendingPatterns[0])){1===n.pendingPatterns.length&&"keydown"===e.type&&n.executeShortcutAction(n.pendingPatterns[0]);n.pendingPatterns.shift()}}}))}Shortcuts.prototype.add=function(e,n,a,o){var i=this||t;var u=i.normalizeCommandFunc(a);Du(Tu(fe.trim(e)),(function(e){var t=i.createShortcut(e,n,u,o);i.shortcuts[t.id]=t}));return true};Shortcuts.prototype.remove=function(e){var n=this.createShortcut(e);if((this||t).shortcuts[n.id]){delete(this||t).shortcuts[n.id];return true}return false};Shortcuts.prototype.normalizeCommandFunc=function(e){var n=this||t;var a=e;return"string"===typeof a?function(){n.editor.execCommand(a,false,null)}:fe.isArray(a)?function(){n.editor.execCommand(a[0],a[1],a[2])}:a};Shortcuts.prototype.createShortcut=function(e,n,a,o){var i=fe.map(Tu(e,">"),parseShortcut);i[i.length-1]=fe.extend(i[i.length-1],{func:a,scope:o||(this||t).editor});return fe.extend(i[0],{desc:(this||t).editor.translate(n),subpatterns:i.slice(1)})};Shortcuts.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey};Shortcuts.prototype.isFunctionKey=function(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123};Shortcuts.prototype.matchShortcut=function(e,t){if(!t)return false;if(t.ctrl!==e.ctrlKey||t.meta!==e.metaKey)return false;if(t.alt!==e.altKey||t.shift!==e.shiftKey)return false;if(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode){e.preventDefault();return true}return false};Shortcuts.prototype.executeShortcutAction=function(e){return e.func?e.func.call(e.scope):null};return Shortcuts}();var create$3=function(){var e={};var t={};var n={};var a={};var o={};var i={};var u={};var add=function(e,t){return function(n,a){return e[n.toLowerCase()]=__assign(__assign({},a),{type:t})}};var addIcon=function(e,t){return a[e.toLowerCase()]=t};return{addButton:add(e,"button"),addGroupToolbarButton:add(e,"grouptoolbarbutton"),addToggleButton:add(e,"togglebutton"),addMenuButton:add(e,"menubutton"),addSplitButton:add(e,"splitbutton"),addMenuItem:add(t,"menuitem"),addNestedMenuItem:add(t,"nestedmenuitem"),addToggleMenuItem:add(t,"togglemenuitem"),addAutocompleter:add(n,"autocompleter"),addContextMenu:add(o,"contextmenu"),addContextToolbar:add(i,"contexttoolbar"),addContextForm:add(i,"contextform"),addSidebar:add(u,"sidebar"),addIcon:addIcon,getAll:function(){return{buttons:e,menuItems:t,icons:a,popups:n,contextMenus:o,contextToolbars:i,sidebars:u}}}};var registry=function(){var e=create$3();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,getAll:e.getAll}};var Lu=DOMUtils.DOM;var Iu=fe.extend,Mu=fe.each;var Fu=fe.resolve;var Uu=ie.ie;var zu=function(){function Editor(e,n,a){var o=this||t;(this||t).plugins={};(this||t).contentCSS=[];(this||t).contentStyles=[];(this||t).loadedCSS={};(this||t).isNotDirty=false;(this||t).editorManager=a;(this||t).documentBaseUrl=a.documentBaseURL;Iu(this||t,Au);(this||t).settings=getEditorSettings(this||t,e,(this||t).documentBaseUrl,a.defaultSettings,n);(this||t).settings.suffix&&(a.suffix=(this||t).settings.suffix);(this||t).suffix=a.suffix;(this||t).settings.base_url&&a._setBaseUrl((this||t).settings.base_url);(this||t).baseUri=a.baseURI;if((this||t).settings.referrer_policy){En.ScriptLoader._setReferrerPolicy((this||t).settings.referrer_policy);DOMUtils.DOM.styleSheetLoader._setReferrerPolicy((this||t).settings.referrer_policy)}AddOnManager.languageLoad=(this||t).settings.language_load;AddOnManager.baseURL=a.baseURL;(this||t).id=e;this.setDirty(false);(this||t).documentBaseURI=new io((this||t).settings.document_base_url,{base_uri:(this||t).baseUri});(this||t).baseURI=(this||t).baseUri;(this||t).inline=!!(this||t).settings.inline;(this||t).shortcuts=new Pu(this||t);(this||t).editorCommands=new wu(this||t);(this||t).settings.cache_suffix&&(ie.cacheSuffix=(this||t).settings.cache_suffix.replace(/^[\?\&]+/,""));(this||t).ui={registry:registry(),styleSheetLoader:void 0,show:noop,hide:noop,enable:noop,disable:noop,isDisabled:g};var i=this||t;var u=create$4(i);(this||t).mode=u;(this||t).setMode=u.set;a.fire("SetupEditor",{editor:this||t});this.execCallback("setup",this||t);(this||t).$=vn.overrideDefaults((function(){return{context:o.inline?o.getBody():o.getDoc(),element:o.getBody()}}))}Editor.prototype.render=function(){render(this||t)};Editor.prototype.focus=function(e){this.execCommand("mceFocus",false,e)};Editor.prototype.hasFocus=function(){return hasFocus(this||t)};Editor.prototype.execCallback=function(e){var n=[];for(var a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=this||t;var i,u=o.settings[e];if(u){if(o.callbackLookup&&(i=o.callbackLookup[e])){u=i.func;i=i.scope}if("string"===typeof u){i=u.replace(/\.\w+$/,"");i=i?Fu(i):0;u=Fu(u);o.callbackLookup=o.callbackLookup||{};o.callbackLookup[e]={func:u,scope:i}}return u.apply(i||o,n)}};Editor.prototype.translate=function(e){return _n.translate(e)};Editor.prototype.getParam=function(e,n,a){return getParam(this||t,e,n,a)};Editor.prototype.hasPlugin=function(e,n){var a=contains$3(getPlugins(this||t).split(/[ ,]/),e);return!!a&&(!n||void 0!==bi.get(e))};Editor.prototype.nodeChanged=function(e){(this||t)._nodeChangeDispatcher.nodeChanged(e)};Editor.prototype.addCommand=function(e,n,a){(this||t).editorCommands.addCommand(e,n,a)};Editor.prototype.addQueryStateHandler=function(e,n,a){(this||t).editorCommands.addQueryStateHandler(e,n,a)};Editor.prototype.addQueryValueHandler=function(e,n,a){(this||t).editorCommands.addQueryValueHandler(e,n,a)};Editor.prototype.addShortcut=function(e,n,a,o){(this||t).shortcuts.add(e,n,a,o)};Editor.prototype.execCommand=function(e,n,a,o){return(this||t).editorCommands.execCommand(e,n,a,o)};Editor.prototype.queryCommandState=function(e){return(this||t).editorCommands.queryCommandState(e)};Editor.prototype.queryCommandValue=function(e){return(this||t).editorCommands.queryCommandValue(e)};Editor.prototype.queryCommandSupported=function(e){return(this||t).editorCommands.queryCommandSupported(e)};Editor.prototype.show=function(){var e=this||t;if(e.hidden){e.hidden=false;if(e.inline)e.getBody().contentEditable="true";else{Lu.show(e.getContainer());Lu.hide(e.id)}e.load();e.fire("show")}};Editor.prototype.hide=function(){var e=this||t,n=e.getDoc();if(!e.hidden){Uu&&n&&!e.inline&&n.execCommand("SelectAll");e.save();if(e.inline){e.getBody().contentEditable="false";e===e.editorManager.focusedEditor&&(e.editorManager.focusedEditor=null)}else{Lu.hide(e.getContainer());Lu.setStyle(e.id,"display",e.orgDisplay)}e.hidden=true;e.fire("hide")}};Editor.prototype.isHidden=function(){return!!(this||t).hidden};Editor.prototype.setProgressState=function(e,t){this.fire("ProgressState",{state:e,time:t})};Editor.prototype.load=function(e){var n=this||t;var a,o=n.getElement();if(n.removed)return"";if(o){e=e||{};e.load=true;var i=ke(o)?o.value:o.innerHTML;a=n.setContent(i,e);e.element=o;e.no_events||n.fire("LoadContent",e);e.element=o=null;return a}};Editor.prototype.save=function(e){var n=this||t;var a,o,i=n.getElement();if(i&&n.initialized&&!n.removed){e=e||{};e.save=true;e.element=i;a=e.content=n.getContent(e);e.no_events||n.fire("SaveContent",e);"raw"===e.format&&n.fire("RawSaveContent",e);a=e.content;if(ke(i))i.value=a;else{!e.is_removing&&n.inline||(i.innerHTML=a);(o=Lu.getParent(n.id,"form"))&&Mu(o.elements,(function(e){if(e.name===n.id){e.value=a;return false}}))}e.element=i=null;false!==e.set_dirty&&n.setDirty(false);return a}};Editor.prototype.setContent=function(e,n){return setContent(this||t,e,n)};Editor.prototype.getContent=function(e){return getContent(this||t,e)};Editor.prototype.insertContent=function(e,t){t&&(e=Iu({content:e},t));this.execCommand("mceInsertContent",false,e)};Editor.prototype.resetContent=function(e){void 0===e?setContent(this||t,(this||t).startContent,{format:"raw"}):setContent(this||t,e);(this||t).undoManager.reset();this.setDirty(false);this.nodeChanged()};Editor.prototype.isDirty=function(){return!(this||t).isNotDirty};Editor.prototype.setDirty=function(e){var n=!(this||t).isNotDirty;(this||t).isNotDirty=!e;e&&e!==n&&this.fire("dirty")};Editor.prototype.getContainer=function(){var e=this||t;e.container||(e.container=Lu.get(e.editorContainer||e.id+"_parent"));return e.container};Editor.prototype.getContentAreaContainer=function(){return(this||t).contentAreaContainer};Editor.prototype.getElement=function(){(this||t).targetElm||((this||t).targetElm=Lu.get((this||t).id));return(this||t).targetElm};Editor.prototype.getWin=function(){var e=this||t;var n;if(!e.contentWindow){n=e.iframeElement;n&&(e.contentWindow=n.contentWindow)}return e.contentWindow};Editor.prototype.getDoc=function(){var e=this||t;var n;if(!e.contentDocument){n=e.getWin();n&&(e.contentDocument=n.document)}return e.contentDocument};Editor.prototype.getBody=function(){var e=this.getDoc();return(this||t).bodyElement||(e?e.body:null)};Editor.prototype.convertURL=function(e,n,a){var o=this||t,i=o.settings;if(i.urlconverter_callback)return o.execCallback("urlconverter_callback",e,a,true,n);if(!i.convert_urls||a&&"LINK"===a.nodeName||0===e.indexOf("file:")||0===e.length)return e;if(i.relative_urls)return o.documentBaseURI.toRelative(e);e=o.documentBaseURI.toAbsolute(e,i.remove_script_host);return e};Editor.prototype.addVisual=function(e){addVisual(this||t,e)};Editor.prototype.remove=function(){remove(this||t)};Editor.prototype.destroy=function(e){destroy(this||t,e)};Editor.prototype.uploadImages=function(e){return(this||t).editorUpload.uploadImages(e)};Editor.prototype._scanForImages=function(){return(this||t).editorUpload.scanForImages()};Editor.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")};Editor.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")};Editor.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")};Editor.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")};return Editor}();var ju=DOMUtils.DOM;var Hu=fe.explode,Vu=fe.each,qu=fe.extend;var $u=0,Wu=false;var Ku;var Xu=[];var Yu=[];var isValidLegacyKey=function(e){return"length"!==e};var globalEventDelegate=function(e){var t=e.type;Vu(Ju.get(),(function(n){switch(t){case"scroll":n.fire("ScrollWindow",e);break;case"resize":n.fire("ResizeWindow",e);break}}))};var toggleGlobalEvents=function(e){if(e!==Wu){e?vn(window).on("resize scroll",globalEventDelegate):vn(window).off("resize scroll",globalEventDelegate);Wu=e}};var removeEditorFromList=function(e){var t=Yu;delete Xu[e.id];for(var n=0;n<Xu.length;n++)if(Xu[n]===e){Xu.splice(n,1);break}Yu=filter$4(Yu,(function(t){return e!==t}));Ju.activeEditor===e&&(Ju.activeEditor=Yu.length>0?Yu[0]:null);Ju.focusedEditor===e&&(Ju.focusedEditor=null);return t.length!==Yu.length};var purgeDestroyedEditor=function(e){if(e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode){removeEditorFromList(e);e.unbindAllNativeEvents();e.destroy(true);e.removed=true;e=null}return e};var Gu="CSS1Compat"!==document.compatMode;var Ju=__assign(__assign({},ku),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:vn,majorVersion:"5",minorVersion:"10.0",releaseDate:"2021-10-11",editors:Xu,i18n:_n,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var e=this||t;var n,a,o="";a=io.getDocumentBaseUrl(document.location);if(/^[^:]+:\/\/\/?[^\/]+\//.test(a)){a=a.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");/[\/\\]$/.test(a)||(a+="/")}var i=window.tinymce||window.tinyMCEPreInit;if(i){n=i.base||i.baseURL;o=i.suffix}else{var u=document.getElementsByTagName("script");for(var c=0;c<u.length;c++){var f=u[c].src||"";if(""!==f){var s=f.substring(f.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(f)){-1!==s.indexOf(".min")&&(o=".min");n=f.substring(0,f.lastIndexOf("/"));break}}}if(!n&&document.currentScript){f=document.currentScript.src;-1!==f.indexOf(".min")&&(o=".min");n=f.substring(0,f.lastIndexOf("/"))}}e.baseURL=new io(a).toAbsolute(n);e.documentBaseURL=a;e.baseURI=new io(e.baseURL);e.suffix=o;setup$l(e)},overrideDefaults:function(e){var n=e.base_url;n&&this._setBaseUrl(n);var a=e.suffix;e.suffix&&((this||t).suffix=a);(this||t).defaultSettings=e;var o=e.plugin_base_urls;void 0!==o&&each$j(o,(function(e,t){AddOnManager.PluginManager.urls[t]=e}))},init:function(e){var n=this||t;var a;var o=fe.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," ");var isInvalidInlineTarget=function(e,t){return e.inline&&t.tagName.toLowerCase()in o};var createId=function(e){var t=e.id;if(!t){t=get$9(e,"name").filter((function(e){return!ju.get(e)})).getOrThunk(ju.uniqueId);e.setAttribute("id",t)}return t};var execCallback=function(t){var a=e[t];if(a)return a.apply(n,[])};var hasClass=function(e,t){return t.constructor===RegExp?t.test(e.className):ju.hasClass(e,t)};var findTargets=function(e){var t=[];if(ie.browser.isIE()&&ie.browser.version.major<11){initError("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/");return[]}if(Gu){initError("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode.");return[]}if(e.types){Vu(e.types,(function(e){t=t.concat(ju.select(e.selector))}));return t}if(e.selector)return ju.select(e.selector);if(e.target)return[e.target];switch(e.mode){case"exact":var n=e.elements||"";n.length>0&&Vu(Hu(n),(function(e){var n=ju.get(e);n?t.push(n):Vu(document.forms,(function(n){Vu(n.elements,(function(n){if(n.name===e){e="mce_editor_"+$u++;ju.setAttrib(n,"id",e);t.push(n)}}))}))}));break;case"textareas":case"specific_textareas":Vu(ju.select("textarea"),(function(n){e.editor_deselector&&hasClass(n,e.editor_deselector)||e.editor_selector&&!hasClass(n,e.editor_selector)||t.push(n)}));break}return t};var provideResults=function(e){a=e};var initEditors=function(){var t=0;var a=[];var o;var createEditor=function(e,i,u){var c=new zu(e,i,n);a.push(c);c.on("init",(function(){++t===o.length&&provideResults(a)}));c.targetElm=c.targetElm||u;c.render()};ju.unbind(window,"ready",initEditors);execCallback("onpageload");o=vn.unique(findTargets(e));if(e.types)Vu(e.types,(function(t){fe.each(o,(function(n){if(ju.is(n,t.selector)){createEditor(createId(n),qu({},e,t),n);return false}return true}))}));else{fe.each(o,(function(e){purgeDestroyedEditor(n.get(e.id))}));o=fe.grep(o,(function(e){return!n.get(e.id)}));0===o.length?provideResults([]):Vu(o,(function(t){isInvalidInlineTarget(e,t)?initError("Could not initialize inline editor on invalid inline target element",t):createEditor(createId(t),e,t)}))}};n.settings=e;ju.bind(window,"ready",initEditors);return new qe((function(e){a?e(a):provideResults=function(t){e(t)}}))},get:function(e){return 0===arguments.length?Yu.slice(0):u(e)?find$3(Yu,(function(t){return t.id===e})).getOr(null):m(e)&&Yu[e]?Yu[e]:null},add:function(e){var n=this||t;var a=Xu[e.id];if(a===e)return e;if(null===n.get(e.id)){isValidLegacyKey(e.id)&&(Xu[e.id]=e);Xu.push(e);Yu.push(e)}toggleGlobalEvents(true);n.activeEditor=e;n.fire("AddEditor",{editor:e});if(!Ku){Ku=function(e){var t=n.fire("BeforeUnload");if(t.returnValue){e.preventDefault();e.returnValue=t.returnValue;return t.returnValue}};window.addEventListener("beforeunload",Ku)}return e},createEditor:function(e,n){return this.add(new zu(e,n,this||t))},remove:function(e){var n=this||t;var a,o;if(e){if(!u(e)){o=e;if(s(n.get(o.id)))return null;removeEditorFromList(o)&&n.fire("RemoveEditor",{editor:o});0===Yu.length&&window.removeEventListener("beforeunload",Ku);o.remove();toggleGlobalEvents(Yu.length>0);return o}Vu(ju.select(e),(function(e){o=n.get(e.id);o&&n.remove(o)}))}else for(a=Yu.length-1;a>=0;a--)n.remove(Yu[a])},execCommand:function(e,n,a){var o=this||t,i=o.get(a);switch(e){case"mceAddEditor":o.get(a)||new zu(a,o.settings,o).render();return true;case"mceRemoveEditor":i&&i.remove();return true;case"mceToggleEditor":if(!i){o.execCommand("mceAddEditor",false,a);return true}i.isHidden()?i.show():i.hide();return true}return!!o.activeEditor&&o.activeEditor.execCommand(e,n,a)},triggerSave:function(){Vu(Yu,(function(e){e.save()}))},addI18n:function(e,t){_n.add(e,t)},translate:function(e){return _n.translate(e)},setActive:function(e){var n=(this||t).activeEditor;if((this||t).activeEditor!==e){n&&n.fire("deactivate",{relatedTarget:e});e.fire("activate",{relatedTarget:n})}(this||t).activeEditor=e},_setBaseUrl:function(e){(this||t).baseURL=new io((this||t).documentBaseURL).toAbsolute(e.replace(/\/+$/,""));(this||t).baseURI=new io((this||t).baseURL)}});Ju.setup();var Qu=Math.min,Zu=Math.max,ec=Math.round;var relativePosition=function(e,t,n){var a=t.x;var o=t.y;var i=e.w;var u=e.h;var c=t.w;var f=t.h;var s=(n||"").split("");"b"===s[0]&&(o+=f);"r"===s[1]&&(a+=c);"c"===s[0]&&(o+=ec(f/2));"c"===s[1]&&(a+=ec(c/2));"b"===s[3]&&(o-=u);"r"===s[4]&&(a-=i);"c"===s[3]&&(o-=ec(u/2));"c"===s[4]&&(a-=ec(i/2));return create$2(a,o,i,u)};var findBestRelativePosition=function(e,t,n,a){var o,i;for(i=0;i<a.length;i++){o=relativePosition(e,t,a[i]);if(o.x>=n.x&&o.x+o.w<=n.w+n.x&&o.y>=n.y&&o.y+o.h<=n.h+n.y)return a[i]}return null};var inflate=function(e,t,n){return create$2(e.x-t,e.y-n,e.w+2*t,e.h+2*n)};var intersect=function(e,t){var n=Zu(e.x,t.x);var a=Zu(e.y,t.y);var o=Qu(e.x+e.w,t.x+t.w);var i=Qu(e.y+e.h,t.y+t.h);return o-n<0||i-a<0?null:create$2(n,a,o-n,i-a)};var clamp=function(e,t,n){var a=e.x;var o=e.y;var i=e.x+e.w;var u=e.y+e.h;var c=t.x+t.w;var f=t.y+t.h;var s=Zu(0,t.x-a);var l=Zu(0,t.y-o);var v=Zu(0,i-c);var d=Zu(0,u-f);a+=s;o+=l;if(n){i+=s;u+=l;a-=v;o-=d}i-=v;u-=d;return create$2(a,o,i-a,u-o)};var create$2=function(e,t,n,a){return{x:e,y:t,w:n,h:a}};var fromClientRect=function(e){return create$2(e.left,e.top,e.width,e.height)};var tc={inflate:inflate,relativePosition:relativePosition,findBestRelativePosition:findBestRelativePosition,intersect:intersect,clamp:clamp,create:create$2,fromClientRect:fromClientRect};var awaiter=function(e,t,n){void 0===n&&(n=1e3);var a=false;var o=null;var complete=function(e){return function(){var t=[];for(var n=0;n<arguments.length;n++)t[n]=arguments[n];if(!a){a=true;if(null!==o){clearTimeout(o);o=null}e.apply(null,t)}}};var i=complete(e);var u=complete(t);var start=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];a||null!==o||(o=setTimeout((function(){return u.apply(null,e)}),n))};return{start:start,resolve:i,reject:u}};var create$1=function(){var e={};var t={};var load=function(n,a){var o='Script at URL "'+a+'" failed to load';var i='Script at URL "'+a+"\" did not call `tinymce.Resource.add('"+n+"', data)` within 1 second";if(void 0!==e[n])return e[n];var u=new qe((function(e,u){var c=awaiter(e,u);t[n]=c.resolve;En.ScriptLoader.loadScript(a,(function(){return c.start(i)}),(function(){return c.reject(o)}))}));e[n]=u;return u};var add=function(n,a){if(void 0!==t[n]){t[n](a);delete t[n]}e[n]=qe.resolve(a)};return{load:load,add:add}};var rc=create$1();var nc=fe.each,ac=fe.extend;var oc,ic;var Class=function(){};Class.extend=oc=function(e){var n=this||t;var a=n.prototype;var Class=function(){var e,n,a;var o=this||t;if(!ic){o.init&&o.init.apply(o,arguments);n=o.Mixins;if(n){e=n.length;while(e--){a=n[e];a.init&&a.init.apply(o,arguments)}}}};var dummy=function(){return this||t};var createMethod=function(e,n){return function(){var o=this||t;var i=o._super;o._super=a[e];var u=n.apply(o,arguments);o._super=i;return u}};ic=true;var o=new n;ic=false;if(e.Mixins){nc(e.Mixins,(function(t){for(var n in t)"init"!==n&&(e[n]=t[n])}));a.Mixins&&(e.Mixins=a.Mixins.concat(e.Mixins))}e.Methods&&nc(e.Methods.split(","),(function(t){e[t]=dummy}));e.Properties&&nc(e.Properties.split(","),(function(n){var a="_"+n;e[n]=function(e){var n=this||t;if(void 0!==e){n[a]=e;return n}return n[a]}}));e.Statics&&nc(e.Statics,(function(e,t){Class[t]=e}));e.Defaults&&a.Defaults&&(e.Defaults=ac({},a.Defaults,e.Defaults));each$j(e,(function(e,t){"function"===typeof e&&a[t]?o[t]=createMethod(t,e):o[t]=e}));Class.prototype=o;Class.constructor=Class;Class.extend=oc;return Class};var uc=Math.min,cc=Math.max,fc=Math.round;var Color=function(e){var t={};var n=0,a=0,o=0;var rgb2hsv=function(e,t,n){var a,o,i;a=0;o=0;i=0;e/=255;t/=255;n/=255;var u=uc(e,uc(t,n));var c=cc(e,cc(t,n));if(u===c){i=u;return{h:0,s:0,v:100*i}}var f=e===u?t-n:n===u?e-t:n-e;a=e===u?3:n===u?1:5;a=60*(a-f/(c-u));o=(c-u)/c;i=c;return{h:fc(a),s:fc(100*o),v:fc(100*i)}};var hsvToRgb=function(e,t,i){e=(parseInt(e,10)||0)%360;t=parseInt(t,10)/100;i=parseInt(i,10)/100;t=cc(0,uc(t,1));i=cc(0,uc(i,1));if(0!==t){var u=e/60;var c=i*t;var f=c*(1-Math.abs(u%2-1));var s=i-c;switch(Math.floor(u)){case 0:n=c;a=f;o=0;break;case 1:n=f;a=c;o=0;break;case 2:n=0;a=c;o=f;break;case 3:n=0;a=f;o=c;break;case 4:n=f;a=0;o=c;break;case 5:n=c;a=0;o=f;break;default:n=a=o=0}n=fc(255*(n+s));a=fc(255*(a+s));o=fc(255*(o+s))}else n=a=o=fc(255*i)};var toHex=function(){var hex=function(e){e=parseInt(e,10).toString(16);return e.length>1?e:"0"+e};return"#"+hex(n)+hex(a)+hex(o)};var toRgb=function(){return{r:n,g:a,b:o}};var toHsv=function(){return rgb2hsv(n,a,o)};var parse=function(e){var i;if("object"===typeof e)if("r"in e){n=e.r;a=e.g;o=e.b}else"v"in e&&hsvToRgb(e.h,e.s,e.v);else if(i=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e)){n=parseInt(i[1],10);a=parseInt(i[2],10);o=parseInt(i[3],10)}else if(i=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e)){n=parseInt(i[1],16);a=parseInt(i[2],16);o=parseInt(i[3],16)}else if(i=/#([0-F])([0-F])([0-F])/gi.exec(e)){n=parseInt(i[1]+i[1],16);a=parseInt(i[2]+i[2],16);o=parseInt(i[3]+i[3],16)}n=n<0?0:n>255?255:n;a=a<0?0:a>255?255:a;o=o<0?0:o>255?255:o;return t};e&&parse(e);t.toRgb=toRgb;t.toHsv=toHsv;t.toHex=toHex;t.parse=parse;return t};var serialize=function(e){var t=JSON.stringify(e);return u(t)?t.replace(/[\u0080-\uFFFF]/g,(function(e){var t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substring(t.length)+t})):t};var sc={serialize:serialize,parse:function(e){try{return JSON.parse(e)}catch(e){}}};var lc={callbacks:{},count:0,send:function(e){var n=this||t,a=DOMUtils.DOM,o=void 0!==e.count?e.count:n.count;var i="tinymce_jsonp_"+o;n.callbacks[o]=function(t){a.remove(i);delete n.callbacks[o];e.callback(t)};a.add(a.doc.body,"script",{id:i,src:e.url,type:"text/javascript"});n.count++}};var vc=__assign(__assign({},ku),{send:function(e){var n,a=0;var ready=function(){if(!e.async||4===n.readyState||a++>1e4){e.success&&a<1e4&&200===n.status?e.success.call(e.success_scope,""+n.responseText,n,e):e.error&&e.error.call(e.error_scope,a>1e4?"TIMED_OUT":"GENERAL",n,e);n=null}else We.setTimeout(ready,10)};e.scope=e.scope||this||t;e.success_scope=e.success_scope||e.scope;e.error_scope=e.error_scope||e.scope;e.async=false!==e.async;e.data=e.data||"";vc.fire("beforeInitialize",{settings:e});n=new XMLHttpRequest;n.overrideMimeType&&n.overrideMimeType(e.content_type);n.open(e.type||(e.data?"POST":"GET"),e.url,e.async);e.crossDomain&&(n.withCredentials=true);e.content_type&&n.setRequestHeader("Content-Type",e.content_type);e.requestheaders&&fe.each(e.requestheaders,(function(e){n.setRequestHeader(e.key,e.value)}));n.setRequestHeader("X-Requested-With","XMLHttpRequest");n=vc.fire("beforeSend",{xhr:n,settings:e}).xhr;n.send(e.data);if(!e.async)return ready();We.setTimeout(ready,10)}});var dc=fe.extend;var mc=function(){function JSONRequest(e){(this||t).settings=dc({},e);(this||t).count=0}JSONRequest.sendRPC=function(e){return(new JSONRequest).send(e)};JSONRequest.prototype.send=function(e){var n=e.error,a=e.success;var o=dc((this||t).settings,e);o.success=function(e,t){e=sc.parse(e);"undefined"===typeof e&&(e={error:"JSON Parse error."});e.error?n.call(o.error_scope||o.scope,e.error,t):a.call(o.success_scope||o.scope,e.result)};o.error=function(e,t){n&&n.call(o.error_scope||o.scope,e,t)};o.data=sc.serialize({id:e.id||"c"+(this||t).count++,method:e.method,params:e.params});o.content_type="application/json";vc.send(o)};return JSONRequest}();var create=function(){return function(){var e={};var t=[];var n={getItem:function(t){var n=e[t];return n||null},setItem:function(n,a){t.push(n);e[n]=String(a)},key:function(e){return t[e]},removeItem:function(n){t=t.filter((function(e){return e===n}));delete e[n]},clear:function(){t=[];e={}},length:0};Object.defineProperty(n,"length",{get:function(){return t.length},configurable:false,enumerable:false});return n}()};var gc;try{var pc="__storage_test__";gc=window.localStorage;gc.setItem(pc,pc);gc.removeItem(pc)}catch(e){gc=create()}var hc=gc;var bc={geom:{Rect:tc},util:{Promise:qe,Delay:We,Tools:fe,VK:Oa,URI:io,Class:Class,EventDispatcher:Eu,Observable:ku,I18n:_n,XHR:vc,JSON:sc,JSONRequest:mc,JSONP:lc,LocalStorage:hc,Color:Color,ImageUploader:ImageUploader},dom:{EventUtils:Gt,Sizzle:Sizzle,DomQuery:vn,TreeWalker:Xe,TextSeeker:TextSeeker,DOMUtils:DOMUtils,ScriptLoader:En,RangeUtils:RangeUtils,Serializer:DomSerializer,StyleSheetLoader:StyleSheetLoader,ControlSelection:ControlSelection,BookmarkManager:BookmarkManager,Selection:EditorSelection,Event:Gt.Event},html:{Styles:Styles,Entities:Ut,Node:Za,Schema:Schema,SaxParser:SaxParser,DomParser:DomParser,Writer:Writer,Serializer:HtmlSerializer},Env:ie,AddOnManager:AddOnManager,Annotator:Annotator,Formatter:Formatter,UndoManager:UndoManager,EditorCommands:wu,WindowManager:WindowManager,NotificationManager:NotificationManager,EditorObservable:Au,Shortcuts:Pu,Editor:zu,FocusManager:Ya,EditorManager:Ju,DOM:DOMUtils.DOM,ScriptLoader:En.ScriptLoader,PluginManager:bi,ThemeManager:yi,IconManager:di,Resource:rc,trim:fe.trim,isArray:fe.isArray,is:fe.is,toArray:fe.toArray,makeMap:fe.makeMap,each:fe.each,map:fe.map,grep:fe.grep,inArray:fe.inArray,extend:fe.extend,create:fe.create,walk:fe.walk,createNS:fe.createNS,resolve:fe.resolve,explode:fe.explode,_addCacheSuffix:fe._addCacheSuffix,isOpera:ie.opera,isWebKit:ie.webkit,isIE:ie.ie,isGecko:ie.gecko,isMac:ie.mac};var yc=fe.extend(Ju,bc);var exportToModuleLoaders=function(e){try{n=e}catch(e){}};var exportToWindowGlobal=function(e){window.tinymce=e;window.tinyMCE=e};exportToWindowGlobal(yc);exportToModuleLoaders(yc)})();var o=n;const i=n.bookmarkManager,u=n.controlSelection;export{i as bookmarkManager,u as controlSelection,o as default};

